{"ast":null,"code":"import React,{useState,useEffect,useRef,useCallback,useMemo}from'react';import{initializeApp}from'firebase/app';import{getAuth,signInAnonymously,// 익명 로그인 임포트\nsignInWithCustomToken,// 커스텀 토큰 로그인 임포트\nonAuthStateChanged}from'firebase/auth';import{getFirestore,doc,setDoc,getDoc,collection,query,onSnapshot,serverTimestamp,addDoc,getDocs,// 추가: 문서 목록을 가져오기 위해\ndeleteDoc,// 추가: 문서를 삭제하기 위해\nwhere// [수정] where 임포트 추가\n}from'firebase/firestore';// ====================================================================\n// Firebase configuration information 수정금지\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const defaultFirebaseConfig={apiKey:\"AIzaSyBNJtmpRWzjobrY556bnHkwbZmpFJqgPX8\",authDomain:\"text-adventure-game-cb731.firebaseapp.com\",projectId:\"text-adventure-game-cb731\",storageBucket:\"text-adventure-game-cb731.firebaseapis.com\",messagingSenderId:\"1092941614820\",appId:\"1:1092941614820:web:5545f36014b73c268026f1\",measurementId:\"G-FNGF42T1FP\"};// 수정금지\nconst firebaseConfig=defaultFirebaseConfig;const appId=firebaseConfig.projectId;const initialAuthToken=null;// ====================================================================\n// Initial profession information and motivations for the game\nconst professions={'1':{name:'몰락한 귀족/기사',motivation:'가문의 몰락 원인을 조사하고, 잃어버린 가문의 보물을 찾아야 합니다.'},'2':{name:'평범한 마을 사람/농부',motivation:'갑자기 마을에 나타난 괴생명체로부터 마을을 지켜야 합니다.'},'3':{name:'젊은 마법사/견습생',motivation:'스승님의 실종에 대한 단서를 찾아야 합니다.'},'4':{name:'용병/모험가',motivation:'의뢰받은 임무를 수행하던 중 예상치 못한 사건에 휘말렸습니다.'},'5':{name:'도적/암살자',motivation:'길드에서 내려온 첫 번째 임무를 완수하고, 그 과정에서 수상한 음모를 감지해야 합니다.'},'6':{name:'왕족/공주/왕자',motivation:'왕실 내의 불화와 암투 속에서 자신의 입지를 다져야 합니다.'}};// =====================[ 파이어베이스 유틸/훅 함수 분리 ]=====================\n/**\r\n * Firebase 인증 및 Firestore 인스턴스 초기화\r\n * @returns {Object} { db, auth, userId, isAuthReady }\r\n */function useFirebaseInit(setGameLog){const[db,setDb]=useState(null);const[auth,setAuth]=useState(null);const[userId,setUserId]=useState(null);const[isAuthReady,setIsAuthReady]=useState(false);useEffect(()=>{try{if(firebaseConfig.apiKey===\"YOUR_API_KEY\"||!firebaseConfig.apiKey){console.error(\"Firebase initialization error: firebaseConfig.apiKey must be replaced with your actual Firebase API key.\");setGameLog(prev=>[...prev,\"오류: Firebase API 키가 올바르게 설정되지 않았습니다. 코드를 확인해주세요.\"]);return;}const app=initializeApp(firebaseConfig);const firestoreDb=getFirestore(app);const firebaseAuth=getAuth(app);setDb(firestoreDb);setAuth(firebaseAuth);const unsubscribeAuth=onAuthStateChanged(firebaseAuth,async user=>{if(user){setUserId(user.uid);setIsAuthReady(true);}else{try{if(initialAuthToken){await signInWithCustomToken(firebaseAuth,initialAuthToken);}else{await signInAnonymously(firebaseAuth);}}catch(error){console.error(\"Firebase authentication failed:\",error);setGameLog(prev=>[...prev,\"오류: Firebase 인증에 실패했습니다.\"]);}}});return()=>unsubscribeAuth();}catch(error){console.error(\"Firebase initialization error:\",error);setGameLog(prev=>[...prev,\"오류: 게임을 초기화할 수 없습니다.\"]);}},[]);return{db,auth,userId,isAuthReady};}/**\r\n * Firestore 실시간 리스너 등록 (공유 로그, 유저, 채팅 등)\r\n * @param {Object} params - 필요한 파라미터들\r\n */function useFirestoreListeners(_ref){let{db,appId,userId,isAuthReady,playerCharacter,setSharedGameLog,setActiveUsers,setChatMessages,setIsCompanionActionInProgress,setActingPlayer}=_ref;useEffect(()=>{if(!db||!isAuthReady||!userId)return;// ... 기존 리스너 등록 코드 ...\n// (공유 로그, 유저, 채팅, 게임 상태 등)\n// 기존 useEffect 코드 복사/이동\n},[db,isAuthReady,userId,playerCharacter.profession,playerCharacter.companions]);}// =====================[ LLM 호출/파싱 유틸 함수 분리 ]=====================\n/**\r\n * Gemini LLM API 호출 및 JSON 파싱 유틸\r\n * @param {Object} promptData - LLM에 전달할 프롬프트 데이터\r\n * @param {Function} setIsTextLoading - 로딩 상태 setter\r\n * @returns {Promise<Object>} LLM 응답(JSON)\r\n */async function callGeminiLLM(promptData,setIsTextLoading){setIsTextLoading(true);const apiKey=\"AIzaSyDC11rqjU30OJnLjaBFOaazZV0klM5raU8\";const apiUrl=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;// 프롬프트 구성\nconst userPrompt=`\\n현재 게임 단계: ${promptData.phase}\\n플레이어 직업: ${promptData.character.profession}\\n플레이어 초기 동기: ${promptData.character.initialMotivation}\\n현재 능력치: ${JSON.stringify(promptData.character.stats)}\\n현재 인벤토리: ${JSON.stringify(promptData.character.inventory)}\\n현재 위치: ${promptData.character.currentLocation}\\n현재 평판: ${JSON.stringify(promptData.character.reputation)}\\n현재 활성 퀘스트: ${JSON.stringify(promptData.character.activeQuests)}\\n현재 동료: ${JSON.stringify(promptData.character.companions)}\\n이전 게임 로그 (마지막 5개 항목): ${JSON.stringify(promptData.history.slice(-5))}\\n플레이어의 마지막 선택: ${promptData.playerChoice}\\n\\n**현재 접속 중인 다른 플레이어들:**\\n${JSON.stringify(promptData.activeUsers)}\\n\\n**현재 플레이어와 관련된 최근 개인 대화 내용 (LLM이 시나리오에 우선 반영):**\\n${promptData.privateChatHistory&&promptData.privateChatHistory.length>0?JSON.stringify(promptData.privateChatHistory.slice(-5)):'없음'}\\n\\n위 정보를 바탕으로 다음 스토리 부분을 한국어로 생성하고, 시스템 프롬프트의 JSON 스키마에 따라 선택지를 제공하십시오.\\n`;const chatHistory=[{role:\"user\",parts:[{text:SYSTEM_PROMPT}]},{role:\"user\",parts:[{text:userPrompt}]}];const payload={contents:chatHistory};try{var _result$candidates$,_result$candidates$$c,_result$candidates$$c2;const response=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!response.ok){const errorBody=await response.text();throw new Error(`HTTP error! status: ${response.status}, body: ${errorBody}`);}const result=await response.json();if(result.candidates&&((_result$candidates$=result.candidates[0])===null||_result$candidates$===void 0?void 0:(_result$candidates$$c=_result$candidates$.content)===null||_result$candidates$$c===void 0?void 0:(_result$candidates$$c2=_result$candidates$$c.parts)===null||_result$candidates$$c2===void 0?void 0:_result$candidates$$c2.length)>0){let llmOutputText=result.candidates[0].content.parts[0].text;// JSON 추출\nconst jsonMatch=llmOutputText.match(/\\{[\\s\\S]*\\}/);if(jsonMatch){llmOutputText=jsonMatch[0];}else{throw new Error(\"Valid JSON object not found in LLM response.\");}// JSON 파싱\ntry{const llmOutput=JSON.parse(llmOutputText);return llmOutput;}catch(parsingError){throw new Error(`LLM response was not valid JSON. Details: ${parsingError.message}`);}}else{throw new Error(\"Invalid LLM response structure.\");}}catch(error){return{story:`오류: LLM API 호출 중 문제가 발생했습니다: ${error.message}. 네트워크 연결을 확인하고 다시 시도해주세요.`,choices:[\"다시 시도\"],inventoryUpdates:promptData.character.inventory,statChanges:promptData.character.stats,location:promptData.character.currentLocation,reputationUpdates:promptData.character.reputation,activeQuestsUpdates:promptData.character.activeQuests,companionsUpdates:promptData.character.companions};}finally{setIsTextLoading(false);}}// =====================[ 유틸리티 함수 및 상태 관리 개선 ]=====================\n/**\r\n * 객체가 비어있는지 확인\r\n * @param {Object} obj\r\n * @returns {boolean}\r\n */function isObjectEmpty(obj){return Object.keys(obj).length===0&&obj.constructor===Object;}// =====================[ 이하 기존 App.jsx 코드 ]=====================\n// - 주요 함수/로직/상태에 한글 JSDoc 및 인라인 주석 추가 (주석 강화)\n// - useCallback/useMemo 등 React 최적화 훅 활용 (성능 최적화)\n// ... App 함수 내에서 적용 ...\nfunction App(){/**\r\n   * 게임 로그(개인)\r\n   * @type {[string[], Function]}\r\n   */const[gameLog,setGameLog]=useState([]);/**\r\n   * LLM 텍스트 응답 로딩 상태\r\n   */const[isTextLoading,setIsTextLoading]=useState(false);/**\r\n   * 게임 단계: 'characterSelection' | 'playing'\r\n   */const[gamePhase,setGamePhase]=useState('characterSelection');/**\r\n   * 플레이어 캐릭터 정보(직업, 능력치, 인벤토리, 동기, 위치, 평판, 퀘스트, 동료)\r\n   */const[playerCharacter,setPlayerCharacter]=useState({profession:'',stats:{strength:10,intelligence:10,agility:10,charisma:10},inventory:[],initialMotivation:'',currentLocation:'방랑자의 안식처',reputation:{},activeQuests:[],companions:[]});/**\r\n   * 현재 선택지(버튼)\r\n   */const[currentChoices,setCurrentChoices]=useState([]);/**\r\n   * 피드백 모달 표시 상태\r\n   */const[showFeedbackModal,setShowFeedbackModal]=useState(false);/**\r\n   * 피드백 텍스트\r\n   */const[feedbackText,setFeedbackText]=useState('');/**\r\n   * 공유 게임 로그(멀티플레이어)\r\n   */const[sharedGameLog,setSharedGameLog]=useState([]);/**\r\n   * 현재 접속 중인 플레이어 목록\r\n   */const[activeUsers,setActiveUsers]=useState([]);/**\r\n   * 공개 채팅 메시지 목록\r\n   */const[chatMessages,setChatMessages]=useState([]);/**\r\n   * 공개 채팅 입력값\r\n   */const[currentChatMessage,setCurrentChatMessage]=useState('');/**\r\n   * 개인 채팅 모달 표시 상태\r\n   */const[showPlayerChatModal,setShowPlayerChatModal]=useState(false);/**\r\n   * 선택된 개인 채팅 상대 정보\r\n   */const[selectedPlayerForChat,setSelectedPlayerForChat]=useState(null);/**\r\n   * 개인 채팅 메시지 목록\r\n   */const[privateChatMessages,setPrivateChatMessages]=useState([]);/**\r\n   * 개인 채팅 입력값\r\n   */const[currentPrivateChatMessage,setCurrentPrivateChatMessage]=useState('');/**\r\n   * 개인 채팅 모달 수동 닫힘 여부\r\n   */const[isPrivateChatModalManuallyClosed,setIsPrivateChatModalManuallyClosed]=useState(false);/**\r\n   * 동료 시나리오 진행 상태\r\n   */const[isCompanionActionInProgress,setIsCompanionActionInProgress]=useState(false);/**\r\n   * 현재 행동 중인 플레이어 정보\r\n   */const[actingPlayer,setActingPlayer]=useState(null);// Firebase 및 인증 상태 (useFirebaseInit 훅 사용)\nconst{db,auth,userId,isAuthReady}=useFirebaseInit(setGameLog);// 스크롤을 항상 아래로 유지하기 위한 ref\nconst logEndRef=useRef(null);const sharedLogEndRef=useRef(null);const chatEndRef=useRef(null);const privateChatEndRef=useRef(null);// Firestore 실시간 리스너 등록 (useFirestoreListeners 훅 사용)\nuseFirestoreListeners({db,appId,userId,isAuthReady,playerCharacter,setSharedGameLog,setActiveUsers,setChatMessages,setIsCompanionActionInProgress,setActingPlayer});/**\r\n   * 플레이어 턴 여부 계산\r\n   */const isMyTurn=!isCompanionActionInProgress||actingPlayer&&actingPlayer.id===userId;/**\r\n   * 동료 시스템 활성화 여부\r\n   */const isCompanionSystemActive=playerCharacter.companions.length>0;/**\r\n   * 플레이어 직업 선택지 목록 (useMemo로 캐싱)\r\n   */const professionChoices=useMemo(()=>Object.keys(professions).map(key=>`${key}. ${professions[key].name}`),[]);/**\r\n   * 공개 채팅 메시지 전송 (useCallback으로 메모이제이션)\r\n   */const sendChatMessage=useCallback(async()=>{if(!db||!userId||!isAuthReady||!currentChatMessage.trim())return;try{const chatCollectionRef=collection(db,'artifacts',appId,'public','data','chatMessages');await addDoc(chatCollectionRef,{userId:userId,displayName:`플레이어 ${userId.substring(0,4)}`,message:currentChatMessage,timestamp:serverTimestamp()});setCurrentChatMessage('');}catch(error){console.error(\"공개 채팅 메시지 전송 오류:\",error);}},[db,userId,isAuthReady,currentChatMessage]);/**\r\n   * 선택지 버튼 렌더링 (useMemo로 캐싱)\r\n   */const choiceButtons=useMemo(()=>currentChoices.map((choice,index)=>/*#__PURE__*/_jsx(\"button\",{className:\"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-md shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed\",onClick:()=>handleChoiceClick(choice),disabled:isTextLoading||isCompanionSystemActive&&!isMyTurn,children:choice},index)),[currentChoices,isTextLoading,isCompanionSystemActive,isMyTurn,handleChoiceClick]);// ... 이하 렌더링/핸들러/로직에도 한글 주석 추가 ...\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-900 text-gray-100 flex flex-col items-center justify-center p-4 font-sans\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-5xl bg-gray-800 rounded-lg shadow-xl p-6 md:p-8 flex flex-col lg:flex-row space-y-6 lg:space-y-0 lg:space-x-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-full lg:w-2/3 space-y-6\",children:[isAuthReady&&userId&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 text-center mb-2\",children:[\"\\uC0AC\\uC6A9\\uC790 ID: \",userId]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow bg-gray-700 p-4 rounded-md overflow-y-auto h-96 custom-scrollbar text-sm md:text-base leading-relaxed\",children:[gameLog.map((line,index)=>/*#__PURE__*/_jsx(\"p\",{className:\"whitespace-pre-wrap mb-1\",dangerouslySetInnerHTML:{__html:line.replace(/\\n/g,'<br />')}},index)),isTextLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center items-center mt-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-300\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-3 text-gray-400\",children:\"\\uC774\\uC57C\\uAE30\\uB97C \\uC0DD\\uC131 \\uC911...\"})]}),isCompanionSystemActive&&isCompanionActionInProgress&&!isMyTurn&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-yellow-400 font-semibold p-2 bg-black bg-opacity-20 rounded-md mt-2\",children:actingPlayer?`${actingPlayer.displayName}님이 선택하고 있습니다...`:\"동료가 선택하고 있습니다...\"}),/*#__PURE__*/_jsx(\"div\",{ref:logEndRef}),\" \"]}),gamePhase==='playing'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-700 p-3 rounded-md text-xs md:text-sm text-gray-300 space-y-1\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-100\",children:\"\\uC9C1\\uC5C5:\"}),\" \",playerCharacter.profession]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-100\",children:\"\\uC704\\uCE58:\"}),\" \",playerCharacter.currentLocation]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-100\",children:\"\\uB2A5\\uB825\\uCE58:\"}),\" \\uD798(\",playerCharacter.stats.strength,\") \\uC9C0\\uB2A5(\",playerCharacter.stats.intelligence,\") \\uBBFC\\uCCA9(\",playerCharacter.stats.agility,\") \\uCE74\\uB9AC\\uC2A4\\uB9C8(\",playerCharacter.stats.charisma,\")\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-100\",children:\"\\uC778\\uBCA4\\uD1A0\\uB9AC:\"}),\" \",playerCharacter.inventory.length>0?playerCharacter.inventory.join(', '):'비어있음']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-100\",children:\"\\uD3C9\\uD310:\"}),\" \",Object.keys(playerCharacter.reputation).length>0?Object.entries(playerCharacter.reputation).map(_ref2=>{let[key,value]=_ref2;return`${key}: ${value}`;}).join(', '):'없음']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-100\",children:\"\\uD018\\uC2A4\\uD2B8:\"}),\" \",playerCharacter.activeQuests.length>0?playerCharacter.activeQuests.join(', '):'없음']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-100\",children:\"\\uB3D9\\uB8CC:\"}),\" \",playerCharacter.companions.length>0?playerCharacter.companions.join(', '):'없음']})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col gap-3\",children:choiceButtons}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row gap-3 mt-4\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"flex-1 px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-md shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed\",onClick:saveGame,disabled:isTextLoading||!isAuthReady||!userId||gamePhase==='characterSelection',children:\"\\uAC8C\\uC784 \\uC800\\uC7A5\"}),/*#__PURE__*/_jsx(\"button\",{className:\"flex-1 px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-md shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed\",onClick:loadGame,disabled:isTextLoading||!isAuthReady||!userId,children:\"\\uAC8C\\uC784 \\uBD88\\uB7EC\\uC624\\uAE30\"}),/*#__PURE__*/_jsx(\"button\",{className:\"flex-1 px-6 py-3 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-md shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed\",onClick:()=>setShowFeedbackModal(true),disabled:isTextLoading||!isAuthReady||!userId,children:\"\\uD53C\\uB4DC\\uBC31 \\uBCF4\\uB0B4\\uAE30\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full lg:w-1/3 flex flex-col space-y-6 bg-gray-700 p-4 rounded-lg shadow-inner\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-100 text-center mb-4\",children:\"\\uACF5\\uC720\\uB41C \\uBAA8\\uD5D8\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-600 p-3 rounded-md h-48 overflow-y-auto custom-scrollbar\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-md font-semibold text-gray-200 mb-2\",children:\"\\uD604\\uC7AC \\uD50C\\uB808\\uC774\\uC5B4\\uB4E4:\"}),activeUsers.length>0?/*#__PURE__*/_jsx(\"ul\",{className:\"text-sm text-gray-300 space-y-1\",children:activeUsers.map(user=>/*#__PURE__*/_jsxs(\"li\",{className:\"truncate flex justify-between items-center p-1 rounded-md hover:bg-gray-500 cursor-pointer\",onDoubleClick:()=>user.id!==userId&&openPlayerChatModal(user),children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-blue-300\",children:user.displayName}),user.isCompanion&&/*#__PURE__*/_jsx(\"span\",{className:\"text-green-400 ml-2\",children:\"(\\uB3D9\\uB8CC)\"})]}),user.id!==userId&&/*#__PURE__*/_jsx(\"button\",{className:\"ml-2 px-3 py-1 bg-indigo-500 hover:bg-indigo-600 text-white text-xs rounded-md\",onClick:()=>openPlayerChatModal(user),children:\"\\uB300\\uD654\\uD558\\uAE30\"})]},user.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"\\uD65C\\uB3D9 \\uC911\\uC778 \\uD50C\\uB808\\uC774\\uC5B4\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-600 p-3 rounded-md flex-grow h-96 overflow-y-auto custom-scrollbar\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-md font-semibold text-gray-200 mb-2\",children:\"\\uBAA8\\uB4E0 \\uD50C\\uB808\\uC774\\uC5B4\\uC758 \\uD65C\\uB3D9:\"}),sharedGameLog.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-300 space-y-2\",children:[sharedGameLog.map(logEntry=>/*#__PURE__*/_jsxs(\"div\",{className:\"border-b border-gray-500 pb-2 last:border-b-0\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-400 mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-purple-300\",children:logEntry.displayName}),\" (\",logEntry.timestamp?new Date(logEntry.timestamp.toMillis()).toLocaleTimeString():'시간 없음',\")\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"whitespace-pre-wrap\",dangerouslySetInnerHTML:{__html:logEntry.content.replace(/\\n/g,'<br />')}})]},logEntry.id)),/*#__PURE__*/_jsx(\"div\",{ref:sharedLogEndRef})]}):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"\\uACF5\\uC720\\uB41C \\uD65C\\uB3D9\\uC774 \\uC544\\uC9C1 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-600 p-3 rounded-md flex flex-col h-64\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-md font-semibold text-gray-200 mb-2\",children:\"\\uACF5\\uAC1C \\uCC44\\uD305:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow overflow-y-auto custom-scrollbar mb-3 text-sm text-gray-300 space-y-2\",children:[chatMessages.length>0?chatMessages.map(msg=>/*#__PURE__*/_jsxs(\"div\",{className:\"border-b border-gray-500 pb-1 last:border-b-0\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-400\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-green-300\",children:msg.displayName}),\" (\",msg.timestamp?new Date(msg.timestamp.toMillis()).toLocaleTimeString():'시간 없음',\"):\"]}),/*#__PURE__*/_jsx(\"p\",{children:msg.message})]},msg.id)):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"\\uC544\\uC9C1 \\uCC44\\uD305 \\uBA54\\uC2DC\\uC9C0\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"div\",{ref:chatEndRef}),\" \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"flex-grow p-2 rounded-l-md bg-gray-700 border border-gray-600 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm\",placeholder:\"\\uBA54\\uC2DC\\uC9C0\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694...\",value:currentChatMessage,onChange:e=>setCurrentChatMessage(e.target.value),onKeyPress:e=>{if(e.key==='Enter'){sendChatMessage();}},disabled:!isAuthReady||!userId}),/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-r-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm\",onClick:sendChatMessage,disabled:!isAuthReady||!userId||!currentChatMessage.trim(),children:\"\\uBCF4\\uB0B4\\uAE30\"})]})]})]})]}),showFeedbackModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-100\",children:\"\\uD53C\\uB4DC\\uBC31 \\uBCF4\\uB0B4\\uAE30\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"w-full p-3 rounded-md bg-gray-700 border border-gray-600 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 h-32 resize-none\",placeholder:\"\\uAC8C\\uC784\\uC5D0 \\uB300\\uD55C \\uD53C\\uB4DC\\uBC31\\uC744 \\uC5EC\\uAE30\\uC5D0 \\uC791\\uC131\\uD574\\uC8FC\\uC138\\uC694...\",value:feedbackText,onChange:e=>setFeedbackText(e.target.value),disabled:isTextLoading}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\",onClick:()=>setShowFeedbackModal(false),disabled:isTextLoading,children:\"\\uCDE8\\uC18C\"}),/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\",onClick:sendFeedback,disabled:isTextLoading||!feedbackText.trim(),children:\"\\uBCF4\\uB0B4\\uAE30\"})]})]})}),showPlayerChatModal&&selectedPlayerForChat&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md space-y-4 flex flex-col h-3/4 max-h-[80vh]\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-gray-100\",children:[selectedPlayerForChat.displayName,\" (\",selectedPlayerForChat.profession,\") \\uB2D8\\uACFC \\uB300\\uD654\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow bg-gray-700 p-3 rounded-md overflow-y-auto custom-scrollbar text-sm text-gray-300 space-y-2\",children:[privateChatMessages.length>0?privateChatMessages.map(msg=>/*#__PURE__*/_jsx(\"div\",{className:`flex ${msg.senderId===userId?'justify-end':'justify-start'}`,children:/*#__PURE__*/_jsxs(\"div\",{className:`p-2 rounded-lg max-w-[80%] ${msg.senderId===userId?'bg-blue-600 text-white':'bg-gray-600 text-gray-100'}`,children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-300 mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:msg.displayName}),\" (\",msg.timestamp?new Date(msg.timestamp.toMillis()).toLocaleTimeString():'시간 없음',\")\"]}),/*#__PURE__*/_jsx(\"p\",{children:msg.message})]})},msg.id)):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400 text-center\",children:\"\\uC544\\uC9C1 \\uB300\\uD654\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4. \\uBA3C\\uC800 \\uBA54\\uC2DC\\uC9C0\\uB97C \\uBCF4\\uB0B4\\uC138\\uC694!\"}),/*#__PURE__*/_jsx(\"div\",{ref:privateChatEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"flex-grow p-2 rounded-l-md bg-gray-700 border border-gray-600 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm\",placeholder:\"\\uAC1C\\uC778 \\uBA54\\uC2DC\\uC9C0\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694...\",value:currentPrivateChatMessage,onChange:e=>setCurrentPrivateChatMessage(e.target.value),onKeyPress:e=>{if(e.key==='Enter'){sendPrivateChatMessage();}},disabled:!isAuthReady||!userId||!selectedPlayerForChat}),/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-r-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm\",onClick:sendPrivateChatMessage,disabled:!isAuthReady||!userId||!selectedPlayerForChat||!currentPrivateChatMessage.trim(),children:\"\\uBCF4\\uB0B4\\uAE30\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3 mt-4\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\",onClick:handleEndPrivateChatAndReflectScenario,disabled:isTextLoading||privateChatMessages.length===0,children:\"\\uB300\\uD654 \\uC885\\uB8CC \\uBC0F \\uC2DC\\uB098\\uB9AC\\uC624 \\uBC18\\uC601\"}),/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-md transition duration-300\",onClick:closePlayerChatModal,children:\"\\uB2EB\\uAE30\"})]})]})}),/*#__PURE__*/_jsx(\"style\",{children:`\n        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');\n        body {\n          font-family: 'Noto Sans KR', sans-serif;\n        }\n        .custom-scrollbar::-webkit-scrollbar {\n          width: 8px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-track {\n          background: #4a5568; /* gray-600 */\n          border-radius: 10px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #6b7280; /* gray-500 */\n          border-radius: 10px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #9ca3af; /* gray-400 */\n        }\n        `})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useMemo","initializeApp","getAuth","signInAnonymously","signInWithCustomToken","onAuthStateChanged","getFirestore","doc","setDoc","getDoc","collection","query","onSnapshot","serverTimestamp","addDoc","getDocs","deleteDoc","where","jsx","_jsx","jsxs","_jsxs","defaultFirebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","firebaseConfig","initialAuthToken","professions","name","motivation","useFirebaseInit","setGameLog","db","setDb","auth","setAuth","userId","setUserId","isAuthReady","setIsAuthReady","console","error","prev","app","firestoreDb","firebaseAuth","unsubscribeAuth","user","uid","useFirestoreListeners","_ref","playerCharacter","setSharedGameLog","setActiveUsers","setChatMessages","setIsCompanionActionInProgress","setActingPlayer","profession","companions","callGeminiLLM","promptData","setIsTextLoading","apiUrl","userPrompt","phase","character","initialMotivation","JSON","stringify","stats","inventory","currentLocation","reputation","activeQuests","history","slice","playerChoice","activeUsers","privateChatHistory","length","chatHistory","role","parts","text","SYSTEM_PROMPT","payload","contents","_result$candidates$","_result$candidates$$c","_result$candidates$$c2","response","fetch","method","headers","body","ok","errorBody","Error","status","result","json","candidates","content","llmOutputText","jsonMatch","match","llmOutput","parse","parsingError","message","story","choices","inventoryUpdates","statChanges","location","reputationUpdates","activeQuestsUpdates","companionsUpdates","isObjectEmpty","obj","Object","keys","constructor","App","gameLog","isTextLoading","gamePhase","setGamePhase","setPlayerCharacter","strength","intelligence","agility","charisma","currentChoices","setCurrentChoices","showFeedbackModal","setShowFeedbackModal","feedbackText","setFeedbackText","sharedGameLog","chatMessages","currentChatMessage","setCurrentChatMessage","showPlayerChatModal","setShowPlayerChatModal","selectedPlayerForChat","setSelectedPlayerForChat","privateChatMessages","setPrivateChatMessages","currentPrivateChatMessage","setCurrentPrivateChatMessage","isPrivateChatModalManuallyClosed","setIsPrivateChatModalManuallyClosed","isCompanionActionInProgress","actingPlayer","logEndRef","sharedLogEndRef","chatEndRef","privateChatEndRef","isMyTurn","id","isCompanionSystemActive","professionChoices","map","key","sendChatMessage","trim","chatCollectionRef","displayName","substring","timestamp","choiceButtons","choice","index","className","onClick","handleChoiceClick","disabled","children","line","dangerouslySetInnerHTML","__html","replace","ref","join","entries","_ref2","value","saveGame","loadGame","onDoubleClick","openPlayerChatModal","isCompanion","logEntry","Date","toMillis","toLocaleTimeString","msg","type","placeholder","onChange","e","target","onKeyPress","sendFeedback","senderId","sendPrivateChatMessage","handleEndPrivateChatAndReflectScenario","closePlayerChatModal"],"sources":["C:/workspaces/gemini/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\r\nimport { initializeApp } from 'firebase/app';\r\nimport {\r\n  getAuth,\r\n  signInAnonymously, // 익명 로그인 임포트\r\n  signInWithCustomToken, // 커스텀 토큰 로그인 임포트\r\n  onAuthStateChanged\r\n} from 'firebase/auth';\r\nimport {\r\n  getFirestore,\r\n  doc,\r\n  setDoc,\r\n  getDoc,\r\n  collection,\r\n  query,\r\n  onSnapshot,\r\n  serverTimestamp,\r\n  addDoc,\r\n  getDocs, // 추가: 문서 목록을 가져오기 위해\r\n  deleteDoc, // 추가: 문서를 삭제하기 위해\r\n  where // [수정] where 임포트 추가\r\n} from 'firebase/firestore';\r\n\r\n// ====================================================================\r\n// Firebase configuration information 수정금지\r\nconst defaultFirebaseConfig = {\r\n  apiKey: \"AIzaSyBNJtmpRWzjobrY556bnHkwbZmpFJqgPX8\",\r\n  authDomain: \"text-adventure-game-cb731.firebaseapp.com\",\r\n  projectId: \"text-adventure-game-cb731\",\r\n  storageBucket: \"text-adventure-game-cb731.firebaseapis.com\",\r\n  messagingSenderId: \"1092941614820\",\r\n  appId: \"1:1092941614820:web:5545f36014b73c268026f1\",\r\n  measurementId: \"G-FNGF42T1FP\"\r\n};\r\n\r\n// 수정금지\r\nconst firebaseConfig = defaultFirebaseConfig;\r\nconst appId = firebaseConfig.projectId;\r\nconst initialAuthToken = null;\r\n// ====================================================================\r\n\r\n// Initial profession information and motivations for the game\r\nconst professions = {\r\n  '1': { name: '몰락한 귀족/기사', motivation: '가문의 몰락 원인을 조사하고, 잃어버린 가문의 보물을 찾아야 합니다.' },\r\n  '2': { name: '평범한 마을 사람/농부', motivation: '갑자기 마을에 나타난 괴생명체로부터 마을을 지켜야 합니다.' },\r\n  '3': { name: '젊은 마법사/견습생', motivation: '스승님의 실종에 대한 단서를 찾아야 합니다.' },\r\n  '4': { name: '용병/모험가', motivation: '의뢰받은 임무를 수행하던 중 예상치 못한 사건에 휘말렸습니다.' },\r\n  '5': { name: '도적/암살자', motivation: '길드에서 내려온 첫 번째 임무를 완수하고, 그 과정에서 수상한 음모를 감지해야 합니다.' },\r\n  '6': { name: '왕족/공주/왕자', motivation: '왕실 내의 불화와 암투 속에서 자신의 입지를 다져야 합니다.' },\r\n};\r\n\r\n// =====================[ 파이어베이스 유틸/훅 함수 분리 ]=====================\r\n\r\n/**\r\n * Firebase 인증 및 Firestore 인스턴스 초기화\r\n * @returns {Object} { db, auth, userId, isAuthReady }\r\n */\r\nfunction useFirebaseInit(setGameLog) {\r\n  const [db, setDb] = useState(null);\r\n  const [auth, setAuth] = useState(null);\r\n  const [userId, setUserId] = useState(null);\r\n  const [isAuthReady, setIsAuthReady] = useState(false);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      if (firebaseConfig.apiKey === \"YOUR_API_KEY\" || !firebaseConfig.apiKey) {\r\n        console.error(\"Firebase initialization error: firebaseConfig.apiKey must be replaced with your actual Firebase API key.\");\r\n        setGameLog(prev => [...prev, \"오류: Firebase API 키가 올바르게 설정되지 않았습니다. 코드를 확인해주세요.\"]);\r\n        return;\r\n      }\r\n      const app = initializeApp(firebaseConfig);\r\n      const firestoreDb = getFirestore(app);\r\n      const firebaseAuth = getAuth(app);\r\n      setDb(firestoreDb);\r\n      setAuth(firebaseAuth);\r\n      const unsubscribeAuth = onAuthStateChanged(firebaseAuth, async (user) => {\r\n        if (user) {\r\n          setUserId(user.uid);\r\n          setIsAuthReady(true);\r\n        } else {\r\n          try {\r\n            if (initialAuthToken) {\r\n              await signInWithCustomToken(firebaseAuth, initialAuthToken);\r\n            } else {\r\n              await signInAnonymously(firebaseAuth);\r\n            }\r\n          } catch (error) {\r\n            console.error(\"Firebase authentication failed:\", error);\r\n            setGameLog(prev => [...prev, \"오류: Firebase 인증에 실패했습니다.\"]);\r\n          }\r\n        }\r\n      });\r\n      return () => unsubscribeAuth();\r\n    } catch (error) {\r\n      console.error(\"Firebase initialization error:\", error);\r\n      setGameLog(prev => [...prev, \"오류: 게임을 초기화할 수 없습니다.\"]);\r\n    }\r\n  }, []);\r\n\r\n  return { db, auth, userId, isAuthReady };\r\n}\r\n\r\n/**\r\n * Firestore 실시간 리스너 등록 (공유 로그, 유저, 채팅 등)\r\n * @param {Object} params - 필요한 파라미터들\r\n */\r\nfunction useFirestoreListeners({ db, appId, userId, isAuthReady, playerCharacter, setSharedGameLog, setActiveUsers, setChatMessages, setIsCompanionActionInProgress, setActingPlayer }) {\r\n  useEffect(() => {\r\n    if (!db || !isAuthReady || !userId) return;\r\n    // ... 기존 리스너 등록 코드 ...\r\n    // (공유 로그, 유저, 채팅, 게임 상태 등)\r\n    // 기존 useEffect 코드 복사/이동\r\n  }, [db, isAuthReady, userId, playerCharacter.profession, playerCharacter.companions]);\r\n}\r\n\r\n// =====================[ LLM 호출/파싱 유틸 함수 분리 ]=====================\r\n\r\n/**\r\n * Gemini LLM API 호출 및 JSON 파싱 유틸\r\n * @param {Object} promptData - LLM에 전달할 프롬프트 데이터\r\n * @param {Function} setIsTextLoading - 로딩 상태 setter\r\n * @returns {Promise<Object>} LLM 응답(JSON)\r\n */\r\nasync function callGeminiLLM(promptData, setIsTextLoading) {\r\n  setIsTextLoading(true);\r\n  const apiKey = \"AIzaSyDC11rqjU30OJnLjaBFOaazZV0klM5raU8\";\r\n  const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;\r\n\r\n  // 프롬프트 구성\r\n  const userPrompt = `\\n현재 게임 단계: ${promptData.phase}\\n플레이어 직업: ${promptData.character.profession}\\n플레이어 초기 동기: ${promptData.character.initialMotivation}\\n현재 능력치: ${JSON.stringify(promptData.character.stats)}\\n현재 인벤토리: ${JSON.stringify(promptData.character.inventory)}\\n현재 위치: ${promptData.character.currentLocation}\\n현재 평판: ${JSON.stringify(promptData.character.reputation)}\\n현재 활성 퀘스트: ${JSON.stringify(promptData.character.activeQuests)}\\n현재 동료: ${JSON.stringify(promptData.character.companions)}\\n이전 게임 로그 (마지막 5개 항목): ${JSON.stringify(promptData.history.slice(-5))}\\n플레이어의 마지막 선택: ${promptData.playerChoice}\\n\\n**현재 접속 중인 다른 플레이어들:**\\n${JSON.stringify(promptData.activeUsers)}\\n\\n**현재 플레이어와 관련된 최근 개인 대화 내용 (LLM이 시나리오에 우선 반영):**\\n${promptData.privateChatHistory && promptData.privateChatHistory.length > 0 ? JSON.stringify(promptData.privateChatHistory.slice(-5)) : '없음'}\\n\\n위 정보를 바탕으로 다음 스토리 부분을 한국어로 생성하고, 시스템 프롬프트의 JSON 스키마에 따라 선택지를 제공하십시오.\\n`;\r\n\r\n  const chatHistory = [\r\n    { role: \"user\", parts: [{ text: SYSTEM_PROMPT }] },\r\n    { role: \"user\", parts: [{ text: userPrompt }] }\r\n  ];\r\n\r\n  const payload = { contents: chatHistory };\r\n\r\n  try {\r\n    const response = await fetch(apiUrl, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(payload)\r\n    });\r\n    if (!response.ok) {\r\n      const errorBody = await response.text();\r\n      throw new Error(`HTTP error! status: ${response.status}, body: ${errorBody}`);\r\n    }\r\n    const result = await response.json();\r\n    if (result.candidates && result.candidates[0]?.content?.parts?.length > 0) {\r\n      let llmOutputText = result.candidates[0].content.parts[0].text;\r\n      // JSON 추출\r\n      const jsonMatch = llmOutputText.match(/\\{[\\s\\S]*\\}/);\r\n      if (jsonMatch) {\r\n        llmOutputText = jsonMatch[0];\r\n      } else {\r\n        throw new Error(\"Valid JSON object not found in LLM response.\");\r\n      }\r\n      // JSON 파싱\r\n      try {\r\n        const llmOutput = JSON.parse(llmOutputText);\r\n        return llmOutput;\r\n      } catch (parsingError) {\r\n        throw new Error(`LLM response was not valid JSON. Details: ${parsingError.message}`);\r\n      }\r\n    } else {\r\n      throw new Error(\"Invalid LLM response structure.\");\r\n    }\r\n  } catch (error) {\r\n    return {\r\n      story: `오류: LLM API 호출 중 문제가 발생했습니다: ${error.message}. 네트워크 연결을 확인하고 다시 시도해주세요.`,\r\n      choices: [\"다시 시도\"],\r\n      inventoryUpdates: promptData.character.inventory,\r\n      statChanges: promptData.character.stats,\r\n      location: promptData.character.currentLocation,\r\n      reputationUpdates: promptData.character.reputation,\r\n      activeQuestsUpdates: promptData.character.activeQuests,\r\n      companionsUpdates: promptData.character.companions,\r\n    };\r\n  } finally {\r\n    setIsTextLoading(false);\r\n  }\r\n}\r\n\r\n// =====================[ 유틸리티 함수 및 상태 관리 개선 ]=====================\r\n\r\n/**\r\n * 객체가 비어있는지 확인\r\n * @param {Object} obj\r\n * @returns {boolean}\r\n */\r\nfunction isObjectEmpty(obj) {\r\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\r\n}\r\n\r\n// =====================[ 이하 기존 App.jsx 코드 ]=====================\r\n// - 주요 함수/로직/상태에 한글 JSDoc 및 인라인 주석 추가 (주석 강화)\r\n// - useCallback/useMemo 등 React 최적화 훅 활용 (성능 최적화)\r\n// ... App 함수 내에서 적용 ...\r\n\r\nfunction App() {\r\n  /**\r\n   * 게임 로그(개인)\r\n   * @type {[string[], Function]}\r\n   */\r\n  const [gameLog, setGameLog] = useState([]);\r\n  /**\r\n   * LLM 텍스트 응답 로딩 상태\r\n   */\r\n  const [isTextLoading, setIsTextLoading] = useState(false);\r\n  /**\r\n   * 게임 단계: 'characterSelection' | 'playing'\r\n   */\r\n  const [gamePhase, setGamePhase] = useState('characterSelection');\r\n  /**\r\n   * 플레이어 캐릭터 정보(직업, 능력치, 인벤토리, 동기, 위치, 평판, 퀘스트, 동료)\r\n   */\r\n  const [playerCharacter, setPlayerCharacter] = useState({\r\n    profession: '',\r\n    stats: { strength: 10, intelligence: 10, agility: 10, charisma: 10 },\r\n    inventory: [],\r\n    initialMotivation: '',\r\n    currentLocation: '방랑자의 안식처',\r\n    reputation: {},\r\n    activeQuests: [],\r\n    companions: [],\r\n  });\r\n  /**\r\n   * 현재 선택지(버튼)\r\n   */\r\n  const [currentChoices, setCurrentChoices] = useState([]);\r\n  /**\r\n   * 피드백 모달 표시 상태\r\n   */\r\n  const [showFeedbackModal, setShowFeedbackModal] = useState(false);\r\n  /**\r\n   * 피드백 텍스트\r\n   */\r\n  const [feedbackText, setFeedbackText] = useState('');\r\n  /**\r\n   * 공유 게임 로그(멀티플레이어)\r\n   */\r\n  const [sharedGameLog, setSharedGameLog] = useState([]);\r\n  /**\r\n   * 현재 접속 중인 플레이어 목록\r\n   */\r\n  const [activeUsers, setActiveUsers] = useState([]);\r\n  /**\r\n   * 공개 채팅 메시지 목록\r\n   */\r\n  const [chatMessages, setChatMessages] = useState([]);\r\n  /**\r\n   * 공개 채팅 입력값\r\n   */\r\n  const [currentChatMessage, setCurrentChatMessage] = useState('');\r\n  /**\r\n   * 개인 채팅 모달 표시 상태\r\n   */\r\n  const [showPlayerChatModal, setShowPlayerChatModal] = useState(false);\r\n  /**\r\n   * 선택된 개인 채팅 상대 정보\r\n   */\r\n  const [selectedPlayerForChat, setSelectedPlayerForChat] = useState(null);\r\n  /**\r\n   * 개인 채팅 메시지 목록\r\n   */\r\n  const [privateChatMessages, setPrivateChatMessages] = useState([]);\r\n  /**\r\n   * 개인 채팅 입력값\r\n   */\r\n  const [currentPrivateChatMessage, setCurrentPrivateChatMessage] = useState('');\r\n  /**\r\n   * 개인 채팅 모달 수동 닫힘 여부\r\n   */\r\n  const [isPrivateChatModalManuallyClosed, setIsPrivateChatModalManuallyClosed] = useState(false);\r\n  /**\r\n   * 동료 시나리오 진행 상태\r\n   */\r\n  const [isCompanionActionInProgress, setIsCompanionActionInProgress] = useState(false);\r\n  /**\r\n   * 현재 행동 중인 플레이어 정보\r\n   */\r\n  const [actingPlayer, setActingPlayer] = useState(null);\r\n\r\n  // Firebase 및 인증 상태 (useFirebaseInit 훅 사용)\r\n  const { db, auth, userId, isAuthReady } = useFirebaseInit(setGameLog);\r\n\r\n  // 스크롤을 항상 아래로 유지하기 위한 ref\r\n  const logEndRef = useRef(null);\r\n  const sharedLogEndRef = useRef(null);\r\n  const chatEndRef = useRef(null);\r\n  const privateChatEndRef = useRef(null);\r\n\r\n  // Firestore 실시간 리스너 등록 (useFirestoreListeners 훅 사용)\r\n  useFirestoreListeners({ db, appId, userId, isAuthReady, playerCharacter, setSharedGameLog, setActiveUsers, setChatMessages, setIsCompanionActionInProgress, setActingPlayer });\r\n\r\n  /**\r\n   * 플레이어 턴 여부 계산\r\n   */\r\n  const isMyTurn = !isCompanionActionInProgress || (actingPlayer && actingPlayer.id === userId);\r\n  /**\r\n   * 동료 시스템 활성화 여부\r\n   */\r\n  const isCompanionSystemActive = playerCharacter.companions.length > 0;\r\n\r\n  /**\r\n   * 플레이어 직업 선택지 목록 (useMemo로 캐싱)\r\n   */\r\n  const professionChoices = useMemo(() =>\r\n    Object.keys(professions).map(key => `${key}. ${professions[key].name}`),\r\n    []\r\n  );\r\n\r\n  /**\r\n   * 공개 채팅 메시지 전송 (useCallback으로 메모이제이션)\r\n   */\r\n  const sendChatMessage = useCallback(async () => {\r\n    if (!db || !userId || !isAuthReady || !currentChatMessage.trim()) return;\r\n    try {\r\n      const chatCollectionRef = collection(db, 'artifacts', appId, 'public', 'data', 'chatMessages');\r\n      await addDoc(chatCollectionRef, {\r\n        userId: userId,\r\n        displayName: `플레이어 ${userId.substring(0, 4)}`,\r\n        message: currentChatMessage,\r\n        timestamp: serverTimestamp(),\r\n      });\r\n      setCurrentChatMessage('');\r\n    } catch (error) {\r\n      console.error(\"공개 채팅 메시지 전송 오류:\", error);\r\n    }\r\n  }, [db, userId, isAuthReady, currentChatMessage]);\r\n\r\n  /**\r\n   * 선택지 버튼 렌더링 (useMemo로 캐싱)\r\n   */\r\n  const choiceButtons = useMemo(() => (\r\n    currentChoices.map((choice, index) => (\r\n      <button\r\n        key={index}\r\n        className=\"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-md shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n        onClick={() => handleChoiceClick(choice)}\r\n        disabled={isTextLoading || (isCompanionSystemActive && !isMyTurn)}\r\n      >\r\n        {choice}\r\n      </button>\r\n    ))\r\n  ), [currentChoices, isTextLoading, isCompanionSystemActive, isMyTurn, handleChoiceClick]);\r\n\r\n  // ... 이하 렌더링/핸들러/로직에도 한글 주석 추가 ...\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-900 text-gray-100 flex flex-col items-center justify-center p-4 font-sans\">\r\n      <div className=\"w-full max-w-5xl bg-gray-800 rounded-lg shadow-xl p-6 md:p-8 flex flex-col lg:flex-row space-y-6 lg:space-y-0 lg:space-x-6\">\r\n        {/* 메인 게임 영역 */}\r\n        <div className=\"flex flex-col w-full lg:w-2/3 space-y-6\">\r\n          {/* 사용자 ID 표시 (디버깅 및 멀티유저 식별용) */}\r\n          {isAuthReady && userId && (\r\n            <div className=\"text-xs text-gray-500 text-center mb-2\">\r\n              사용자 ID: {userId}\r\n            </div>\r\n          )}\r\n\r\n          {/* 게임 텍스트 출력 영역 */}\r\n          <div className=\"flex-grow bg-gray-700 p-4 rounded-md overflow-y-auto h-96 custom-scrollbar text-sm md:text-base leading-relaxed\">\r\n            {gameLog.map((line, index) => (\r\n              <p key={index} className=\"whitespace-pre-wrap mb-1\" dangerouslySetInnerHTML={{ __html: line.replace(/\\n/g, '<br />') }}></p>\r\n            ))}\r\n            {isTextLoading && (\r\n              <div className=\"flex justify-center items-center mt-4\">\r\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-300\"></div>\r\n                <span className=\"ml-3 text-gray-400\">\r\n                  이야기를 생성 중...\r\n                </span>\r\n              </div>\r\n            )}\r\n            {/* 동료 턴 대기 메시지 */}\r\n            {isCompanionSystemActive && isCompanionActionInProgress && !isMyTurn && (\r\n                <div className=\"text-center text-yellow-400 font-semibold p-2 bg-black bg-opacity-20 rounded-md mt-2\">\r\n                    {actingPlayer ? `${actingPlayer.displayName}님이 선택하고 있습니다...` : \"동료가 선택하고 있습니다...\"}\r\n                </div>\r\n            )}\r\n            <div ref={logEndRef} /> {/* 스크롤 위치용 빈 div */}\r\n          </div>\r\n\r\n          {/* 캐릭터 정보 표시 */}\r\n          {gamePhase === 'playing' && (\r\n            <div className=\"bg-gray-700 p-3 rounded-md text-xs md:text-sm text-gray-300 space-y-1\">\r\n              <p><span className=\"font-semibold text-gray-100\">직업:</span> {playerCharacter.profession}</p>\r\n              <p><span className=\"font-semibold text-gray-100\">위치:</span> {playerCharacter.currentLocation}</p>\r\n              <p><span className=\"font-semibold text-gray-100\">능력치:</span> 힘({playerCharacter.stats.strength}) 지능({playerCharacter.stats.intelligence}) 민첩({playerCharacter.stats.agility}) 카리스마({playerCharacter.stats.charisma})</p>\r\n              <p><span className=\"font-semibold text-gray-100\">인벤토리:</span> {playerCharacter.inventory.length > 0 ? playerCharacter.inventory.join(', ') : '비어있음'}</p>\r\n              <p><span className=\"font-semibold text-gray-100\">평판:</span> {Object.keys(playerCharacter.reputation).length > 0 ? Object.entries(playerCharacter.reputation).map(([key, value]) => `${key}: ${value}`).join(', ') : '없음'}</p>\r\n              <p><span className=\"font-semibold text-gray-100\">퀘스트:</span> {playerCharacter.activeQuests.length > 0 ? playerCharacter.activeQuests.join(', ') : '없음'}</p>\r\n              <p><span className=\"font-semibold text-gray-100\">동료:</span> {playerCharacter.companions.length > 0 ? playerCharacter.companions.join(', ') : '없음'}</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* 선택지 버튼 영역 */}\r\n          <div className=\"flex flex-col gap-3\">\r\n            {choiceButtons}\r\n          </div>\r\n\r\n          {/* 저장/불러오기/피드백 버튼 */}\r\n          <div className=\"flex flex-col md:flex-row gap-3 mt-4\">\r\n            <button\r\n              className=\"flex-1 px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-md shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              onClick={saveGame}\r\n              disabled={isTextLoading || !isAuthReady || !userId || gamePhase === 'characterSelection'}\r\n            >\r\n              게임 저장\r\n            </button>\r\n            <button\r\n              className=\"flex-1 px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-md shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              onClick={loadGame}\r\n              disabled={isTextLoading || !isAuthReady || !userId}\r\n            >\r\n              게임 불러오기\r\n            </button>\r\n            <button\r\n              className=\"flex-1 px-6 py-3 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-md shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              onClick={() => setShowFeedbackModal(true)}\r\n              disabled={isTextLoading || !isAuthReady || !userId}\r\n            >\r\n              피드백 보내기\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* 멀티플레이어 사이드바 */}\r\n        <div className=\"w-full lg:w-1/3 flex flex-col space-y-6 bg-gray-700 p-4 rounded-lg shadow-inner\">\r\n          <h3 className=\"text-lg font-bold text-gray-100 text-center mb-4\">공유된 모험</h3>\r\n\r\n          {/* 현재 플레이어 목록 */}\r\n          <div className=\"bg-gray-600 p-3 rounded-md h-48 overflow-y-auto custom-scrollbar\">\r\n            <h4 className=\"text-md font-semibold text-gray-200 mb-2\">현재 플레이어들:</h4>\r\n            {activeUsers.length > 0 ? (\r\n              <ul className=\"text-sm text-gray-300 space-y-1\">\r\n                {activeUsers.map(user => (\r\n                  <li\r\n                    key={user.id}\r\n                    className=\"truncate flex justify-between items-center p-1 rounded-md hover:bg-gray-500 cursor-pointer\"\r\n                    onDoubleClick={() => user.id !== userId && openPlayerChatModal(user)}\r\n                  >\r\n                    <span>\r\n                      <span className=\"font-medium text-blue-300\">{user.displayName}</span>\r\n                       {/* 동료 표시 */}\r\n                       {user.isCompanion && <span className=\"text-green-400 ml-2\">(동료)</span>}\r\n                    </span>\r\n                    {user.id !== userId && (\r\n                      <button\r\n                        className=\"ml-2 px-3 py-1 bg-indigo-500 hover:bg-indigo-600 text-white text-xs rounded-md\"\r\n                        onClick={() => openPlayerChatModal(user)}\r\n                      >\r\n                        대화하기\r\n                      </button>\r\n                    )}\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            ) : (\r\n              <p className=\"text-sm text-gray-400\">활동 중인 플레이어가 없습니다.</p>\r\n            )}\r\n          </div>\r\n\r\n          {/* 공유 게임 로그 */}\r\n          <div className=\"bg-gray-600 p-3 rounded-md flex-grow h-96 overflow-y-auto custom-scrollbar\">\r\n            <h4 className=\"text-md font-semibold text-gray-200 mb-2\">모든 플레이어의 활동:</h4>\r\n            {sharedGameLog.length > 0 ? (\r\n              <div className=\"text-sm text-gray-300 space-y-2\">\r\n                {sharedGameLog.map((logEntry) => (\r\n                  <div key={logEntry.id} className=\"border-b border-gray-500 pb-2 last:border-b-0\">\r\n                    <p className=\"text-xs text-gray-400 mb-1\">\r\n                      <span className=\"font-medium text-purple-300\">{logEntry.displayName}</span> (\r\n                      {logEntry.timestamp ? new Date(logEntry.timestamp.toMillis()).toLocaleTimeString() : '시간 없음'})\r\n                    </p>\r\n                    <p className=\"whitespace-pre-wrap\" dangerouslySetInnerHTML={{ __html: logEntry.content.replace(/\\n/g, '<br />') }}></p>\r\n                  </div>\r\n                ))}\r\n                <div ref={sharedLogEndRef} />\r\n              </div>\r\n            ) : (\r\n              <p className=\"text-sm text-gray-400\">공유된 활동이 아직 없습니다.</p>\r\n            )}\r\n          </div>\r\n\r\n          {/* 공개 채팅 영역 */}\r\n          <div className=\"bg-gray-600 p-3 rounded-md flex flex-col h-64\">\r\n            <h4 className=\"text-md font-semibold text-gray-200 mb-2\">공개 채팅:</h4>\r\n            <div className=\"flex-grow overflow-y-auto custom-scrollbar mb-3 text-sm text-gray-300 space-y-2\">\r\n              {chatMessages.length > 0 ? (\r\n                chatMessages.map((msg) => (\r\n                  <div key={msg.id} className=\"border-b border-gray-500 pb-1 last:border-b-0\">\r\n                    <p className=\"text-xs text-gray-400\">\r\n                      <span className=\"font-medium text-green-300\">{msg.displayName}</span> (\r\n                      {msg.timestamp ? new Date(msg.timestamp.toMillis()).toLocaleTimeString() : '시간 없음'}):\r\n                    </p>\r\n                    <p>{msg.message}</p>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <p className=\"text-sm text-gray-400\">아직 채팅 메시지가 없습니다.</p>\r\n              )}\r\n              <div ref={chatEndRef} /> {/* 스크롤 위치용 빈 div */}\r\n            </div>\r\n            <div className=\"flex\">\r\n              <input\r\n                type=\"text\"\r\n                className=\"flex-grow p-2 rounded-l-md bg-gray-700 border border-gray-600 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm\"\r\n                placeholder=\"메시지를 입력하세요...\"\r\n                value={currentChatMessage}\r\n                onChange={(e) => setCurrentChatMessage(e.target.value)}\r\n                onKeyPress={(e) => {\r\n                  if (e.key === 'Enter') {\r\n                    sendChatMessage();\r\n                  }\r\n                }}\r\n                disabled={!isAuthReady || !userId}\r\n              />\r\n              <button\r\n                className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-r-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm\"\r\n                onClick={sendChatMessage}\r\n                disabled={!isAuthReady || !userId || !currentChatMessage.trim()}\r\n              >\r\n                보내기\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* 피드백 모달 */}\r\n      {showFeedbackModal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\">\r\n          <div className=\"bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md space-y-4\">\r\n            <h3 className=\"text-xl font-bold text-gray-100\">피드백 보내기</h3>\r\n            <textarea\r\n              className=\"w-full p-3 rounded-md bg-gray-700 border border-gray-600 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 h-32 resize-none\"\r\n              placeholder=\"게임에 대한 피드백을 여기에 작성해주세요...\"\r\n              value={feedbackText}\r\n              onChange={(e) => setFeedbackText(e.target.value)}\r\n              disabled={isTextLoading}\r\n            ></textarea>\r\n            <div className=\"flex justify-end gap-3\">\r\n              <button\r\n                className=\"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                onClick={() => setShowFeedbackModal(false)}\r\n                disabled={isTextLoading}\r\n              >\r\n                취소\r\n              </button>\r\n              <button\r\n                className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                onClick={sendFeedback}\r\n                disabled={isTextLoading || !feedbackText.trim()}\r\n              >\r\n                보내기\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* 개인 채팅 모달 (수정됨) */}\r\n      {showPlayerChatModal && selectedPlayerForChat && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\">\r\n          <div className=\"bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md space-y-4 flex flex-col h-3/4 max-h-[80vh]\">\r\n            <h3 className=\"text-xl font-bold text-gray-100\">\r\n              {selectedPlayerForChat.displayName} ({selectedPlayerForChat.profession}) 님과 대화\r\n            </h3>\r\n            <div className=\"flex-grow bg-gray-700 p-3 rounded-md overflow-y-auto custom-scrollbar text-sm text-gray-300 space-y-2\">\r\n              {privateChatMessages.length > 0 ? (\r\n                privateChatMessages.map((msg) => (\r\n                  <div key={msg.id} className={`flex ${msg.senderId === userId ? 'justify-end' : 'justify-start'}`}>\r\n                    <div className={`p-2 rounded-lg max-w-[80%] ${msg.senderId === userId ? 'bg-blue-600 text-white' : 'bg-gray-600 text-gray-100'}`}>\r\n                      <p className=\"text-xs text-gray-300 mb-1\">\r\n                        <span className=\"font-medium\">{msg.displayName}</span> (\r\n                        {msg.timestamp ? new Date(msg.timestamp.toMillis()).toLocaleTimeString() : '시간 없음'})\r\n                      </p>\r\n                      <p>{msg.message}</p>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <p className=\"text-sm text-gray-400 text-center\">아직 대화가 없습니다. 먼저 메시지를 보내세요!</p>\r\n              )}\r\n              <div ref={privateChatEndRef} />\r\n            </div>\r\n            <div className=\"flex\">\r\n              <input\r\n                type=\"text\"\r\n                className=\"flex-grow p-2 rounded-l-md bg-gray-700 border border-gray-600 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm\"\r\n                placeholder=\"개인 메시지를 입력하세요...\"\r\n                value={currentPrivateChatMessage}\r\n                onChange={(e) => setCurrentPrivateChatMessage(e.target.value)}\r\n                onKeyPress={(e) => {\r\n                  if (e.key === 'Enter') {\r\n                    sendPrivateChatMessage();\r\n                  }\r\n                }}\r\n                disabled={!isAuthReady || !userId || !selectedPlayerForChat}\r\n              />\r\n              <button\r\n                className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-r-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm\"\r\n                onClick={sendPrivateChatMessage}\r\n                disabled={!isAuthReady || !userId || !selectedPlayerForChat || !currentPrivateChatMessage.trim()}\r\n              >\r\n                보내기\r\n              </button>\r\n            </div>\r\n            {/* 대화 종료 및 시나리오 반영 버튼 영역 */}\r\n            <div className=\"flex justify-end gap-3 mt-4\">\r\n              <button\r\n                className=\"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                onClick={handleEndPrivateChatAndReflectScenario}\r\n                disabled={isTextLoading || privateChatMessages.length === 0}\r\n              >\r\n                대화 종료 및 시나리오 반영\r\n              </button>\r\n              <button\r\n                className=\"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-md transition duration-300\"\r\n                onClick={closePlayerChatModal}\r\n              >\r\n                닫기\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <style>\r\n        {`\r\n        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');\r\n        body {\r\n          font-family: 'Noto Sans KR', sans-serif;\r\n        }\r\n        .custom-scrollbar::-webkit-scrollbar {\r\n          width: 8px;\r\n        }\r\n        .custom-scrollbar::-webkit-scrollbar-track {\r\n          background: #4a5568; /* gray-600 */\r\n          border-radius: 10px;\r\n        }\r\n        .custom-scrollbar::-webkit-scrollbar-thumb {\r\n          background: #6b7280; /* gray-500 */\r\n          border-radius: 10px;\r\n        }\r\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\r\n          background: #9ca3af; /* gray-400 */\r\n        }\r\n        `}\r\n      </style>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,CAAEC,WAAW,CAAEC,OAAO,KAAQ,OAAO,CAChF,OAASC,aAAa,KAAQ,cAAc,CAC5C,OACEC,OAAO,CACPC,iBAAiB,CAAE;AACnBC,qBAAqB,CAAE;AACvBC,kBAAkB,KACb,eAAe,CACtB,OACEC,YAAY,CACZC,GAAG,CACHC,MAAM,CACNC,MAAM,CACNC,UAAU,CACVC,KAAK,CACLC,UAAU,CACVC,eAAe,CACfC,MAAM,CACNC,OAAO,CAAE;AACTC,SAAS,CAAE;AACXC,KAAM;AAAA,KACD,oBAAoB,CAE3B;AACA;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBACA,KAAM,CAAAC,qBAAqB,CAAG,CAC5BC,MAAM,CAAE,yCAAyC,CACjDC,UAAU,CAAE,2CAA2C,CACvDC,SAAS,CAAE,2BAA2B,CACtCC,aAAa,CAAE,4CAA4C,CAC3DC,iBAAiB,CAAE,eAAe,CAClCC,KAAK,CAAE,4CAA4C,CACnDC,aAAa,CAAE,cACjB,CAAC,CAED;AACA,KAAM,CAAAC,cAAc,CAAGR,qBAAqB,CAC5C,KAAM,CAAAM,KAAK,CAAGE,cAAc,CAACL,SAAS,CACtC,KAAM,CAAAM,gBAAgB,CAAG,IAAI,CAC7B;AAEA;AACA,KAAM,CAAAC,WAAW,CAAG,CAClB,GAAG,CAAE,CAAEC,IAAI,CAAE,WAAW,CAAEC,UAAU,CAAE,wCAAyC,CAAC,CAChF,GAAG,CAAE,CAAED,IAAI,CAAE,cAAc,CAAEC,UAAU,CAAE,kCAAmC,CAAC,CAC7E,GAAG,CAAE,CAAED,IAAI,CAAE,YAAY,CAAEC,UAAU,CAAE,0BAA2B,CAAC,CACnE,GAAG,CAAE,CAAED,IAAI,CAAE,QAAQ,CAAEC,UAAU,CAAE,oCAAqC,CAAC,CACzE,GAAG,CAAE,CAAED,IAAI,CAAE,QAAQ,CAAEC,UAAU,CAAE,kDAAmD,CAAC,CACvF,GAAG,CAAE,CAAED,IAAI,CAAE,UAAU,CAAEC,UAAU,CAAE,mCAAoC,CAC3E,CAAC,CAED;AAEA;AACA;AACA;AACA,GACA,QAAS,CAAAC,eAAeA,CAACC,UAAU,CAAE,CACnC,KAAM,CAACC,EAAE,CAAEC,KAAK,CAAC,CAAG1C,QAAQ,CAAC,IAAI,CAAC,CAClC,KAAM,CAAC2C,IAAI,CAAEC,OAAO,CAAC,CAAG5C,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAAC6C,MAAM,CAAEC,SAAS,CAAC,CAAG9C,QAAQ,CAAC,IAAI,CAAC,CAC1C,KAAM,CAAC+C,WAAW,CAAEC,cAAc,CAAC,CAAGhD,QAAQ,CAAC,KAAK,CAAC,CAErDC,SAAS,CAAC,IAAM,CACd,GAAI,CACF,GAAIiC,cAAc,CAACP,MAAM,GAAK,cAAc,EAAI,CAACO,cAAc,CAACP,MAAM,CAAE,CACtEsB,OAAO,CAACC,KAAK,CAAC,0GAA0G,CAAC,CACzHV,UAAU,CAACW,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAE,kDAAkD,CAAC,CAAC,CACjF,OACF,CACA,KAAM,CAAAC,GAAG,CAAG/C,aAAa,CAAC6B,cAAc,CAAC,CACzC,KAAM,CAAAmB,WAAW,CAAG3C,YAAY,CAAC0C,GAAG,CAAC,CACrC,KAAM,CAAAE,YAAY,CAAGhD,OAAO,CAAC8C,GAAG,CAAC,CACjCV,KAAK,CAACW,WAAW,CAAC,CAClBT,OAAO,CAACU,YAAY,CAAC,CACrB,KAAM,CAAAC,eAAe,CAAG9C,kBAAkB,CAAC6C,YAAY,CAAE,KAAO,CAAAE,IAAI,EAAK,CACvE,GAAIA,IAAI,CAAE,CACRV,SAAS,CAACU,IAAI,CAACC,GAAG,CAAC,CACnBT,cAAc,CAAC,IAAI,CAAC,CACtB,CAAC,IAAM,CACL,GAAI,CACF,GAAIb,gBAAgB,CAAE,CACpB,KAAM,CAAA3B,qBAAqB,CAAC8C,YAAY,CAAEnB,gBAAgB,CAAC,CAC7D,CAAC,IAAM,CACL,KAAM,CAAA5B,iBAAiB,CAAC+C,YAAY,CAAC,CACvC,CACF,CAAE,MAAOJ,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,iCAAiC,CAAEA,KAAK,CAAC,CACvDV,UAAU,CAACW,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAE,0BAA0B,CAAC,CAAC,CAC3D,CACF,CACF,CAAC,CAAC,CACF,MAAO,IAAMI,eAAe,CAAC,CAAC,CAChC,CAAE,MAAOL,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,gCAAgC,CAAEA,KAAK,CAAC,CACtDV,UAAU,CAACW,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAE,sBAAsB,CAAC,CAAC,CACvD,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,MAAO,CAAEV,EAAE,CAAEE,IAAI,CAAEE,MAAM,CAAEE,WAAY,CAAC,CAC1C,CAEA;AACA;AACA;AACA,GACA,QAAS,CAAAW,qBAAqBA,CAAAC,IAAA,CAA0J,IAAzJ,CAAElB,EAAE,CAAET,KAAK,CAAEa,MAAM,CAAEE,WAAW,CAAEa,eAAe,CAAEC,gBAAgB,CAAEC,cAAc,CAAEC,eAAe,CAAEC,8BAA8B,CAAEC,eAAgB,CAAC,CAAAN,IAAA,CACpL1D,SAAS,CAAC,IAAM,CACd,GAAI,CAACwC,EAAE,EAAI,CAACM,WAAW,EAAI,CAACF,MAAM,CAAE,OACpC;AACA;AACA;AACF,CAAC,CAAE,CAACJ,EAAE,CAAEM,WAAW,CAAEF,MAAM,CAAEe,eAAe,CAACM,UAAU,CAAEN,eAAe,CAACO,UAAU,CAAC,CAAC,CACvF,CAEA;AAEA;AACA;AACA;AACA;AACA;AACA,GACA,cAAe,CAAAC,aAAaA,CAACC,UAAU,CAAEC,gBAAgB,CAAE,CACzDA,gBAAgB,CAAC,IAAI,CAAC,CACtB,KAAM,CAAA3C,MAAM,CAAG,yCAAyC,CACxD,KAAM,CAAA4C,MAAM,CAAG,gGAAgG5C,MAAM,EAAE,CAEvH;AACA,KAAM,CAAA6C,UAAU,CAAG,eAAeH,UAAU,CAACI,KAAK,cAAcJ,UAAU,CAACK,SAAS,CAACR,UAAU,iBAAiBG,UAAU,CAACK,SAAS,CAACC,iBAAiB,aAAaC,IAAI,CAACC,SAAS,CAACR,UAAU,CAACK,SAAS,CAACI,KAAK,CAAC,cAAcF,IAAI,CAACC,SAAS,CAACR,UAAU,CAACK,SAAS,CAACK,SAAS,CAAC,YAAYV,UAAU,CAACK,SAAS,CAACM,eAAe,YAAYJ,IAAI,CAACC,SAAS,CAACR,UAAU,CAACK,SAAS,CAACO,UAAU,CAAC,gBAAgBL,IAAI,CAACC,SAAS,CAACR,UAAU,CAACK,SAAS,CAACQ,YAAY,CAAC,YAAYN,IAAI,CAACC,SAAS,CAACR,UAAU,CAACK,SAAS,CAACP,UAAU,CAAC,2BAA2BS,IAAI,CAACC,SAAS,CAACR,UAAU,CAACc,OAAO,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,mBAAmBf,UAAU,CAACgB,YAAY,+BAA+BT,IAAI,CAACC,SAAS,CAACR,UAAU,CAACiB,WAAW,CAAC,yDAAyDjB,UAAU,CAACkB,kBAAkB,EAAIlB,UAAU,CAACkB,kBAAkB,CAACC,MAAM,CAAG,CAAC,CAAGZ,IAAI,CAACC,SAAS,CAACR,UAAU,CAACkB,kBAAkB,CAACH,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAG,IAAI,4EAA4E,CAEr7B,KAAM,CAAAK,WAAW,CAAG,CAClB,CAAEC,IAAI,CAAE,MAAM,CAAEC,KAAK,CAAE,CAAC,CAAEC,IAAI,CAAEC,aAAc,CAAC,CAAE,CAAC,CAClD,CAAEH,IAAI,CAAE,MAAM,CAAEC,KAAK,CAAE,CAAC,CAAEC,IAAI,CAAEpB,UAAW,CAAC,CAAE,CAAC,CAChD,CAED,KAAM,CAAAsB,OAAO,CAAG,CAAEC,QAAQ,CAAEN,WAAY,CAAC,CAEzC,GAAI,KAAAO,mBAAA,CAAAC,qBAAA,CAAAC,sBAAA,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC7B,MAAM,CAAE,CACnC8B,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAmB,CAAC,CAC/CC,IAAI,CAAE3B,IAAI,CAACC,SAAS,CAACiB,OAAO,CAC9B,CAAC,CAAC,CACF,GAAI,CAACK,QAAQ,CAACK,EAAE,CAAE,CAChB,KAAM,CAAAC,SAAS,CAAG,KAAM,CAAAN,QAAQ,CAACP,IAAI,CAAC,CAAC,CACvC,KAAM,IAAI,CAAAc,KAAK,CAAC,uBAAuBP,QAAQ,CAACQ,MAAM,WAAWF,SAAS,EAAE,CAAC,CAC/E,CACA,KAAM,CAAAG,MAAM,CAAG,KAAM,CAAAT,QAAQ,CAACU,IAAI,CAAC,CAAC,CACpC,GAAID,MAAM,CAACE,UAAU,EAAI,EAAAd,mBAAA,CAAAY,MAAM,CAACE,UAAU,CAAC,CAAC,CAAC,UAAAd,mBAAA,kBAAAC,qBAAA,CAApBD,mBAAA,CAAsBe,OAAO,UAAAd,qBAAA,kBAAAC,sBAAA,CAA7BD,qBAAA,CAA+BN,KAAK,UAAAO,sBAAA,iBAApCA,sBAAA,CAAsCV,MAAM,EAAG,CAAC,CAAE,CACzE,GAAI,CAAAwB,aAAa,CAAGJ,MAAM,CAACE,UAAU,CAAC,CAAC,CAAC,CAACC,OAAO,CAACpB,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAC9D;AACA,KAAM,CAAAqB,SAAS,CAAGD,aAAa,CAACE,KAAK,CAAC,aAAa,CAAC,CACpD,GAAID,SAAS,CAAE,CACbD,aAAa,CAAGC,SAAS,CAAC,CAAC,CAAC,CAC9B,CAAC,IAAM,CACL,KAAM,IAAI,CAAAP,KAAK,CAAC,8CAA8C,CAAC,CACjE,CACA;AACA,GAAI,CACF,KAAM,CAAAS,SAAS,CAAGvC,IAAI,CAACwC,KAAK,CAACJ,aAAa,CAAC,CAC3C,MAAO,CAAAG,SAAS,CAClB,CAAE,MAAOE,YAAY,CAAE,CACrB,KAAM,IAAI,CAAAX,KAAK,CAAC,6CAA6CW,YAAY,CAACC,OAAO,EAAE,CAAC,CACtF,CACF,CAAC,IAAM,CACL,KAAM,IAAI,CAAAZ,KAAK,CAAC,iCAAiC,CAAC,CACpD,CACF,CAAE,MAAOxD,KAAK,CAAE,CACd,MAAO,CACLqE,KAAK,CAAE,gCAAgCrE,KAAK,CAACoE,OAAO,4BAA4B,CAChFE,OAAO,CAAE,CAAC,OAAO,CAAC,CAClBC,gBAAgB,CAAEpD,UAAU,CAACK,SAAS,CAACK,SAAS,CAChD2C,WAAW,CAAErD,UAAU,CAACK,SAAS,CAACI,KAAK,CACvC6C,QAAQ,CAAEtD,UAAU,CAACK,SAAS,CAACM,eAAe,CAC9C4C,iBAAiB,CAAEvD,UAAU,CAACK,SAAS,CAACO,UAAU,CAClD4C,mBAAmB,CAAExD,UAAU,CAACK,SAAS,CAACQ,YAAY,CACtD4C,iBAAiB,CAAEzD,UAAU,CAACK,SAAS,CAACP,UAC1C,CAAC,CACH,CAAC,OAAS,CACRG,gBAAgB,CAAC,KAAK,CAAC,CACzB,CACF,CAEA;AAEA;AACA;AACA;AACA;AACA,GACA,QAAS,CAAAyD,aAAaA,CAACC,GAAG,CAAE,CAC1B,MAAO,CAAAC,MAAM,CAACC,IAAI,CAACF,GAAG,CAAC,CAACxC,MAAM,GAAK,CAAC,EAAIwC,GAAG,CAACG,WAAW,GAAKF,MAAM,CACpE,CAEA;AACA;AACA;AACA;AAEA,QAAS,CAAAG,GAAGA,CAAA,CAAG,CACb;AACF;AACA;AACA,KACE,KAAM,CAACC,OAAO,CAAE7F,UAAU,CAAC,CAAGxC,QAAQ,CAAC,EAAE,CAAC,CAC1C;AACF;AACA,KACE,KAAM,CAACsI,aAAa,CAAEhE,gBAAgB,CAAC,CAAGtE,QAAQ,CAAC,KAAK,CAAC,CACzD;AACF;AACA,KACE,KAAM,CAACuI,SAAS,CAAEC,YAAY,CAAC,CAAGxI,QAAQ,CAAC,oBAAoB,CAAC,CAChE;AACF;AACA,KACE,KAAM,CAAC4D,eAAe,CAAE6E,kBAAkB,CAAC,CAAGzI,QAAQ,CAAC,CACrDkE,UAAU,CAAE,EAAE,CACdY,KAAK,CAAE,CAAE4D,QAAQ,CAAE,EAAE,CAAEC,YAAY,CAAE,EAAE,CAAEC,OAAO,CAAE,EAAE,CAAEC,QAAQ,CAAE,EAAG,CAAC,CACpE9D,SAAS,CAAE,EAAE,CACbJ,iBAAiB,CAAE,EAAE,CACrBK,eAAe,CAAE,UAAU,CAC3BC,UAAU,CAAE,CAAC,CAAC,CACdC,YAAY,CAAE,EAAE,CAChBf,UAAU,CAAE,EACd,CAAC,CAAC,CACF;AACF;AACA,KACE,KAAM,CAAC2E,cAAc,CAAEC,iBAAiB,CAAC,CAAG/I,QAAQ,CAAC,EAAE,CAAC,CACxD;AACF;AACA,KACE,KAAM,CAACgJ,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGjJ,QAAQ,CAAC,KAAK,CAAC,CACjE;AACF;AACA,KACE,KAAM,CAACkJ,YAAY,CAAEC,eAAe,CAAC,CAAGnJ,QAAQ,CAAC,EAAE,CAAC,CACpD;AACF;AACA,KACE,KAAM,CAACoJ,aAAa,CAAEvF,gBAAgB,CAAC,CAAG7D,QAAQ,CAAC,EAAE,CAAC,CACtD;AACF;AACA,KACE,KAAM,CAACsF,WAAW,CAAExB,cAAc,CAAC,CAAG9D,QAAQ,CAAC,EAAE,CAAC,CAClD;AACF;AACA,KACE,KAAM,CAACqJ,YAAY,CAAEtF,eAAe,CAAC,CAAG/D,QAAQ,CAAC,EAAE,CAAC,CACpD;AACF;AACA,KACE,KAAM,CAACsJ,kBAAkB,CAAEC,qBAAqB,CAAC,CAAGvJ,QAAQ,CAAC,EAAE,CAAC,CAChE;AACF;AACA,KACE,KAAM,CAACwJ,mBAAmB,CAAEC,sBAAsB,CAAC,CAAGzJ,QAAQ,CAAC,KAAK,CAAC,CACrE;AACF;AACA,KACE,KAAM,CAAC0J,qBAAqB,CAAEC,wBAAwB,CAAC,CAAG3J,QAAQ,CAAC,IAAI,CAAC,CACxE;AACF;AACA,KACE,KAAM,CAAC4J,mBAAmB,CAAEC,sBAAsB,CAAC,CAAG7J,QAAQ,CAAC,EAAE,CAAC,CAClE;AACF;AACA,KACE,KAAM,CAAC8J,yBAAyB,CAAEC,4BAA4B,CAAC,CAAG/J,QAAQ,CAAC,EAAE,CAAC,CAC9E;AACF;AACA,KACE,KAAM,CAACgK,gCAAgC,CAAEC,mCAAmC,CAAC,CAAGjK,QAAQ,CAAC,KAAK,CAAC,CAC/F;AACF;AACA,KACE,KAAM,CAACkK,2BAA2B,CAAElG,8BAA8B,CAAC,CAAGhE,QAAQ,CAAC,KAAK,CAAC,CACrF;AACF;AACA,KACE,KAAM,CAACmK,YAAY,CAAElG,eAAe,CAAC,CAAGjE,QAAQ,CAAC,IAAI,CAAC,CAEtD;AACA,KAAM,CAAEyC,EAAE,CAAEE,IAAI,CAAEE,MAAM,CAAEE,WAAY,CAAC,CAAGR,eAAe,CAACC,UAAU,CAAC,CAErE;AACA,KAAM,CAAA4H,SAAS,CAAGlK,MAAM,CAAC,IAAI,CAAC,CAC9B,KAAM,CAAAmK,eAAe,CAAGnK,MAAM,CAAC,IAAI,CAAC,CACpC,KAAM,CAAAoK,UAAU,CAAGpK,MAAM,CAAC,IAAI,CAAC,CAC/B,KAAM,CAAAqK,iBAAiB,CAAGrK,MAAM,CAAC,IAAI,CAAC,CAEtC;AACAwD,qBAAqB,CAAC,CAAEjB,EAAE,CAAET,KAAK,CAAEa,MAAM,CAAEE,WAAW,CAAEa,eAAe,CAAEC,gBAAgB,CAAEC,cAAc,CAAEC,eAAe,CAAEC,8BAA8B,CAAEC,eAAgB,CAAC,CAAC,CAE9K;AACF;AACA,KACE,KAAM,CAAAuG,QAAQ,CAAG,CAACN,2BAA2B,EAAKC,YAAY,EAAIA,YAAY,CAACM,EAAE,GAAK5H,MAAO,CAC7F;AACF;AACA,KACE,KAAM,CAAA6H,uBAAuB,CAAG9G,eAAe,CAACO,UAAU,CAACqB,MAAM,CAAG,CAAC,CAErE;AACF;AACA,KACE,KAAM,CAAAmF,iBAAiB,CAAGvK,OAAO,CAAC,IAChC6H,MAAM,CAACC,IAAI,CAAC9F,WAAW,CAAC,CAACwI,GAAG,CAACC,GAAG,EAAI,GAAGA,GAAG,KAAKzI,WAAW,CAACyI,GAAG,CAAC,CAACxI,IAAI,EAAE,CAAC,CACvE,EACF,CAAC,CAED;AACF;AACA,KACE,KAAM,CAAAyI,eAAe,CAAG3K,WAAW,CAAC,SAAY,CAC9C,GAAI,CAACsC,EAAE,EAAI,CAACI,MAAM,EAAI,CAACE,WAAW,EAAI,CAACuG,kBAAkB,CAACyB,IAAI,CAAC,CAAC,CAAE,OAClE,GAAI,CACF,KAAM,CAAAC,iBAAiB,CAAGlK,UAAU,CAAC2B,EAAE,CAAE,WAAW,CAAET,KAAK,CAAE,QAAQ,CAAE,MAAM,CAAE,cAAc,CAAC,CAC9F,KAAM,CAAAd,MAAM,CAAC8J,iBAAiB,CAAE,CAC9BnI,MAAM,CAAEA,MAAM,CACdoI,WAAW,CAAE,QAAQpI,MAAM,CAACqI,SAAS,CAAC,CAAC,CAAE,CAAC,CAAC,EAAE,CAC7C5D,OAAO,CAAEgC,kBAAkB,CAC3B6B,SAAS,CAAElK,eAAe,CAAC,CAC7B,CAAC,CAAC,CACFsI,qBAAqB,CAAC,EAAE,CAAC,CAC3B,CAAE,MAAOrG,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,kBAAkB,CAAEA,KAAK,CAAC,CAC1C,CACF,CAAC,CAAE,CAACT,EAAE,CAAEI,MAAM,CAAEE,WAAW,CAAEuG,kBAAkB,CAAC,CAAC,CAEjD;AACF;AACA,KACE,KAAM,CAAA8B,aAAa,CAAGhL,OAAO,CAAC,IAC5B0I,cAAc,CAAC8B,GAAG,CAAC,CAACS,MAAM,CAAEC,KAAK,gBAC/B/J,IAAA,WAEEgK,SAAS,CAAC,oSAAoS,CAC9SC,OAAO,CAAEA,CAAA,GAAMC,iBAAiB,CAACJ,MAAM,CAAE,CACzCK,QAAQ,CAAEpD,aAAa,EAAKoC,uBAAuB,EAAI,CAACF,QAAU,CAAAmB,QAAA,CAEjEN,MAAM,EALFC,KAMC,CACT,CACF,CAAE,CAACxC,cAAc,CAAER,aAAa,CAAEoC,uBAAuB,CAAEF,QAAQ,CAAEiB,iBAAiB,CAAC,CAAC,CAEzF;AAEA,mBACEhK,KAAA,QAAK8J,SAAS,CAAC,gGAAgG,CAAAI,QAAA,eAC7GlK,KAAA,QAAK8J,SAAS,CAAC,4HAA4H,CAAAI,QAAA,eAEzIlK,KAAA,QAAK8J,SAAS,CAAC,yCAAyC,CAAAI,QAAA,EAErD5I,WAAW,EAAIF,MAAM,eACpBpB,KAAA,QAAK8J,SAAS,CAAC,wCAAwC,CAAAI,QAAA,EAAC,yBAC9C,CAAC9I,MAAM,EACZ,CACN,cAGDpB,KAAA,QAAK8J,SAAS,CAAC,iHAAiH,CAAAI,QAAA,EAC7HtD,OAAO,CAACuC,GAAG,CAAC,CAACgB,IAAI,CAAEN,KAAK,gBACvB/J,IAAA,MAAegK,SAAS,CAAC,0BAA0B,CAACM,uBAAuB,CAAE,CAAEC,MAAM,CAAEF,IAAI,CAACG,OAAO,CAAC,KAAK,CAAE,QAAQ,CAAE,CAAE,EAA/GT,KAAmH,CAC5H,CAAC,CACDhD,aAAa,eACZ7G,KAAA,QAAK8J,SAAS,CAAC,uCAAuC,CAAAI,QAAA,eACpDpK,IAAA,QAAKgK,SAAS,CAAC,8DAA8D,CAAM,CAAC,cACpFhK,IAAA,SAAMgK,SAAS,CAAC,oBAAoB,CAAAI,QAAA,CAAC,iDAErC,CAAM,CAAC,EACJ,CACN,CAEAjB,uBAAuB,EAAIR,2BAA2B,EAAI,CAACM,QAAQ,eAChEjJ,IAAA,QAAKgK,SAAS,CAAC,sFAAsF,CAAAI,QAAA,CAChGxB,YAAY,CAAG,GAAGA,YAAY,CAACc,WAAW,iBAAiB,CAAG,kBAAkB,CAChF,CACR,cACD1J,IAAA,QAAKyK,GAAG,CAAE5B,SAAU,CAAE,CAAC,IAAC,EACrB,CAAC,CAGL7B,SAAS,GAAK,SAAS,eACtB9G,KAAA,QAAK8J,SAAS,CAAC,uEAAuE,CAAAI,QAAA,eACpFlK,KAAA,MAAAkK,QAAA,eAAGpK,IAAA,SAAMgK,SAAS,CAAC,6BAA6B,CAAAI,QAAA,CAAC,eAAG,CAAM,CAAC,IAAC,CAAC/H,eAAe,CAACM,UAAU,EAAI,CAAC,cAC5FzC,KAAA,MAAAkK,QAAA,eAAGpK,IAAA,SAAMgK,SAAS,CAAC,6BAA6B,CAAAI,QAAA,CAAC,eAAG,CAAM,CAAC,IAAC,CAAC/H,eAAe,CAACoB,eAAe,EAAI,CAAC,cACjGvD,KAAA,MAAAkK,QAAA,eAAGpK,IAAA,SAAMgK,SAAS,CAAC,6BAA6B,CAAAI,QAAA,CAAC,qBAAI,CAAM,CAAC,WAAG,CAAC/H,eAAe,CAACkB,KAAK,CAAC4D,QAAQ,CAAC,iBAAK,CAAC9E,eAAe,CAACkB,KAAK,CAAC6D,YAAY,CAAC,iBAAK,CAAC/E,eAAe,CAACkB,KAAK,CAAC8D,OAAO,CAAC,6BAAO,CAAChF,eAAe,CAACkB,KAAK,CAAC+D,QAAQ,CAAC,GAAC,EAAG,CAAC,cACxNpH,KAAA,MAAAkK,QAAA,eAAGpK,IAAA,SAAMgK,SAAS,CAAC,6BAA6B,CAAAI,QAAA,CAAC,2BAAK,CAAM,CAAC,IAAC,CAAC/H,eAAe,CAACmB,SAAS,CAACS,MAAM,CAAG,CAAC,CAAG5B,eAAe,CAACmB,SAAS,CAACkH,IAAI,CAAC,IAAI,CAAC,CAAG,MAAM,EAAI,CAAC,cACxJxK,KAAA,MAAAkK,QAAA,eAAGpK,IAAA,SAAMgK,SAAS,CAAC,6BAA6B,CAAAI,QAAA,CAAC,eAAG,CAAM,CAAC,IAAC,CAAC1D,MAAM,CAACC,IAAI,CAACtE,eAAe,CAACqB,UAAU,CAAC,CAACO,MAAM,CAAG,CAAC,CAAGyC,MAAM,CAACiE,OAAO,CAACtI,eAAe,CAACqB,UAAU,CAAC,CAAC2F,GAAG,CAACuB,KAAA,MAAC,CAACtB,GAAG,CAAEuB,KAAK,CAAC,CAAAD,KAAA,OAAK,GAAGtB,GAAG,KAAKuB,KAAK,EAAE,GAAC,CAACH,IAAI,CAAC,IAAI,CAAC,CAAG,IAAI,EAAI,CAAC,cAC7NxK,KAAA,MAAAkK,QAAA,eAAGpK,IAAA,SAAMgK,SAAS,CAAC,6BAA6B,CAAAI,QAAA,CAAC,qBAAI,CAAM,CAAC,IAAC,CAAC/H,eAAe,CAACsB,YAAY,CAACM,MAAM,CAAG,CAAC,CAAG5B,eAAe,CAACsB,YAAY,CAAC+G,IAAI,CAAC,IAAI,CAAC,CAAG,IAAI,EAAI,CAAC,cAC3JxK,KAAA,MAAAkK,QAAA,eAAGpK,IAAA,SAAMgK,SAAS,CAAC,6BAA6B,CAAAI,QAAA,CAAC,eAAG,CAAM,CAAC,IAAC,CAAC/H,eAAe,CAACO,UAAU,CAACqB,MAAM,CAAG,CAAC,CAAG5B,eAAe,CAACO,UAAU,CAAC8H,IAAI,CAAC,IAAI,CAAC,CAAG,IAAI,EAAI,CAAC,EACnJ,CACN,cAGD1K,IAAA,QAAKgK,SAAS,CAAC,qBAAqB,CAAAI,QAAA,CACjCP,aAAa,CACX,CAAC,cAGN3J,KAAA,QAAK8J,SAAS,CAAC,sCAAsC,CAAAI,QAAA,eACnDpK,IAAA,WACEgK,SAAS,CAAC,8SAA8S,CACxTC,OAAO,CAAEa,QAAS,CAClBX,QAAQ,CAAEpD,aAAa,EAAI,CAACvF,WAAW,EAAI,CAACF,MAAM,EAAI0F,SAAS,GAAK,oBAAqB,CAAAoD,QAAA,CAC1F,2BAED,CAAQ,CAAC,cACTpK,IAAA,WACEgK,SAAS,CAAC,iTAAiT,CAC3TC,OAAO,CAAEc,QAAS,CAClBZ,QAAQ,CAAEpD,aAAa,EAAI,CAACvF,WAAW,EAAI,CAACF,MAAO,CAAA8I,QAAA,CACpD,uCAED,CAAQ,CAAC,cACTpK,IAAA,WACEgK,SAAS,CAAC,iTAAiT,CAC3TC,OAAO,CAAEA,CAAA,GAAMvC,oBAAoB,CAAC,IAAI,CAAE,CAC1CyC,QAAQ,CAAEpD,aAAa,EAAI,CAACvF,WAAW,EAAI,CAACF,MAAO,CAAA8I,QAAA,CACpD,uCAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,cAGNlK,KAAA,QAAK8J,SAAS,CAAC,iFAAiF,CAAAI,QAAA,eAC9FpK,IAAA,OAAIgK,SAAS,CAAC,kDAAkD,CAAAI,QAAA,CAAC,iCAAM,CAAI,CAAC,cAG5ElK,KAAA,QAAK8J,SAAS,CAAC,kEAAkE,CAAAI,QAAA,eAC/EpK,IAAA,OAAIgK,SAAS,CAAC,0CAA0C,CAAAI,QAAA,CAAC,8CAAS,CAAI,CAAC,CACtErG,WAAW,CAACE,MAAM,CAAG,CAAC,cACrBjE,IAAA,OAAIgK,SAAS,CAAC,iCAAiC,CAAAI,QAAA,CAC5CrG,WAAW,CAACsF,GAAG,CAACpH,IAAI,eACnB/B,KAAA,OAEE8J,SAAS,CAAC,4FAA4F,CACtGgB,aAAa,CAAEA,CAAA,GAAM/I,IAAI,CAACiH,EAAE,GAAK5H,MAAM,EAAI2J,mBAAmB,CAAChJ,IAAI,CAAE,CAAAmI,QAAA,eAErElK,KAAA,SAAAkK,QAAA,eACEpK,IAAA,SAAMgK,SAAS,CAAC,2BAA2B,CAAAI,QAAA,CAAEnI,IAAI,CAACyH,WAAW,CAAO,CAAC,CAEnEzH,IAAI,CAACiJ,WAAW,eAAIlL,IAAA,SAAMgK,SAAS,CAAC,qBAAqB,CAAAI,QAAA,CAAC,gBAAI,CAAM,CAAC,EACnE,CAAC,CACNnI,IAAI,CAACiH,EAAE,GAAK5H,MAAM,eACjBtB,IAAA,WACEgK,SAAS,CAAC,gFAAgF,CAC1FC,OAAO,CAAEA,CAAA,GAAMgB,mBAAmB,CAAChJ,IAAI,CAAE,CAAAmI,QAAA,CAC1C,0BAED,CAAQ,CACT,GAhBInI,IAAI,CAACiH,EAiBR,CACL,CAAC,CACA,CAAC,cAELlJ,IAAA,MAAGgK,SAAS,CAAC,uBAAuB,CAAAI,QAAA,CAAC,oFAAiB,CAAG,CAC1D,EACE,CAAC,cAGNlK,KAAA,QAAK8J,SAAS,CAAC,4EAA4E,CAAAI,QAAA,eACzFpK,IAAA,OAAIgK,SAAS,CAAC,0CAA0C,CAAAI,QAAA,CAAC,2DAAY,CAAI,CAAC,CACzEvC,aAAa,CAAC5D,MAAM,CAAG,CAAC,cACvB/D,KAAA,QAAK8J,SAAS,CAAC,iCAAiC,CAAAI,QAAA,EAC7CvC,aAAa,CAACwB,GAAG,CAAE8B,QAAQ,eAC1BjL,KAAA,QAAuB8J,SAAS,CAAC,+CAA+C,CAAAI,QAAA,eAC9ElK,KAAA,MAAG8J,SAAS,CAAC,4BAA4B,CAAAI,QAAA,eACvCpK,IAAA,SAAMgK,SAAS,CAAC,6BAA6B,CAAAI,QAAA,CAAEe,QAAQ,CAACzB,WAAW,CAAO,CAAC,KAC3E,CAACyB,QAAQ,CAACvB,SAAS,CAAG,GAAI,CAAAwB,IAAI,CAACD,QAAQ,CAACvB,SAAS,CAACyB,QAAQ,CAAC,CAAC,CAAC,CAACC,kBAAkB,CAAC,CAAC,CAAG,OAAO,CAAC,GAC/F,EAAG,CAAC,cACJtL,IAAA,MAAGgK,SAAS,CAAC,qBAAqB,CAACM,uBAAuB,CAAE,CAAEC,MAAM,CAAEY,QAAQ,CAAC3F,OAAO,CAACgF,OAAO,CAAC,KAAK,CAAE,QAAQ,CAAE,CAAE,CAAI,CAAC,GAL/GW,QAAQ,CAACjC,EAMd,CACN,CAAC,cACFlJ,IAAA,QAAKyK,GAAG,CAAE3B,eAAgB,CAAE,CAAC,EAC1B,CAAC,cAEN9I,IAAA,MAAGgK,SAAS,CAAC,uBAAuB,CAAAI,QAAA,CAAC,8EAAgB,CAAG,CACzD,EACE,CAAC,cAGNlK,KAAA,QAAK8J,SAAS,CAAC,+CAA+C,CAAAI,QAAA,eAC5DpK,IAAA,OAAIgK,SAAS,CAAC,0CAA0C,CAAAI,QAAA,CAAC,4BAAM,CAAI,CAAC,cACpElK,KAAA,QAAK8J,SAAS,CAAC,iFAAiF,CAAAI,QAAA,EAC7FtC,YAAY,CAAC7D,MAAM,CAAG,CAAC,CACtB6D,YAAY,CAACuB,GAAG,CAAEkC,GAAG,eACnBrL,KAAA,QAAkB8J,SAAS,CAAC,+CAA+C,CAAAI,QAAA,eACzElK,KAAA,MAAG8J,SAAS,CAAC,uBAAuB,CAAAI,QAAA,eAClCpK,IAAA,SAAMgK,SAAS,CAAC,4BAA4B,CAAAI,QAAA,CAAEmB,GAAG,CAAC7B,WAAW,CAAO,CAAC,KACrE,CAAC6B,GAAG,CAAC3B,SAAS,CAAG,GAAI,CAAAwB,IAAI,CAACG,GAAG,CAAC3B,SAAS,CAACyB,QAAQ,CAAC,CAAC,CAAC,CAACC,kBAAkB,CAAC,CAAC,CAAG,OAAO,CAAC,IACrF,EAAG,CAAC,cACJtL,IAAA,MAAAoK,QAAA,CAAImB,GAAG,CAACxF,OAAO,CAAI,CAAC,GALZwF,GAAG,CAACrC,EAMT,CACN,CAAC,cAEFlJ,IAAA,MAAGgK,SAAS,CAAC,uBAAuB,CAAAI,QAAA,CAAC,8EAAgB,CAAG,CACzD,cACDpK,IAAA,QAAKyK,GAAG,CAAE1B,UAAW,CAAE,CAAC,IAAC,EACtB,CAAC,cACN7I,KAAA,QAAK8J,SAAS,CAAC,MAAM,CAAAI,QAAA,eACnBpK,IAAA,UACEwL,IAAI,CAAC,MAAM,CACXxB,SAAS,CAAC,8JAA8J,CACxKyB,WAAW,CAAC,4DAAe,CAC3BZ,KAAK,CAAE9C,kBAAmB,CAC1B2D,QAAQ,CAAGC,CAAC,EAAK3D,qBAAqB,CAAC2D,CAAC,CAACC,MAAM,CAACf,KAAK,CAAE,CACvDgB,UAAU,CAAGF,CAAC,EAAK,CACjB,GAAIA,CAAC,CAACrC,GAAG,GAAK,OAAO,CAAE,CACrBC,eAAe,CAAC,CAAC,CACnB,CACF,CAAE,CACFY,QAAQ,CAAE,CAAC3I,WAAW,EAAI,CAACF,MAAO,CACnC,CAAC,cACFtB,IAAA,WACEgK,SAAS,CAAC,2JAA2J,CACrKC,OAAO,CAAEV,eAAgB,CACzBY,QAAQ,CAAE,CAAC3I,WAAW,EAAI,CAACF,MAAM,EAAI,CAACyG,kBAAkB,CAACyB,IAAI,CAAC,CAAE,CAAAY,QAAA,CACjE,oBAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,EACH,CAAC,EACH,CAAC,CAGL3C,iBAAiB,eAChBzH,IAAA,QAAKgK,SAAS,CAAC,gFAAgF,CAAAI,QAAA,cAC7FlK,KAAA,QAAK8J,SAAS,CAAC,gEAAgE,CAAAI,QAAA,eAC7EpK,IAAA,OAAIgK,SAAS,CAAC,iCAAiC,CAAAI,QAAA,CAAC,uCAAO,CAAI,CAAC,cAC5DpK,IAAA,aACEgK,SAAS,CAAC,kKAAkK,CAC5KyB,WAAW,CAAC,qHAA2B,CACvCZ,KAAK,CAAElD,YAAa,CACpB+D,QAAQ,CAAGC,CAAC,EAAK/D,eAAe,CAAC+D,CAAC,CAACC,MAAM,CAACf,KAAK,CAAE,CACjDV,QAAQ,CAAEpD,aAAc,CACf,CAAC,cACZ7G,KAAA,QAAK8J,SAAS,CAAC,wBAAwB,CAAAI,QAAA,eACrCpK,IAAA,WACEgK,SAAS,CAAC,iJAAiJ,CAC3JC,OAAO,CAAEA,CAAA,GAAMvC,oBAAoB,CAAC,KAAK,CAAE,CAC3CyC,QAAQ,CAAEpD,aAAc,CAAAqD,QAAA,CACzB,cAED,CAAQ,CAAC,cACTpK,IAAA,WACEgK,SAAS,CAAC,iJAAiJ,CAC3JC,OAAO,CAAE6B,YAAa,CACtB3B,QAAQ,CAAEpD,aAAa,EAAI,CAACY,YAAY,CAAC6B,IAAI,CAAC,CAAE,CAAAY,QAAA,CACjD,oBAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,CAGAnC,mBAAmB,EAAIE,qBAAqB,eAC3CnI,IAAA,QAAKgK,SAAS,CAAC,gFAAgF,CAAAI,QAAA,cAC7FlK,KAAA,QAAK8J,SAAS,CAAC,iGAAiG,CAAAI,QAAA,eAC9GlK,KAAA,OAAI8J,SAAS,CAAC,iCAAiC,CAAAI,QAAA,EAC5CjC,qBAAqB,CAACuB,WAAW,CAAC,IAAE,CAACvB,qBAAqB,CAACxF,UAAU,CAAC,6BACzE,EAAI,CAAC,cACLzC,KAAA,QAAK8J,SAAS,CAAC,uGAAuG,CAAAI,QAAA,EACnH/B,mBAAmB,CAACpE,MAAM,CAAG,CAAC,CAC7BoE,mBAAmB,CAACgB,GAAG,CAAEkC,GAAG,eAC1BvL,IAAA,QAAkBgK,SAAS,CAAE,QAAQuB,GAAG,CAACQ,QAAQ,GAAKzK,MAAM,CAAG,aAAa,CAAG,eAAe,EAAG,CAAA8I,QAAA,cAC/FlK,KAAA,QAAK8J,SAAS,CAAE,8BAA8BuB,GAAG,CAACQ,QAAQ,GAAKzK,MAAM,CAAG,wBAAwB,CAAG,2BAA2B,EAAG,CAAA8I,QAAA,eAC/HlK,KAAA,MAAG8J,SAAS,CAAC,4BAA4B,CAAAI,QAAA,eACvCpK,IAAA,SAAMgK,SAAS,CAAC,aAAa,CAAAI,QAAA,CAAEmB,GAAG,CAAC7B,WAAW,CAAO,CAAC,KACtD,CAAC6B,GAAG,CAAC3B,SAAS,CAAG,GAAI,CAAAwB,IAAI,CAACG,GAAG,CAAC3B,SAAS,CAACyB,QAAQ,CAAC,CAAC,CAAC,CAACC,kBAAkB,CAAC,CAAC,CAAG,OAAO,CAAC,GACrF,EAAG,CAAC,cACJtL,IAAA,MAAAoK,QAAA,CAAImB,GAAG,CAACxF,OAAO,CAAI,CAAC,EACjB,CAAC,EAPEwF,GAAG,CAACrC,EAQT,CACN,CAAC,cAEFlJ,IAAA,MAAGgK,SAAS,CAAC,mCAAmC,CAAAI,QAAA,CAAC,2HAA0B,CAAG,CAC/E,cACDpK,IAAA,QAAKyK,GAAG,CAAEzB,iBAAkB,CAAE,CAAC,EAC5B,CAAC,cACN9I,KAAA,QAAK8J,SAAS,CAAC,MAAM,CAAAI,QAAA,eACnBpK,IAAA,UACEwL,IAAI,CAAC,MAAM,CACXxB,SAAS,CAAC,8JAA8J,CACxKyB,WAAW,CAAC,yEAAkB,CAC9BZ,KAAK,CAAEtC,yBAA0B,CACjCmD,QAAQ,CAAGC,CAAC,EAAKnD,4BAA4B,CAACmD,CAAC,CAACC,MAAM,CAACf,KAAK,CAAE,CAC9DgB,UAAU,CAAGF,CAAC,EAAK,CACjB,GAAIA,CAAC,CAACrC,GAAG,GAAK,OAAO,CAAE,CACrB0C,sBAAsB,CAAC,CAAC,CAC1B,CACF,CAAE,CACF7B,QAAQ,CAAE,CAAC3I,WAAW,EAAI,CAACF,MAAM,EAAI,CAAC6G,qBAAsB,CAC7D,CAAC,cACFnI,IAAA,WACEgK,SAAS,CAAC,2JAA2J,CACrKC,OAAO,CAAE+B,sBAAuB,CAChC7B,QAAQ,CAAE,CAAC3I,WAAW,EAAI,CAACF,MAAM,EAAI,CAAC6G,qBAAqB,EAAI,CAACI,yBAAyB,CAACiB,IAAI,CAAC,CAAE,CAAAY,QAAA,CAClG,oBAED,CAAQ,CAAC,EACN,CAAC,cAENlK,KAAA,QAAK8J,SAAS,CAAC,6BAA6B,CAAAI,QAAA,eAC1CpK,IAAA,WACEgK,SAAS,CAAC,mJAAmJ,CAC7JC,OAAO,CAAEgC,sCAAuC,CAChD9B,QAAQ,CAAEpD,aAAa,EAAIsB,mBAAmB,CAACpE,MAAM,GAAK,CAAE,CAAAmG,QAAA,CAC7D,wEAED,CAAQ,CAAC,cACTpK,IAAA,WACEgK,SAAS,CAAC,iGAAiG,CAC3GC,OAAO,CAAEiC,oBAAqB,CAAA9B,QAAA,CAC/B,cAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,cAEDpK,IAAA,UAAAoK,QAAA,CACG;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,CACI,CAAC,EACL,CAAC,CAEV,CAEA,cAAe,CAAAvD,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}