/*! For license information please see main.908fe052.js.LICENSE.txt */
(()=>{var e={43:(e,t,n)=>{"use strict";e.exports=n(202)},153:(e,t,n)=>{"use strict";var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:a.current}}t.jsx=c,t.jsxs=c},173:(e,t,n)=>{e.exports=n(497)()},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var w=b.prototype=new v;w.constructor=b,m(w,y.prototype),w.isPureReactComponent=!0;var x=Array.isArray,_=Object.prototype.hasOwnProperty,I={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)_.call(t,i)&&!E.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:I.current}}function k(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function C(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+N(l,0):s,x(o)?(i="",null!=e&&(i=e.replace(T,"$&/")+"/"),C(o,t,i,"",function(e){return e})):null!=o&&(k(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(T,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",x(e))for(var c=0;c<e.length;c++){var u=s+N(a=e[c],c);l+=C(a,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=C(a=a.value,t,i,u=s+N(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],i=0;return C(e,r,"","",function(e){return t.call(n,e,i++)}),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},R={transition:null},O={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:R,ReactCurrentOwner:I};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!k(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=I.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function x(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,R(_);else{var t=r(u);null!==t&&O(x,t.startTime-e)}}function _(e,n){m=!1,g&&(g=!1,v(k),k=-1),p=!0;var s=f;try{for(w(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!C());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(c)&&i(c),w(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&O(x,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var I,E=!1,S=null,k=-1,T=5,N=-1;function C(){return!(t.unstable_now()-N<T)}function A(){if(null!==S){var e=t.unstable_now();N=e;var n=!0;try{n=S(!0,e)}finally{n?I():(E=!1,S=null)}}else E=!1}if("function"===typeof b)I=function(){b(A)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,P=D.port2;D.port1.onmessage=A,I=function(){P.postMessage(null)}}else I=function(){y(A,0)};function R(e){S=e,E||(E=!0,I())}function O(e,n){k=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,R(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(v(k),k=-1):g=!0,O(x,s-o))):(e.sortIndex=a,n(c,e),m||p||(m=!0,R(_))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},238:(e,t)=>{"use strict";t.Y=function(e,t){return a(e).some(function(e){var n=e.inverse,r="all"===e.type||t.type===e.type;if(r&&n||!r&&!n)return!1;var i=e.expressions.every(function(e){var n=e.feature,r=e.modifier,i=e.value,s=t[n];if(!s)return!1;switch(n){case"orientation":case"scan":return s.toLowerCase()===i.toLowerCase();case"width":case"height":case"device-width":case"device-height":i=u(i),s=u(s);break;case"resolution":i=c(i),s=c(s);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":i=l(i),s=l(s);break;case"grid":case"color":case"color-index":case"monochrome":i=parseInt(i,10)||1,s=parseInt(s,10)||0}switch(r){case"min":return s>=i;case"max":return s<=i;default:return s===i}});return i&&!n||!i&&n})};var n=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,r=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,i=/^(?:(min|max)-)?(.+)/,s=/(em|rem|px|cm|mm|in|pt|pc)?$/,o=/(dpi|dpcm|dppx)?$/;function a(e){return e.split(",").map(function(e){var t=(e=e.trim()).match(n),s=t[1],o=t[2],a=t[3]||"",l={};return l.inverse=!!s&&"not"===s.toLowerCase(),l.type=o?o.toLowerCase():"all",a=a.match(/\([^\)]+\)/g)||[],l.expressions=a.map(function(e){var t=e.match(r),n=t[1].toLowerCase().match(i);return{modifier:n[1],feature:n[2],value:t[2]}}),l})}function l(e){var t,n=Number(e);return n||(n=(t=e.match(/^(\d+)\s*\/\s*(\d+)$/))[1]/t[2]),n}function c(e){var t=parseFloat(e);switch(String(e).match(o)[1]){case"dpcm":return t/2.54;case"dppx":return 96*t;default:return t}}function u(e){var t=parseFloat(e);switch(String(e).match(s)[1]){case"em":case"rem":return 16*t;case"cm":return 96*t/2.54;case"mm":return 96*t/2.54/10;case"in":return 96*t;case"pt":return 72*t;case"pc":return 72*t/12;default:return t}}},391:(e,t,n)=>{"use strict";var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},497:(e,t,n)=>{"use strict";var r=n(218);function i(){}function s(){}s.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,s,o){if(o!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:i};return n.PropTypes=n,n}},579:(e,t,n)=>{"use strict";e.exports=n(153)},725:(e,t,n)=>{"use strict";var r=n(238).Y,i="undefined"!==typeof window?window.matchMedia:null;function s(e,t,n){var s,o=this;function a(e){o.matches=e.matches,o.media=e.media}i&&!n&&(s=i.call(window,e)),s?(this.matches=s.matches,this.media=s.media,s.addListener(a)):(this.matches=r(e,t),this.media=e),this.addListener=function(e){s&&s.addListener(e)},this.removeListener=function(e){s&&s.removeListener(e)},this.dispose=function(){s&&s.removeListener(a)}}e.exports=function(e,t,n){return new s(e,t,n)}},730:(e,t,n)=>{"use strict";var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),_=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),T=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var j,M=Object.assign;function F(e){if(void 0===j)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var V=!1;function U(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function z(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function $(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case I:return"Fragment";case _:return"Portal";case S:return"Profiler";case E:return"StrictMode";case C:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case k:return(e._context.displayName||"Context")+".Provider";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:$(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return $(e(t))}catch(n){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Y(e,t){J(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function se(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ye=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Ie=null,Ee=null;function Se(e){if(e=bi(e)){if("function"!==typeof _e)throw Error(s(280));var t=e.stateNode;t&&(t=xi(t),_e(e.stateNode,e.type,t))}}function ke(e){Ie?Ee?Ee.push(e):Ee=[e]:Ie=e}function Te(){if(Ie){var e=Ie,t=Ee;if(Ee=Ie=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ne(e,t){return e(t)}function Ce(){}var Ae=!1;function De(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ne(e,t,n)}finally{Ae=!1,(null!==Ie||null!==Ee)&&(Ce(),Te())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=xi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Re=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){Re=!1}function Le(e,t,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var je=!1,Me=null,Fe=!1,Ve=null,Ue={onError:function(e){je=!0,Me=e}};function ze(e,t,n,r,i,s,o,a,l){je=!1,Me=null,Le.apply(Ue,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if($e(e)!==e)throw Error(s(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return qe(i),e;if(o===r)return qe(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Xe=i.unstable_requestPaint,Je=i.unstable_now,Ye=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=ht(a):0!==(s&=o)&&(r=ht(s))}else 0!==(o=n&~i)?r=ht(o):0!==s&&(r=ht(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,_t,It,Et,St,kt=!1,Tt=[],Nt=null,Ct=null,At=null,Dt=new Map,Pt=new Map,Rt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function jt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&_t(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Mt(e){var t=vi(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Be(n)))return e.blockedOn=t,void St(e.priority,function(){It(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&_t(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Vt(e,t,n){Ft(e)&&n.delete(t)}function Ut(){kt=!1,null!==Nt&&Ft(Nt)&&(Nt=null),null!==Ct&&Ft(Ct)&&(Ct=null),null!==At&&Ft(At)&&(At=null),Dt.forEach(Vt),Pt.forEach(Vt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,kt||(kt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function $t(e){function t(t){return zt(t,e)}if(0<Tt.length){zt(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Nt&&zt(Nt,e),null!==Ct&&zt(Ct,e),null!==At&&zt(At,e),Dt.forEach(t),Pt.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Mt(n),null===n.blockedOn&&Rt.shift()}var Bt=w.ReactCurrentBatchConfig,qt=!0;function Ht(e,t,n,r){var i=bt,s=Bt.transition;Bt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=i,Bt.transition=s}}function Wt(e,t,n,r){var i=bt,s=Bt.transition;Bt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=i,Bt.transition=s}}function Kt(e,t,n,r){if(qt){var i=Qt(e,t,n,r);if(null===i)qr(e,t,r,Gt,n),Lt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Nt=jt(Nt,e,t,n,r,i),!0;case"dragenter":return Ct=jt(Ct,e,t,n,r,i),!0;case"mouseover":return At=jt(At,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Dt.set(s,jt(Dt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Pt.set(s,jt(Pt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var s=bi(i);if(null!==s&&xt(s),null===(s=Qt(e,t,n,r))&&qr(e,t,r,Gt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Gt=null;function Qt(e,t,n,r){if(Gt=null,null!==(e=vi(e=xe(r))))if(null===(t=$e(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ye()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Yt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Yt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=M({},cn,{view:0,detail:0}),dn=sn(hn),fn=M({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=sn(fn),mn=sn(M({},fn,{dataTransfer:0})),gn=sn(M({},hn,{relatedTarget:0})),yn=sn(M({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=M({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(vn),wn=sn(M({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},In={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=In[e])&&!!t[e]}function Sn(){return En}var kn=M({},hn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=sn(kn),Nn=sn(M({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=sn(M({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),An=sn(M({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=M({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=sn(Dn),Rn=[9,13,27,32],On=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var jn=u&&"TextEvent"in window&&!Ln,Mn=u&&(!On||Ln&&8<Ln&&11>=Ln),Fn=String.fromCharCode(32),Vn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var $n=!1;var Bn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Bn[e.type]:"textarea"===t}function Hn(e,t,n,r){ke(r),0<(t=Wr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Kn=null;function Gn(e){Fr(e,0)}function Qn(e){if(K(wi(e)))return e}function Xn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Yn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Yn=Zn}else Yn=!1;Jn=Yn&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Kn=Wn=null)}function nr(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];Hn(t,Kn,e,xe(e)),De(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function sr(e,t){if("click"===e)return Qn(t)}function or(e,t){if("input"===e||"change"===e)return Qn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var o=ur(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==G(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Wr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _r={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},Ir={},Er={};function Sr(e){if(Ir[e])return Ir[e];if(!_r[e])return e;var t,n=_r[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Ir[e]=n[t];return e}u&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete _r.animationend.animation,delete _r.animationiteration.animation,delete _r.animationstart.animation),"TransitionEvent"in window||delete _r.transitionend.transition);var kr=Sr("animationend"),Tr=Sr("animationiteration"),Nr=Sr("animationstart"),Cr=Sr("transitionend"),Ar=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Ar.set(e,t),l(t,[e])}for(var Rr=0;Rr<Dr.length;Rr++){var Or=Dr[Rr];Pr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Pr(kr,"onAnimationEnd"),Pr(Tr,"onAnimationIteration"),Pr(Nr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Cr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,c){if(ze.apply(this,arguments),je){if(!je)throw Error(s(198));var u=Me;je=!1,Me=null,Fe||(Fe=!0,Ve=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Mr(i,a,c),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Mr(i,a,c),s=l}}}if(Fe)throw e=Ve,Fe=!1,Ve=null,e}function Vr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Br(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Br(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function $r(e){if(!e[zr]){e[zr]=!0,o.forEach(function(t){"selectionchange"!==t&&(jr.has(t)||Ur(t,!1,e),Ur(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Ur("selectionchange",!1,t))}}function Br(e,t,n,r){switch(Xt(t)){case 1:var i=Ht;break;case 4:i=Wt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=vi(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}De(function(){var r=s,i=xe(n),o=[];e:{var a=Ar.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Tn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case kr:case Tr:case Nr:l=yn;break;case Cr:l=An;break;case"scroll":l=dn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Nn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Pe(p,d))&&u.push(Hr(p,m,f)))),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!vi(c)&&!c[pi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vi(c):null)&&(c!==(h=$e(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Nn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:wi(l),f=null==c?a:wi(c),(a=new u(m,p+"leave",l,n,i)).target=h,a.relatedTarget=f,m=null,vi(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Kr(f))p++;for(f=0,m=d;m;m=Kr(m))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)d=Kr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Kr(u),d=Kr(d)}u=null}else u=null;null!==l&&Gr(o,a,l,u,!1),null!==c&&null!==h&&Gr(o,h,c,u,!0)}if("select"===(l=(a=r?wi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Xn;else if(qn(a))if(Jn)g=or;else{g=ir;var y=rr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=sr);switch(g&&(g=g(e,r))?Hn(o,g,n,i):(y&&y(e,a,r),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&ee(a,"number",a.value)),y=r?wi(r):window,e){case"focusin":(qn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(o,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(o,n,i)}var v;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else $n?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Mn&&"ko"!==n.locale&&($n||"onCompositionStart"!==b?"onCompositionEnd"===b&&$n&&(v=en()):(Yt="value"in(Jt=i)?Jt.value:Jt.textContent,$n=!0)),0<(y=Wr(r,b)).length&&(b=new wn(b,e,null,n,i),o.push({event:b,listeners:y}),v?b.data=v:null!==(v=zn(n))&&(b.data=v))),(v=jn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Vn=!0,Fn);case"textInput":return(e=t.data)===Fn&&Vn?null:e;default:return null}}(e,n):function(e,t){if($n)return"compositionend"===e||!On&&Un(e,t)?(e=en(),Zt=Yt=Jt=null,$n=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=v))}Fr(o,t)})}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Pe(e,n))&&r.unshift(Hr(e,s,i)),null!=(s=Pe(e,t))&&r.push(Hr(e,s,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Pe(n,s))&&o.unshift(Hr(n,l,a)):i||null!=(l=Pe(n,s))&&o.push(Hr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Xr,"")}function Yr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout(function(){throw e})}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void $t(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);$t(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,yi="__reactHandles$"+hi;function vi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function xi(e){return e[fi]||null}var _i=[],Ii=-1;function Ei(e){return{current:e}}function Si(e){0>Ii||(e.current=_i[Ii],_i[Ii]=null,Ii--)}function ki(e,t){Ii++,_i[Ii]=e.current,e.current=t}var Ti={},Ni=Ei(Ti),Ci=Ei(!1),Ai=Ti;function Di(e,t){var n=e.type.contextTypes;if(!n)return Ti;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ri(){Si(Ci),Si(Ni)}function Oi(e,t,n){if(Ni.current!==Ti)throw Error(s(168));ki(Ni,t),ki(Ci,n)}function Li(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,B(e)||"Unknown",i));return M({},n,r)}function ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ti,Ai=Ni.current,ki(Ni,e),ki(Ci,Ci.current),!0}function Mi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Li(e,t,Ai),r.__reactInternalMemoizedMergedChildContext=e,Si(Ci),Si(Ni),ki(Ni,e)):Si(Ci),ki(Ci,n)}var Fi=null,Vi=!1,Ui=!1;function zi(e){null===Fi?Fi=[e]:Fi.push(e)}function $i(){if(!Ui&&null!==Fi){Ui=!0;var e=0,t=bt;try{var n=Fi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fi=null,Vi=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),Ke(Ze,$i),i}finally{bt=t,Ui=!1}}return null}var Bi=[],qi=0,Hi=null,Wi=0,Ki=[],Gi=0,Qi=null,Xi=1,Ji="";function Yi(e,t){Bi[qi++]=Wi,Bi[qi++]=Hi,Hi=e,Wi=t}function Zi(e,t,n){Ki[Gi++]=Xi,Ki[Gi++]=Ji,Ki[Gi++]=Qi,Qi=e;var r=Xi;e=Ji;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Xi=1<<32-ot(t)+i|n<<i|r,Ji=s+e}else Xi=1<<s|n<<i|r,Ji=e}function es(e){null!==e.return&&(Yi(e,1),Zi(e,1,0))}function ts(e){for(;e===Hi;)Hi=Bi[--qi],Bi[qi]=null,Wi=Bi[--qi],Bi[qi]=null;for(;e===Qi;)Qi=Ki[--Gi],Ki[Gi]=null,Ji=Ki[--Gi],Ki[Gi]=null,Xi=Ki[--Gi],Ki[Gi]=null}var ns=null,rs=null,is=!1,ss=null;function os(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Xi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(is){var t=rs;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=ci(n.nextSibling);var r=ns;t&&as(e,t)?os(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!is)return us(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=ci(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ci(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=rs;e;)e=ci(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function ys(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Mc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===I?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===P&&vs(s)===t.type)?((r=i(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=Lc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case _:return(t=Fc(t,e.mode,n)).return=e,t;case P:return d(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Lc(t,e.mode,n,null)).return=e,t;ys(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===i?c(e,t,n,r):null;case _:return n.key===i?u(e,t,n,r):null;case P:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:h(e,t,n,r,null);ys(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case _:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return h(t,e=e.get(n)||null,r,i,null);ys(t,r)}return null}function m(i,s,a,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=f(i,h,a[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(i,h),s=o(y,s,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===a.length)return n(i,h),is&&Yi(i,m),c;if(null===h){for(;m<a.length;m++)null!==(h=d(i,a[m],l))&&(s=o(h,s,m),null===u?c=h:u.sibling=h,u=h);return is&&Yi(i,m),c}for(h=r(i,h);m<a.length;m++)null!==(g=p(h,i,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(i,e)}),is&&Yi(i,m),c}function g(i,a,l,c){var u=L(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,m=a,g=a=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=f(i,m,v.value,c);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(i,m),a=o(b,a,g),null===h?u=b:h.sibling=b,h=b,m=y}if(v.done)return n(i,m),is&&Yi(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,c))&&(a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return is&&Yi(i,g),u}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return e&&m.forEach(function(e){return t(i,e)}),is&&Yi(i,g),u}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===I&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===I){if(7===u.tag){n(r,u.sibling),(s=i(u,o.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&vs(c)===u.type){n(r,u.sibling),(s=i(u,o.props)).ref=gs(r,u,o),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===I?((s=Lc(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Oc(o.type,o.key,o.props,null,r.mode,l)).ref=gs(r,s,o),l.return=r,r=l)}return a(r);case _:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Fc(o,r.mode,l)).return=r,r=s}return a(r);case P:return e(r,s,(u=o._init)(o._payload),l)}if(te(o))return m(r,s,o,l);if(L(o))return g(r,s,o,l);ys(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Mc(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var ws=bs(!0),xs=bs(!1),_s=Ei(null),Is=null,Es=null,Ss=null;function ks(){Ss=Es=Is=null}function Ts(e){var t=_s.current;Si(_s),e._currentValue=t}function Ns(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Cs(e,t){Is=e,Ss=Es=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ba=!0),e.firstContext=null)}function As(e){var t=e._currentValue;if(Ss!==e)if(e={context:e,memoizedValue:t,next:null},null===Es){if(null===Is)throw Error(s(308));Es=e,Is.dependencies={lanes:0,firstContext:e}}else Es=Es.next=e;return t}var Ds=null;function Ps(e){null===Ds?Ds=[e]:Ds.push(e)}function Rs(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ps(t)):(n.next=i.next,i.next=n),t.interleaved=n,Os(e,r)}function Os(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ls=!1;function js(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ms(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Vs(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Os(e,n)}return null===(i=r.interleaved)?(t.next=t,Ps(r)):(t.next=i.next,i.next=t),r.interleaved=t,Os(e,n)}function Us(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function zs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function $s(e,t,n,r){var i=e.updateQueue;Ls=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,f=a.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=M({},h,d);break e;case 2:Ls=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);jl|=o,e.lanes=o,e.memoizedState=h}}function Bs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var qs={},Hs=Ei(qs),Ws=Ei(qs),Ks=Ei(qs);function Gs(e){if(e===qs)throw Error(s(174));return e}function Qs(e,t){switch(ki(Ks,t),ki(Ws,e),ki(Hs,qs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Si(Hs),ki(Hs,t)}function Xs(){Si(Hs),Si(Ws),Si(Ks)}function Js(e){Gs(Ks.current);var t=Gs(Hs.current),n=le(t,e.type);t!==n&&(ki(Ws,e),ki(Hs,n))}function Ys(e){Ws.current===e&&(Si(Hs),Si(Ws))}var Zs=Ei(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=w.ReactCurrentDispatcher,io=w.ReactCurrentBatchConfig,so=0,oo=null,ao=null,lo=null,co=!1,uo=!1,ho=0,fo=0;function po(){throw Error(s(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function go(e,t,n,r,i,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?Zo:ea,e=n(r,i),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(s(301));o+=1,lo=ao=null,t.updateQueue=null,ro.current=ta,e=n(r,i)}while(uo)}if(ro.current=Yo,t=null!==ao&&null!==ao.next,so=0,lo=ao=oo=null,co=!1,t)throw Error(s(300));return e}function yo(){var e=0!==ho;return ho=0,e}function vo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function bo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function wo(e,t){return"function"===typeof t?t(e):t}function xo(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=ao,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((so&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=r):c=c.next=d,oo.lanes|=h,jl|=h}u=u.next}while(null!==u&&u!==o);null===c?a=r:c.next=l,ar(r,t.memoizedState)||(ba=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,oo.lanes|=o,jl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function _o(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);ar(o,t.memoizedState)||(ba=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Io(){}function Eo(e,t){var n=oo,r=bo(),i=t(),o=!ar(r.memoizedState,i);if(o&&(r.memoizedState=i,ba=!0),r=r.queue,jo(To.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Do(9,ko.bind(null,n,r,i,t),void 0,null),null===Cl)throw Error(s(349));0!==(30&so)||So(n,t,i)}return i}function So(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ko(e,t,n,r){t.value=n,t.getSnapshot=r,No(t)&&Co(e)}function To(e,t,n){return n(function(){No(t)&&Co(e)})}function No(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Co(e){var t=Os(e,1);null!==t&&nc(t,e,1,-1)}function Ao(e){var t=vo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Go.bind(null,oo,e),[t.memoizedState,e]}function Do(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Po(){return bo().memoizedState}function Ro(e,t,n,r){var i=vo();oo.flags|=e,i.memoizedState=Do(1|t,n,void 0,void 0===r?null:r)}function Oo(e,t,n,r){var i=bo();r=void 0===r?null:r;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==r&&mo(r,o.deps))return void(i.memoizedState=Do(t,n,s,r))}oo.flags|=e,i.memoizedState=Do(1|t,n,s,r)}function Lo(e,t){return Ro(8390656,8,e,t)}function jo(e,t){return Oo(2048,8,e,t)}function Mo(e,t){return Oo(4,2,e,t)}function Fo(e,t){return Oo(4,4,e,t)}function Vo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Uo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4,4,Vo.bind(null,t,e),n)}function zo(){}function $o(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Bo(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qo(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,ba=!0),e.memoizedState=n):(ar(n,t)||(n=mt(),oo.lanes|=n,jl|=n,e.baseState=!0),t)}function Ho(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=io.transition;io.transition={};try{e(!1),t()}finally{bt=n,io.transition=r}}function Wo(){return bo().memoizedState}function Ko(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qo(e))Xo(t,n);else if(null!==(n=Rs(e,t,n,r))){nc(n,e,r,ec()),Jo(n,t,r)}}function Go(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qo(e))Xo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,o)){var l=t.interleaved;return null===l?(i.next=i,Ps(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Rs(e,t,i,r))&&(nc(n,e,r,i=ec()),Jo(n,t,r))}}function Qo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Xo(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Jo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Yo={readContext:As,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},Zo={readContext:As,useCallback:function(e,t){return vo().memoizedState=[e,void 0===t?null:t],e},useContext:As,useEffect:Lo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ro(4194308,4,Vo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ro(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ro(4,2,e,t)},useMemo:function(e,t){var n=vo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ko.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vo().memoizedState=e},useState:Ao,useDebugValue:zo,useDeferredValue:function(e){return vo().memoizedState=e},useTransition:function(){var e=Ao(!1),t=e[0];return e=Ho.bind(null,e[1]),vo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,i=vo();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Cl)throw Error(s(349));0!==(30&so)||So(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Lo(To.bind(null,r,o,e),[e]),r.flags|=2048,Do(9,ko.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=vo(),t=Cl.identifierPrefix;if(is){var n=Ji;t=":"+t+"R"+(n=(Xi&~(1<<32-ot(Xi)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:As,useCallback:$o,useContext:As,useEffect:jo,useImperativeHandle:Uo,useInsertionEffect:Mo,useLayoutEffect:Fo,useMemo:Bo,useReducer:xo,useRef:Po,useState:function(){return xo(wo)},useDebugValue:zo,useDeferredValue:function(e){return qo(bo(),ao.memoizedState,e)},useTransition:function(){return[xo(wo)[0],bo().memoizedState]},useMutableSource:Io,useSyncExternalStore:Eo,useId:Wo,unstable_isNewReconciler:!1},ta={readContext:As,useCallback:$o,useContext:As,useEffect:jo,useImperativeHandle:Uo,useInsertionEffect:Mo,useLayoutEffect:Fo,useMemo:Bo,useReducer:_o,useRef:Po,useState:function(){return _o(wo)},useDebugValue:zo,useDeferredValue:function(e){var t=bo();return null===ao?t.memoizedState=e:qo(t,ao.memoizedState,e)},useTransition:function(){return[_o(wo)[0],bo().memoizedState]},useMutableSource:Io,useSyncExternalStore:Eo,useId:Wo,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ra(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Fs(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Vs(e,s,i))&&(nc(t,e,i,r),Us(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Fs(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Vs(e,s,i))&&(nc(t,e,i,r),Us(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=Fs(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Vs(e,i,r))&&(nc(t,e,r,n),Us(t,e,r))}};function sa(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function oa(e,t,n){var r=!1,i=Ti,s=t.contextType;return"object"===typeof s&&null!==s?s=As(s):(i=Pi(t)?Ai:Ni.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Di(e,i):Ti),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function la(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},js(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=As(s):(s=Pi(t)?Ai:Ni.current,i.context=Di(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ra(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ia.enqueueReplaceState(i,i.state,null),$s(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var da="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Fs(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Hl=r),ha(0,t)},n}function pa(e,t,n){(n=Fs(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ha(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!==typeof r&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new da;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fs(-1,1)).tag=2,Vs(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var va=w.ReactCurrentOwner,ba=!1;function wa(e,t,n,r){t.child=null===e?xs(t,null,n,r):ws(t,e.child,n,r)}function xa(e,t,n,r,i){n=n.render;var s=t.ref;return Cs(t,i),r=go(e,t,n,r,s,i),n=yo(),null===e||ba?(is&&n&&es(t),t.flags|=1,wa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qa(e,t,i))}function _a(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Pc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ia(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return qa(e,t,i)}return t.flags|=1,(e=Rc(s,r)).ref=t.ref,e.return=t,t.child=e}function Ia(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(ba=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,qa(e,t,i);0!==(131072&e.flags)&&(ba=!0)}}return ka(e,t,n,r,i)}function Ea(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ki(Rl,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ki(Rl,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,ki(Rl,Pl),Pl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,ki(Rl,Pl),Pl|=r;return wa(e,t,i,n),t.child}function Sa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ka(e,t,n,r,i){var s=Pi(n)?Ai:Ni.current;return s=Di(t,s),Cs(t,i),n=go(e,t,n,r,s,i),r=yo(),null===e||ba?(is&&r&&es(t),t.flags|=1,wa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qa(e,t,i))}function Ta(e,t,n,r,i){if(Pi(n)){var s=!0;ji(t)}else s=!1;if(Cs(t,i),null===t.stateNode)Ba(e,t),oa(t,n,r),la(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=As(c):c=Di(t,c=Pi(n)?Ai:Ni.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==c)&&aa(t,o,r,c),Ls=!1;var d=t.memoizedState;o.state=d,$s(t,r,o,i),l=t.memoizedState,a!==r||d!==l||Ci.current||Ls?("function"===typeof u&&(ra(t,n,u,r),l=t.memoizedState),(a=Ls||sa(t,n,a,r,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ms(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=As(l):l=Di(t,l=Pi(n)?Ai:Ni.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&aa(t,o,r,l),Ls=!1,d=t.memoizedState,o.state=d,$s(t,r,o,i);var p=t.memoizedState;a!==h||d!==p||Ci.current||Ls?("function"===typeof f&&(ra(t,n,f,r),p=t.memoizedState),(c=Ls||sa(t,n,c,r,d,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Na(e,t,n,r,s,i)}function Na(e,t,n,r,i,s){Sa(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Mi(t,n,!1),qa(e,t,s);r=t.stateNode,va.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,a,s)):wa(e,t,a,s),t.memoizedState=r.state,i&&Mi(t,n,!0),t.child}function Ca(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),Qs(e,t.containerInfo)}function Aa(e,t,n,r,i){return fs(),ps(i),t.flags|=256,wa(e,t,n,r),t.child}var Da,Pa,Ra,Oa,La={dehydrated:null,treeContext:null,retryLane:0};function ja(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ma(e,t,n){var r,i=t.pendingProps,o=Zs.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),ki(Zs,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=jc(l,i,0,null),e=Lc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=ja(n),t.memoizedState=La,e):Fa(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,Va(e,t,a,r=ua(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=jc({mode:"visible",children:r.children},i,0,null),(o=Lc(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,a),t.child.memoizedState=ja(a),t.memoizedState=La,o);if(0===(1&t.mode))return Va(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Va(e,t,a,r=ua(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),ba||l){if(null!==(r=Cl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Os(e,i),nc(r,e,i,-1))}return mc(),Va(e,t,a,r=ua(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,rs=ci(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Ki[Gi++]=Xi,Ki[Gi++]=Ji,Ki[Gi++]=Qi,Xi=e.id,Ji=e.overflow,Qi=t),t=Fa(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Rc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Rc(r,a):(a=Lc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?ja(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=La,i}return e=(a=e.child).sibling,i=Rc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fa(e,t){return(t=jc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Va(e,t,n,r){return null!==r&&ps(r),ws(t,e.child,null,n),(e=Fa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ua(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ns(e.return,t,n)}function za(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function $a(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(wa(e,t,r.children,n),0!==(2&(r=Zs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ua(e,n,t);else if(19===e.tag)Ua(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ki(Zs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),za(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===eo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}za(t,!0,n,null,s);break;case"together":za(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ba(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),jl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ha(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Wa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ka(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wa(t),null;case 1:case 17:return Pi(t.type)&&Ri(),Wa(t),null;case 3:return r=t.stateNode,Xs(),Si(Ci),Si(Ni),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Pa(e,t),Wa(t),null;case 5:Ys(t);var i=Gs(Ks.current);if(n=t.type,null!==e&&null!=t.stateNode)Ra(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Wa(t),null}if(e=Gs(Hs.current),hs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[di]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)Vr(Lr[i],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":X(r,o),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Vr("invalid",r);break;case"textarea":ie(r,o),Vr("invalid",r)}for(var l in ve(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Yr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Yr(r.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Vr("scroll",r)}switch(n){case"input":W(r),Z(r,o,!0);break;case"textarea":W(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[fi]=r,Da(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),i=r;break;case"iframe":case"object":case"embed":Vr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)Vr(Lr[i],e);i=r;break;case"source":Vr("error",e),i=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),i=r;break;case"details":Vr("toggle",e),i=r;break;case"input":X(e,r),i=Q(e,r),Vr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=M({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Vr("invalid",e)}for(o in ve(n,i),c=i)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Vr("scroll",e):null!=u&&b(e,o,u,l))}switch(n){case"input":W(e),Z(e,r,!1);break;case"textarea":W(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wa(t),null;case 6:if(e&&null!=t.stateNode)Oa(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Gs(Ks.current),Gs(Hs.current),hs(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(o=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Yr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Yr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return Wa(t),null;case 13:if(Si(Zs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))ds(),fs(),t.flags|=98560,o=!1;else if(o=hs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[di]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wa(t),o=!1}else null!==ss&&(oc(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Ol&&(Ol=3):mc())),null!==t.updateQueue&&(t.flags|=4),Wa(t),null);case 4:return Xs(),Pa(e,t),null===e&&$r(t.stateNode.containerInfo),Wa(t),null;case 10:return Ts(t.type._context),Wa(t),null;case 19:if(Si(Zs),null===(o=t.memoizedState))return Wa(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Ha(o,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Ha(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ki(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>$l&&(t.flags|=128,r=!0,Ha(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ha(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!is)return Wa(t),null}else 2*Je()-o.renderingStartTime>$l&&1073741824!==n&&(t.flags|=128,r=!0,Ha(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,n=Zs.current,ki(Zs,r?1&n|2:1&n),t):(Wa(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(Wa(t),6&t.subtreeFlags&&(t.flags|=8192)):Wa(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ga(e,t){switch(ts(t),t.tag){case 1:return Pi(t.type)&&Ri(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xs(),Si(Ci),Si(Ni),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ys(t),null;case 13:if(Si(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Si(Zs),null;case 4:return Xs(),null;case 10:return Ts(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Da=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Pa=function(){},Ra=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Gs(Hs.current);var s,o=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),o=[];break;case"select":i=M({},i,{value:void 0}),r=M({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ve(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Vr("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Oa=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qa=!1,Xa=!1,Ja="function"===typeof WeakSet?WeakSet:Set,Ya=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ec(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Ec(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&el(t,n,s)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Xa||Za(n,t);case 6:var r=ul,i=hl;ul=null,dl(e,t,n),hl=i,null!==(ul=r)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),$t(e)):li(ul,n.stateNode));break;case 4:r=ul,i=hl,ul=n.stateNode.containerInfo,hl=!0,dl(e,t,n),ul=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Xa&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),i=i.next}while(i!==r)}dl(e,t,n);break;case 1:if(!Xa&&(Za(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ec(n,t,a)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Xa=(r=Xa)||null!==n.memoizedState,dl(e,t,n),Xa=r):dl(e,t,n);break;default:dl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ja),t.forEach(function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));fl(o,a,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Ec(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Ec(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Ec(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&Za(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&Za(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){Ec(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&J(i,o),be(l,a);var u=be(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):b(i,h,d,u)}switch(l){case"input":Y(i,o);break;case"textarea":se(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(g){Ec(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Ec(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{$t(t.containerInfo)}catch(g){Ec(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(zl=Je())),4&r&&pl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Xa=(u=Xa)||h,ml(t,e),Xa=u):ml(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Ya=e,h=e.child;null!==h;){for(d=Ya=h;null!==Ya;){switch(p=(f=Ya).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Za(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ec(r,n,g)}}break;case 5:Za(f,f.return);break;case 22:if(null!==f.memoizedState){xl(d);continue}}null!==p?(p.return=f,Ya=p):xl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Ec(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Ec(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),yl(e),4&r&&pl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),cl(e,al(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,al(e),o);break;default:throw Error(s(161))}}catch(a){Ec(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Ya=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Ya;){var i=Ya,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Qa;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Xa;a=Qa;var c=Xa;if(Qa=o,(Xa=l)&&!c)for(Ya=i;null!==Ya;)l=(o=Ya).child,22===o.tag&&null!==o.memoizedState?_l(i):null!==l?(l.return=o,Ya=l):_l(i);for(;null!==s;)Ya=s,bl(s,t,n),s=s.sibling;Ya=i,Qa=a,Xa=c}wl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Ya=s):wl(e)}}function wl(e){for(;null!==Ya;){var t=Ya;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xa||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xa)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Bs(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&$t(d)}}}break;default:throw Error(s(163))}Xa||512&t.flags&&il(t)}catch(f){Ec(t,t.return,f)}}if(t===e){Ya=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ya=n;break}Ya=t.return}}function xl(e){for(;null!==Ya;){var t=Ya;if(t===e){Ya=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ya=n;break}Ya=t.return}}function _l(e){for(;null!==Ya;){var t=Ya;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Ec(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Ec(t,i,l)}}var s=t.return;try{il(t)}catch(l){Ec(t,s,l)}break;case 5:var o=t.return;try{il(t)}catch(l){Ec(t,o,l)}}}catch(l){Ec(t,t.return,l)}if(t===e){Ya=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ya=a;break}Ya=t.return}}var Il,El=Math.ceil,Sl=w.ReactCurrentDispatcher,kl=w.ReactCurrentOwner,Tl=w.ReactCurrentBatchConfig,Nl=0,Cl=null,Al=null,Dl=0,Pl=0,Rl=Ei(0),Ol=0,Ll=null,jl=0,Ml=0,Fl=0,Vl=null,Ul=null,zl=0,$l=1/0,Bl=null,ql=!1,Hl=null,Wl=null,Kl=!1,Gl=null,Ql=0,Xl=0,Jl=null,Yl=-1,Zl=0;function ec(){return 0!==(6&Nl)?Je():-1!==Yl?Yl:Yl=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==Dl?Dl&-Dl:null!==ms.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function nc(e,t,n,r){if(50<Xl)throw Xl=0,Jl=null,Error(s(185));yt(e,n,r),0!==(2&Nl)&&e===Cl||(e===Cl&&(0===(2&Nl)&&(Ml|=n),4===Ol&&ac(e,Dl)),rc(e,r),1===n&&0===Nl&&0===(1&t.mode)&&($l=Je()+500,Vi&&$i()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=dt(e,e===Cl?Dl:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Vi=!0,zi(e)}(lc.bind(null,e)):zi(lc.bind(null,e)),oi(function(){0===(6&Nl)&&$i()}),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Cc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Yl=-1,Zl=0,0!==(6&Nl))throw Error(s(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var r=dt(e,e===Cl?Dl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var i=Nl;Nl|=2;var o=pc();for(Cl===e&&Dl===t||(Bl=null,$l=Je()+500,dc(e,t));;)try{vc();break}catch(l){fc(e,l)}ks(),Sl.current=o,Nl=i,null!==Al?t=0:(Cl=null,Dl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=sc(e,i))),1===t)throw n=Ll,dc(e,0),ac(e,r),rc(e,Je()),n;if(6===t)ac(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ar(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,r))&&(0!==(o=pt(e))&&(r=o,t=sc(e,o))),1===t))throw n=Ll,dc(e,0),ac(e,r),rc(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:xc(e,Ul,Bl);break;case 3:if(ac(e,r),(130023424&r)===r&&10<(t=zl+500-Je())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(xc.bind(null,e,Ul,Bl),t);break}xc(e,Ul,Bl);break;case 4:if(ac(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){e.timeoutHandle=ri(xc.bind(null,e,Ul,Bl),r);break}xc(e,Ul,Bl);break;default:throw Error(s(329))}}}return rc(e,Je()),e.callbackNode===n?ic.bind(null,e):null}function sc(e,t){var n=Vl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=n,null!==t&&oc(t)),e}function oc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function ac(e,t){for(t&=~Fl,t&=~Ml,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Nl))throw Error(s(327));_c();var t=dt(e,0);if(0===(1&t))return rc(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Ll,dc(e,0),ac(e,t),rc(e,Je()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Ul,Bl),rc(e,Je()),null}function cc(e,t){var n=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=n)&&($l=Je()+500,Vi&&$i())}}function uc(e){null!==Gl&&0===Gl.tag&&0===(6&Nl)&&_c();var t=Nl;Nl|=1;var n=Tl.transition,r=bt;try{if(Tl.transition=null,bt=1,e)return e()}finally{bt=r,Tl.transition=n,0===(6&(Nl=t))&&$i()}}function hc(){Pl=Rl.current,Si(Rl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ri();break;case 3:Xs(),Si(Ci),Si(Ni),no();break;case 5:Ys(r);break;case 4:Xs();break;case 13:case 19:Si(Zs);break;case 10:Ts(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Cl=e,Al=e=Rc(e.current,null),Dl=Pl=t,Ol=0,Ll=null,Fl=Ml=jl=0,Ul=Vl=null,null!==Ds){for(t=0;t<Ds.length;t++)if(null!==(r=(n=Ds[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Ds=null}return e}function fc(e,t){for(;;){var n=Al;try{if(ks(),ro.current=Yo,co){for(var r=oo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}co=!1}if(so=0,lo=ao=oo=null,uo=!1,ho=0,kl.current=null,null===n||null===n.return){Ol=1,Ll=t,Al=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Dl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ga(a);if(null!==p){p.flags&=-257,ya(p,a,l,0,t),1&p.mode&&ma(o,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ma(o,u,t),mc();break e}c=Error(s(426))}else if(is&&1&l.mode){var y=ga(a);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ya(y,a,l,0,t),ps(ca(c,l));break e}}o=c=ca(c,l),4!==Ol&&(Ol=2),null===Vl?Vl=[o]:Vl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,zs(o,fa(0,c,t));break e;case 1:l=c;var v=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Wl||!Wl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,zs(o,pa(o,l,t));break e}}o=o.return}while(null!==o)}wc(n)}catch(w){t=w,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function pc(){var e=Sl.current;return Sl.current=Yo,null===e?Yo:e}function mc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Cl||0===(268435455&jl)&&0===(268435455&Ml)||ac(Cl,Dl)}function gc(e,t){var n=Nl;Nl|=2;var r=pc();for(Cl===e&&Dl===t||(Bl=null,dc(e,t));;)try{yc();break}catch(i){fc(e,i)}if(ks(),Nl=n,Sl.current=r,null!==Al)throw Error(s(261));return Cl=null,Dl=0,Ol}function yc(){for(;null!==Al;)bc(Al)}function vc(){for(;null!==Al&&!Qe();)bc(Al)}function bc(e){var t=Il(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?wc(e):Al=t,kl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ka(n,t,Pl)))return void(Al=n)}else{if(null!==(n=Ga(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Ol=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Ol&&(Ol=5)}function xc(e,t,n){var r=bt,i=Tl.transition;try{Tl.transition=null,bt=1,function(e,t,n,r){do{_c()}while(null!==Gl);if(0!==(6&Nl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Cl&&(Al=Cl=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Cc(tt,function(){return _c(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Tl.transition,Tl.transition=null;var a=bt;bt=1;var l=Nl;Nl|=4,kl.current=null,function(e,t){if(ei=qt,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(x){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==o||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=a),f===o&&++h===r&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,Ya=t;null!==Ya;)if(e=(t=Ya).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ya=e;else for(;null!==Ya;){t=Ya;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(x){Ec(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Ya=e;break}Ya=t.return}m=tl,tl=!1}(e,n),gl(n,e),pr(ti),qt=!!ei,ti=ei=null,e.current=n,vl(n,e,i),Xe(),Nl=l,bt=a,Tl.transition=o}else e.current=n;if(Kl&&(Kl=!1,Gl=e,Ql=i),o=e.pendingLanes,0===o&&(Wl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ql)throw ql=!1,e=Hl,Hl=null,e;0!==(1&Ql)&&0!==e.tag&&_c(),o=e.pendingLanes,0!==(1&o)?e===Jl?Xl++:(Xl=0,Jl=e):Xl=0,$i()}(e,t,n,r)}finally{Tl.transition=i,bt=r}return null}function _c(){if(null!==Gl){var e=wt(Ql),t=Tl.transition,n=bt;try{if(Tl.transition=null,bt=16>e?16:e,null===Gl)var r=!1;else{if(e=Gl,Gl=null,Ql=0,0!==(6&Nl))throw Error(s(331));var i=Nl;for(Nl|=4,Ya=e.current;null!==Ya;){var o=Ya,a=o.child;if(0!==(16&Ya.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Ya=u;null!==Ya;){var h=Ya;switch(h.tag){case 0:case 11:case 15:nl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Ya=d;else for(;null!==Ya;){var f=(h=Ya).sibling,p=h.return;if(sl(h),h===u){Ya=null;break}if(null!==f){f.return=p,Ya=f;break}Ya=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Ya=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Ya=a;else e:for(;null!==Ya;){if(0!==(2048&(o=Ya).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Ya=v;break e}Ya=o.return}}var b=e.current;for(Ya=b;null!==Ya;){var w=(a=Ya).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Ya=w;else e:for(a=b;null!==Ya;){if(0!==(2048&(l=Ya).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(_){Ec(l,l.return,_)}if(l===a){Ya=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Ya=x;break e}Ya=l.return}}if(Nl=i,$i(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(_){}r=!0}return r}finally{bt=n,Tl.transition=t}}return!1}function Ic(e,t,n){e=Vs(e,t=fa(0,t=ca(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function Ec(e,t,n){if(3===e.tag)Ic(e,e,n);else for(;null!==t;){if(3===t.tag){Ic(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Wl||!Wl.has(r))){t=Vs(t,e=pa(t,e=ca(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Cl===e&&(Dl&n)===n&&(4===Ol||3===Ol&&(130023424&Dl)===Dl&&500>Je()-zl?dc(e,0):Fl|=n),rc(e,t)}function kc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Os(e,t))&&(yt(e,t,n),rc(e,n))}function Tc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),kc(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),kc(e,n)}function Cc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,n,r){return new Ac(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Pc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case I:return Lc(n.children,i,o,t);case E:a=8,i|=8;break;case S:return(e=Dc(12,n,t,2|i)).elementType=S,e.lanes=o,e;case C:return(e=Dc(13,n,t,i)).elementType=C,e.lanes=o,e;case A:return(e=Dc(19,n,t,i)).elementType=A,e.lanes=o,e;case R:return jc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case k:a=10;break e;case T:a=9;break e;case N:a=11;break e;case D:a=14;break e;case P:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Dc(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Lc(e,t,n,r){return(e=Dc(7,e,r,t)).lanes=n,e}function jc(e,t,n,r){return(e=Dc(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Mc(e,t,n){return(e=Dc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,i,s,o,a,l){return e=new Vc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Dc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},js(s),e}function zc(e){if(!e)return Ti;e:{if($e(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Pi(n))return Li(e,n,t)}return t}function $c(e,t,n,r,i,s,o,a,l){return(e=Uc(n,r,!0,e,0,s,0,a,l)).context=zc(null),n=e.current,(s=Fs(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,Vs(n,s,i),e.current.lanes=i,yt(e,i,r),rc(e,r),e}function Bc(e,t,n,r){var i=t.current,s=ec(),o=tc(i);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fs(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Vs(i,t,o))&&(nc(e,i,o,s),Us(e,i,o)),o}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}Il=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)ba=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ba=!1,function(e,t,n){switch(t.tag){case 3:Ca(t),fs();break;case 5:Js(t);break;case 1:Pi(t.type)&&ji(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;ki(_s,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(ki(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ma(e,t,n):(ki(Zs,1&Zs.current),null!==(e=qa(e,t,n))?e.sibling:null);ki(Zs,1&Zs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return $a(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),ki(Zs,Zs.current),r)break;return null;case 22:case 23:return t.lanes=0,Ea(e,t,n)}return qa(e,t,n)}(e,t,n);ba=0!==(131072&e.flags)}else ba=!1,is&&0!==(1048576&t.flags)&&Zi(t,Wi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ba(e,t),e=t.pendingProps;var i=Di(t,Ni.current);Cs(t,n),i=go(null,t,r,e,i,n);var o=yo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pi(r)?(o=!0,ji(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,js(t),i.updater=ia,t.stateNode=i,i._reactInternals=t,la(t,r,e,n),t=Na(null,t,r,!0,o,n)):(t.tag=0,is&&o&&es(t),wa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ba(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===N)return 11;if(e===D)return 14}return 2}(r),e=na(r,e),i){case 0:t=ka(null,t,r,e,n);break e;case 1:t=Ta(null,t,r,e,n);break e;case 11:t=xa(null,t,r,e,n);break e;case 14:t=_a(null,t,r,na(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,ka(e,t,r,i=t.elementType===r?i:na(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ta(e,t,r,i=t.elementType===r?i:na(r,i),n);case 3:e:{if(Ca(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Ms(e,t),$s(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Aa(e,t,r,n,i=ca(Error(s(423)),t));break e}if(r!==i){t=Aa(e,t,r,n,i=ca(Error(s(424)),t));break e}for(rs=ci(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=xs(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=qa(e,t,n);break e}wa(e,t,r,n)}t=t.child}return t;case 5:return Js(t),null===e&&cs(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==o&&ni(r,o)&&(t.flags|=32),Sa(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Ma(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):wa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,xa(e,t,r,i=t.elementType===r?i:na(r,i),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,ki(_s,r._currentValue),r._currentValue=a,null!==o)if(ar(o.value,a)){if(o.children===i.children&&!Ci.current){t=qa(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Fs(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ns(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ns(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}wa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Cs(t,n),r=r(i=As(i)),t.flags|=1,wa(e,t,r,n),t.child;case 14:return i=na(r=t.type,t.pendingProps),_a(e,t,r,i=na(r.type,i),n);case 15:return Ia(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:na(r,i),Ba(e,t),t.tag=1,Pi(r)?(e=!0,ji(t)):e=!1,Cs(t,n),oa(t,r,i),la(t,r,i,n),Na(null,t,r,!0,e,n);case 19:return $a(e,t,n);case 22:return Ea(e,t,n)}throw Error(s(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Gc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yc(){}function Zc(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=qc(o);a.call(e)}}Bc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=qc(o);s.call(e)}}var o=$c(t,r,e,0,null,!1,0,"",Yc);return e._reactRootContainer=o,e[pi]=o.current,$r(8===e.nodeType?e.parentNode:e),uc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=qc(l);a.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Yc);return e._reactRootContainer=l,e[pi]=l.current,$r(8===e.nodeType?e.parentNode:e),uc(function(){Bc(t,l,n,r)}),l}(n,t,e,i,r);return qc(o)}Qc.prototype.render=Gc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Bc(e,t,null,null)},Qc.prototype.unmount=Gc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Bc(null,e,null,null)}),t[pi]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Mt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,Je()),0===(6&Nl)&&($l=Je()+500,$i()))}break;case 13:uc(function(){var t=Os(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Wc(e,1)}},_t=function(e){if(13===e.tag){var t=Os(e,134217728);if(null!==t)nc(t,e,134217728,ec());Wc(e,134217728)}},It=function(e){if(13===e.tag){var t=tc(e),n=Os(e,t);if(null!==n)nc(n,e,t,ec());Wc(e,t)}},Et=function(){return bt},St=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},_e=function(e,t,n){switch(t){case"input":if(Y(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=xi(r);if(!i)throw Error(s(90));K(r),Y(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ne=cc,Ce=uc;var eu={usingClientEntryPoint:!1,Events:[bi,wi,xi,ke,Te,cc]},tu={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(s(299));var n=!1,r="",i=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,$r(8===e.nodeType?e.parentNode:e),new Gc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(s(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=$c(t,null,e,1,null!=n?n:null,i,0,o,a),e[pi]=t.current,$r(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Qc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(s(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[pi]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{"use strict";e.exports=n(234)},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{addDoc:()=>Zy,arrayUnion:()=>ov,collection:()=>Ug,default:()=>Iv,doc:()=>zg,getConnectionStatus:()=>yv,getDoc:()=>Qy,getFirebaseAuth:()=>bv,getFirebaseFirestore:()=>wv,increment:()=>av,initializeFirebase:()=>vv,onAuthStateChangedListener:()=>_v,onSnapshot:()=>ev,signInAnonymouslyWithFirebase:()=>xv,updateDoc:()=>Yy,writeBatch:()=>lv});var t={};n.r(t),n.d(t,{callGroqLlmApi:()=>Cv,default:()=>Pv,getApiStatus:()=>Dv});var r=n(43),i=n(391),s=n(725),o=n.n(s),a=/[A-Z]/g,l=/^ms-/,c={};function u(e){return"-"+e.toLowerCase()}const h=function(e){if(c.hasOwnProperty(e))return c[e];var t=e.replace(a,u);return c[e]=l.test(t)?"-"+t:t};function d(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=Object.keys(e),r=Object.keys(t),i=n.length;if(r.length!==i)return!1;for(let s=0;s<i;s++){const r=n[s];if(e[r]!==t[r]||!Object.prototype.hasOwnProperty.call(t,r))return!1}return!0}var f=n(173),p=n.n(f);const m=p().oneOfType([p().string,p().number]),g={all:p().bool,grid:p().bool,aural:p().bool,braille:p().bool,handheld:p().bool,print:p().bool,projection:p().bool,screen:p().bool,tty:p().bool,tv:p().bool,embossed:p().bool},y={orientation:p().oneOf(["portrait","landscape"]),scan:p().oneOf(["progressive","interlace"]),aspectRatio:p().string,deviceAspectRatio:p().string,height:m,deviceHeight:m,width:m,deviceWidth:m,color:p().bool,colorIndex:p().bool,monochrome:p().bool,resolution:m,type:Object.keys(g)},{type:v,...b}=y,w={minAspectRatio:p().string,maxAspectRatio:p().string,minDeviceAspectRatio:p().string,maxDeviceAspectRatio:p().string,minHeight:m,maxHeight:m,minDeviceHeight:m,maxDeviceHeight:m,minWidth:m,maxWidth:m,minDeviceWidth:m,maxDeviceWidth:m,minColor:p().number,maxColor:p().number,minColorIndex:p().number,maxColorIndex:p().number,minMonochrome:p().number,maxMonochrome:p().number,minResolution:m,maxResolution:m,...b};var x={all:{...g,...w},types:g,matchers:y,features:w};const _=e=>{const t=[];return Object.keys(x.all).forEach(n=>{const r=e[n];null!=r&&t.push(((e,t)=>{const n=h(e);return"number"===typeof t&&(t=`${t}px`),!0===t?n:!1===t?`not ${n}`:`(${n}: ${t})`})(n,r))}),t.join(" and ")},I=(0,r.createContext)(void 0),E=e=>{if(!e)return;return Object.keys(e).reduce((t,n)=>(t[h(n)]=e[n],t),{})},S=()=>{const e=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{e.current=!0},[]),e.current},k=e=>{const t=()=>(e=>e.query||_(e))(e),[n,i]=(0,r.useState)(t);return(0,r.useEffect)(()=>{const e=t();n!==e&&i(e)},[e]),n},T=(e,t,n)=>{const i=(e=>{const t=(0,r.useContext)(I),n=()=>E(e)||E(t),[i,s]=(0,r.useState)(n);return(0,r.useEffect)(()=>{const e=n();d(i,e)||s(e)},[e,t]),i})(t),s=k(e);if(!s)throw new Error("Invalid or missing MediaQuery!");const a=((e,t)=>{const n=()=>o()(e,t||{},!!t),[i,s]=(0,r.useState)(n),a=S();return(0,r.useEffect)(()=>{if(a){const e=n();return s(e),()=>{e&&e.dispose()}}},[e,t]),i})(s,i),l=(e=>{const[t,n]=(0,r.useState)(e.matches);return(0,r.useEffect)(()=>{const t=e=>{n(e.matches)};return e.addListener(t),n(e.matches),()=>{e.removeListener(t)}},[e]),t})(a),c=S();return(0,r.useEffect)(()=>{c&&n&&n(l)},[l]),(0,r.useEffect)(()=>()=>{a&&a.dispose()},[]),l},N=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},C={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(N(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new A;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class A extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const D=function(e){return function(e){const t=N(e);return C.encodeByteArray(t,!0)}(e).replace(/\./g,"")},P=function(e){try{return C.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function R(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const O=()=>{try{return R().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/jemini",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&P(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},L=e=>{var t,n;return null===(n=null===(t=O())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},j=()=>{var e;return null===(e=O())||void 0===e?void 0:e.config},M=e=>{var t;return null===(t=O())||void 0===t?void 0:t[`_${e}`]};class F{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function V(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function U(e){return(await fetch(e,{credentials:"include"})).ok}const z={};let $=!1;function B(e,t){if("undefined"===typeof window||"undefined"===typeof document||!V(window.location.host)||z[e]===t||z[e]||$)return;function n(e){return`__firebase__banner__${e}`}z[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(z))z[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{$=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function o(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),o=document.getElementById(t)||document.createElement("span"),a=n("learnmore"),l=document.getElementById(a)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,a);const n=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,o,l,n),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function q(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function H(){var e;const t=null===(e=O())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function W(){return!H()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function K(){return!H()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function G(){try{return"object"===typeof indexedDB}catch(e){return!1}}class Q extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Q.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,X.prototype.create)}}class X{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(J,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(r,t):"Error",s=`${this.serviceName}: ${i} (${n}).`;return new Q(n,s,t)}}const J=/\{\$([^}]+)}/g;function Y(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(Z(n)&&Z(s)){if(!Y(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Z(e){return null!==e&&"object"===typeof e}function ee(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function te(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function ne(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class re{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=ie),void 0===r.error&&(r.error=ie),void 0===r.complete&&(r.complete=ie);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ie(){}function se(e){return e&&e._delegate?e._delegate:e}class oe{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ae="[DEFAULT]";class le{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new F;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ae})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===ae?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;return this.component?this.component.multipleInstances?e:ae:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ce{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new le(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ue=[];var he;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(he||(he={}));const de={debug:he.DEBUG,verbose:he.VERBOSE,info:he.INFO,warn:he.WARN,error:he.ERROR,silent:he.SILENT},fe=he.INFO,pe={[he.DEBUG]:"log",[he.VERBOSE]:"log",[he.INFO]:"info",[he.WARN]:"warn",[he.ERROR]:"error"},me=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=pe[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r](`[${n}]  ${e.name}:`,...s)};class ge{constructor(e){this.name=e,this._logLevel=fe,this._logHandler=me,this._userLogHandler=null,ue.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in he))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?de[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,he.DEBUG,...t),this._logHandler(this,he.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,he.VERBOSE,...t),this._logHandler(this,he.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,he.INFO,...t),this._logHandler(this,he.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,he.WARN,...t),this._logHandler(this,he.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,he.ERROR,...t),this._logHandler(this,he.ERROR,...t)}}let ye,ve;const be=new WeakMap,we=new WeakMap,xe=new WeakMap,_e=new WeakMap,Ie=new WeakMap;let Ee={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return we.get(e);if("objectStoreNames"===t)return e.objectStoreNames||xe.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Te(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Se(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ve||(ve=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Ne(this),n),Te(be.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Te(e.apply(Ne(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(Ne(this),t,...r);return xe.set(s,t.sort?t.sort():[t]),Te(s)}}function ke(e){return"function"===typeof e?Se(e):(e instanceof IDBTransaction&&function(e){if(we.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});we.set(e,t)}(e),t=e,(ye||(ye=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,Ee):e);var t}function Te(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(Te(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&be.set(t,e)}).catch(()=>{}),Ie.set(t,e),t}(e);if(_e.has(e))return _e.get(e);const t=ke(e);return t!==e&&(_e.set(e,t),Ie.set(t,e)),t}const Ne=e=>Ie.get(e);const Ce=["get","getKey","getAll","getAllKeys","count"],Ae=["put","add","delete","clear"],De=new Map;function Pe(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(De.get(t))return De.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Ae.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Ce.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return De.set(t,s),s}Ee=(e=>({...e,get:(t,n,r)=>Pe(t,n)||e.get(t,n,r),has:(t,n)=>!!Pe(t,n)||e.has(t,n)}))(Ee);class Re{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const Oe="@firebase/app",Le="0.13.2",je=new ge("@firebase/app"),Me="@firebase/app-compat",Fe="@firebase/analytics-compat",Ve="@firebase/analytics",Ue="@firebase/app-check-compat",ze="@firebase/app-check",$e="@firebase/auth",Be="@firebase/auth-compat",qe="@firebase/database",He="@firebase/data-connect",We="@firebase/database-compat",Ke="@firebase/functions",Ge="@firebase/functions-compat",Qe="@firebase/installations",Xe="@firebase/installations-compat",Je="@firebase/messaging",Ye="@firebase/messaging-compat",Ze="@firebase/performance",et="@firebase/performance-compat",tt="@firebase/remote-config",nt="@firebase/remote-config-compat",rt="@firebase/storage",it="@firebase/storage-compat",st="@firebase/firestore",ot="@firebase/ai",at="@firebase/firestore-compat",lt="firebase",ct="[DEFAULT]",ut={[Oe]:"fire-core",[Me]:"fire-core-compat",[Ve]:"fire-analytics",[Fe]:"fire-analytics-compat",[ze]:"fire-app-check",[Ue]:"fire-app-check-compat",[$e]:"fire-auth",[Be]:"fire-auth-compat",[qe]:"fire-rtdb",[He]:"fire-data-connect",[We]:"fire-rtdb-compat",[Ke]:"fire-fn",[Ge]:"fire-fn-compat",[Qe]:"fire-iid",[Xe]:"fire-iid-compat",[Je]:"fire-fcm",[Ye]:"fire-fcm-compat",[Ze]:"fire-perf",[et]:"fire-perf-compat",[tt]:"fire-rc",[nt]:"fire-rc-compat",[rt]:"fire-gcs",[it]:"fire-gcs-compat",[st]:"fire-fst",[at]:"fire-fst-compat",[ot]:"fire-vertex","fire-js":"fire-js",[lt]:"fire-js-all"},ht=new Map,dt=new Map,ft=new Map;function pt(e,t){try{e.container.addComponent(t)}catch(n){je.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function mt(e){const t=e.name;if(ft.has(t))return je.debug(`There were multiple attempts to register component ${t}.`),!1;ft.set(t,e);for(const n of ht.values())pt(n,e);for(const n of dt.values())pt(n,e);return!0}function gt(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function yt(e){return null!==e&&void 0!==e&&void 0!==e.settings}const vt=new X("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class bt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new oe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw vt.create("app-deleted",{appName:this._name})}}const wt="11.10.0";function xt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:ct,automaticDataCollectionEnabled:!0},t),i=r.name;if("string"!==typeof i||!i)throw vt.create("bad-app-name",{appName:String(i)});if(n||(n=j()),!n)throw vt.create("no-options");const s=ht.get(i);if(s){if(Y(n,s.options)&&Y(r,s.config))return s;throw vt.create("duplicate-app",{appName:i})}const o=new ce(i);for(const l of ft.values())o.addComponent(l);const a=new bt(n,r,o);return ht.set(i,a),a}function _t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct;const t=ht.get(e);if(!t&&e===ct&&j())return xt();if(!t)throw vt.create("no-app",{appName:e});return t}function It(e,t,n){var r;let i=null!==(r=ut[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void je.warn(e.join(" "))}mt(new oe(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const Et="firebase-heartbeat-store";let St=null;function kt(){return St||(St=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=Te(o);return r&&o.addEventListener("upgradeneeded",e=>{r(Te(o.result),e.oldVersion,e.newVersion,Te(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Et)}catch(n){console.warn(n)}}}).catch(e=>{throw vt.create("idb-open",{originalErrorMessage:e.message})})),St}async function Tt(e,t){try{const n=(await kt()).transaction(Et,"readwrite"),r=n.objectStore(Et);await r.put(t,Nt(e)),await n.done}catch(n){if(n instanceof Q)je.warn(n.message);else{const e=vt.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});je.warn(e.message)}}}function Nt(e){return`${e.name}!${e.options.appId}`}class Ct{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Dt(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=At();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){je.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=At(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Pt(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Pt(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=D(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return je.warn(t),""}}}function At(){return(new Date).toISOString().substring(0,10)}class Dt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!G()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await kt()).transaction(Et),n=await t.objectStore(Et).get(Nt(e));return await t.done,n}catch(t){if(t instanceof Q)je.warn(t.message);else{const e=vt.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});je.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Tt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Tt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Pt(e){return D(JSON.stringify({version:2,heartbeats:e})).length}var Rt;Rt="",mt(new oe("platform-logger",e=>new Re(e),"PRIVATE")),mt(new oe("heartbeat",e=>new Ct(e),"PRIVATE")),It(Oe,Le,Rt),It(Oe,Le,"esm2017"),It("fire-js","");It("firebase","11.10.0","app");function Ot(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Lt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jt=Lt,Mt=new X("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ft=new ge("@firebase/auth");function Vt(e){if(Ft.logLevel<=he.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Ft.error(`Auth (${wt}): ${e}`,...n)}}function Ut(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw qt(e,...n)}function zt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return qt(e,...n)}function $t(e,t,n){const r=Object.assign(Object.assign({},jt()),{[t]:n});return new X("auth","Firebase",r).create(t,{appName:e.name})}function Bt(e){return $t(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Mt.create(e,...n)}function Ht(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw qt(t,...r)}}function Wt(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Vt(t),new Error(t)}function Kt(e,t){e||Wt(t)}function Gt(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Qt(){return"http:"===Xt()||"https:"===Xt()}function Xt(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Jt(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Qt()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Yt{constructor(e,t){this.shortDelay=e,this.longDelay=t,Kt(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(q())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Jt()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Zt(e,t){Kt(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class en{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Wt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Wt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Wt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const tn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},nn=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rn=new Yt(3e4,6e4);function sn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function on(e,t,n,r){return an(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=ee(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:a},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&V(e.emulatorConfig.host)&&(l.credentials="include"),en.fetch()(await cn(e,e.config.apiHost,n,o),l)})}async function an(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},tn),t);try{const t=new hn(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw dn(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw dn(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw dn(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw dn(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw $t(e,a,o);Ut(e,a)}}catch(i){if(i instanceof Q)throw i;Ut(e,"network-request-failed",{message:String(i)})}}async function ln(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await on(e,t,n,r,i);return"mfaPendingCredential"in s&&Ut(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function cn(e,t,n,r){const i=`${t}${n}?${r}`,s=e,o=s.config.emulator?Zt(e.config,i):`${e.config.apiScheme}://${i}`;if(nn.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())){return s._getPersistence()._getFinalTarget(o).toString()}return o}function un(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class hn{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(zt(this.auth,"network-request-failed")),rn.get())})}}function dn(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=zt(e,t,r);return i.customData._tokenResponse=n,i}function fn(e){return void 0!==e&&void 0!==e.enterprise}class pn{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return un(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function mn(e,t){return on(e,"GET","/v2/recaptchaConfig",sn(e,t))}async function gn(e,t){return on(e,"POST","/v1/accounts:lookup",t)}function yn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function vn(e){return 1e3*Number(e)}function bn(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Vt("JWT malformed, contained fewer than 3 sections"),null;try{const e=P(n);return e?JSON.parse(e):(Vt("Failed to decode base64 JWT payload"),null)}catch(i){return Vt("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function wn(e){const t=bn(e);return Ht(t,"internal-error"),Ht("undefined"!==typeof t.exp,"internal-error"),Ht("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function xn(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof Q&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class _n{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class In{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=yn(this.lastLoginAt),this.creationTime=yn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function En(e){var t;const n=e.auth,r=await e.getIdToken(),i=await xn(e,gn(n,{idToken:r}));Ht(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?Sn(s.providerUserInfo):[],a=(l=e.providerData,c=o,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new In(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}function Sn(e){return e.map(e=>{var{providerId:t}=e,n=Ot(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class kn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ht(e.idToken,"internal-error"),Ht("undefined"!==typeof e.idToken,"internal-error"),Ht("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):wn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ht(0!==e.length,"internal-error");const t=wn(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Ht(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await an(e,{},async()=>{const n=ee({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=await cn(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:o,body:n};return e.emulatorConfig&&V(e.emulatorConfig.host)&&(a.credentials="include"),en.fetch()(s,a)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new kn;return n&&(Ht("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Ht("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Ht("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new kn,this.toJSON())}_performRefresh(){return Wt("not implemented")}}function Tn(e,t){Ht("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Nn{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Ot(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new _n(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new In(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await xn(this,this.stsTokenManager.getToken(this.auth,e));return Ht(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=se(e),r=await n.getIdToken(t),i=bn(r);Ht(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:yn(vn(i.auth_time)),issuedAtTime:yn(vn(i.iat)),expirationTime:yn(vn(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=se(e);await En(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Ht(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Nn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ht(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await En(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yt(this.auth.app))return Promise.reject(Bt(this.auth));const e=await this.getIdToken();return await xn(this,async function(e,t){return on(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:b,isAnonymous:w,providerData:x,stsTokenManager:_}=t;Ht(v&&_,e,"internal-error");const I=kn.fromJSON(this.name,_);Ht("string"===typeof v,e,"internal-error"),Tn(u,e.name),Tn(h,e.name),Ht("boolean"===typeof b,e,"internal-error"),Ht("boolean"===typeof w,e,"internal-error"),Tn(d,e.name),Tn(f,e.name),Tn(p,e.name),Tn(m,e.name),Tn(g,e.name),Tn(y,e.name);const E=new Nn({uid:v,auth:e,email:h,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:g,lastLoginAt:y});return x&&Array.isArray(x)&&(E.providerData=x.map(e=>Object.assign({},e))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new kn;r.updateFromServerResponse(t);const i=new Nn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await En(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Ht(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Sn(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),o=new kn;o.updateFromIdToken(n);const a=new Nn({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new In(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,l),a}}const Cn=new Map;function An(e){Kt(e instanceof Function,"Expected a class definition");let t=Cn.get(e);return t?(Kt(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Cn.set(e,t),t)}class Dn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Dn.type="NONE";const Pn=Dn;function Rn(e,t,n){return`firebase:${e}:${t}:${n}`}class On{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Rn(this.userKey,r.apiKey,i),this.fullPersistenceKey=Rn("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await gn(this.auth,{idToken:e}).catch(()=>{});return t?Nn._fromGetAccountInfoResponse(this.auth,t,e):null}return Nn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new On(An(Pn),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||An(Pn);const s=Rn(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){let n;if("string"===typeof t){const r=await gn(e,{idToken:t}).catch(()=>{});if(!r)break;n=await Nn._fromGetAccountInfoResponse(e,r,t)}else n=Nn._fromJSON(e,t);c!==i&&(o=n),i=c;break}}catch(l){}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(l){}})),new On(i,e,n)):new On(i,e,n)}}function Ln(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Vn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(jn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(zn(t))return"Blackberry";if($n(t))return"Webos";if(Mn(t))return"Safari";if((t.includes("chrome/")||Fn(t))&&!t.includes("edge/"))return"Chrome";if(Un(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function jn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q();return/firefox\//i.test(e)}function Mn(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:q()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Fn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q();return/crios\//i.test(e)}function Vn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q();return/iemobile/i.test(e)}function Un(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q();return/android/i.test(e)}function zn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q();return/blackberry/i.test(e)}function $n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q();return/webos/i.test(e)}function Bn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function qn(){return function(){const e=q();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Hn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q();return Bn(e)||Un(e)||$n(e)||zn(e)||/windows phone/i.test(e)||Vn(e)}function Wn(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Ln(q());break;case"Worker":t=`${Ln(q())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${wt}/${r}`}class Kn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(i){r(i)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Gn{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Qn{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jn(this),this.idTokenSubscription=new Jn(this),this.beforeStateQueue=new Kn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Mt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=An(t)),this._initializationPromise=this.queue(async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await On.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(s){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await gn(this,{idToken:e}),n=await Nn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(yt(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ht(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await En(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(yt(this.app))return Promise.reject(Bt(this));const t=e?se(e):null;return t&&Ht(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Ht(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return yt(this.app)?Promise.reject(Bt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return yt(this.app)?Promise.reject(Bt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(An(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return on(e,"GET","/v2/passwordPolicy",sn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Gn(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new X("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return on(e,"POST","/v2/accounts:revokeToken",sn(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&An(e)||this._popupRedirectResolver;Ht(t,this,"argument-error"),this.redirectPersistenceManager=await On.create(this,[An(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ht(o,this,"internal-error"),o.then(()=>{s||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ht(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Wn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(yt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Ft.logLevel<=he.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Ft.warn(`Auth (${wt}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function Xn(e){return se(e)}class Jn{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new re(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return Ht(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Yn={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Zn(e){return Yn.loadJS(e)}function er(e){return`__${e}${Math.floor(1e6*Math.random())}`}class tr{constructor(){this.enterprise=new nr}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class nr{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const rr="NO_RECAPTCHA";class ir{constructor(e){this.type="recaptcha-enterprise",this.auth=Xn(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;fn(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(rr)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new tr).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{mn(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new pn(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&fn(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Yn.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Zn(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function sr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=new ir(e);let o;if(i)o=rr;else try{o=await s.verify(n)}catch(l){o=await s.verify(n,!0)}const a=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function or(e,t,n,r,i){var s,o;if("EMAIL_PASSWORD_PROVIDER"===i){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await sr(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await sr(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}if("PHONE_PROVIDER"===i){if(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.isProviderEnabled("PHONE_PROVIDER")){const i=await sr(e,t,n);return r(e,i).catch(async i=>{var s;if("AUDIT"===(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const i=await sr(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)})}{const i=await sr(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function ar(e){const t=Xn(e),n=await mn(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new pn(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new ir(t).verify()}}function lr(e,t,n){const r=Xn(e);Ht(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=cr(t),{host:o,port:a}=function(e){const t=cr(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:ur(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:ur(t)}}}(t),l=null===a?"":`:${a}`,c={url:`${s}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return Ht(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void Ht(Y(c,r.config.emulator)&&Y(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,V(o)?(U(`${s}//${o}${l}`),B("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function cr(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ur(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class hr{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wt("not implemented")}_getIdTokenResponse(e){return Wt("not implemented")}_linkToIdToken(e,t){return Wt("not implemented")}_getReauthenticationResolver(e){return Wt("not implemented")}}async function dr(e,t){return on(e,"POST","/v1/accounts:signUp",t)}async function fr(e,t){return ln(e,"POST","/v1/accounts:signInWithPassword",sn(e,t))}class pr extends hr{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new pr(e,t,"password")}static _fromEmailAndCode(e,t){return new pr(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return or(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",fr,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return ln(e,"POST","/v1/accounts:signInWithEmailLink",sn(e,t))}(e,{email:this._email,oobCode:this._password});default:Ut(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return or(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",dr,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return ln(e,"POST","/v1/accounts:signInWithEmailLink",sn(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Ut(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function mr(e,t){return ln(e,"POST","/v1/accounts:signInWithIdp",sn(e,t))}class gr extends hr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new gr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ut("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Ot(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new gr(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return mr(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,mr(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mr(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ee(t)}return e}}async function yr(e,t){return on(e,"POST","/v1/accounts:sendVerificationCode",sn(e,t))}const vr={USER_NOT_FOUND:"user-not-found"};class br extends hr{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new br({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new br({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return ln(e,"POST","/v1/accounts:signInWithPhoneNumber",sn(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await ln(e,"POST","/v1/accounts:signInWithPhoneNumber",sn(e,t));if(n.temporaryProof)throw dn(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return ln(e,"POST","/v1/accounts:signInWithPhoneNumber",sn(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),vr)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new br({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class wr{constructor(e){var t,n,r,i,s,o;const a=te(ne(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Ht(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.lang)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=te(ne(e)).link,n=t?te(ne(t)).deep_link_id:null,r=te(ne(e)).deep_link_id;return(r?te(ne(r)).link:null)||r||n||t||e}(e);try{return new wr(t)}catch(n){return null}}}class xr{constructor(){this.providerId=xr.PROVIDER_ID}static credential(e,t){return pr._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=wr.parseLink(t);return Ht(n,"argument-error"),pr._fromEmailAndCode(e,n.code,n.tenantId)}}xr.PROVIDER_ID="password",xr.EMAIL_PASSWORD_SIGN_IN_METHOD="password",xr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class _r{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ir extends _r{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Er extends Ir{constructor(){super("facebook.com")}static credential(e){return gr._fromParams({providerId:Er.PROVIDER_ID,signInMethod:Er.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Er.credentialFromTaggedObject(e)}static credentialFromError(e){return Er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Er.credential(t.oauthAccessToken)}catch(n){return null}}}Er.FACEBOOK_SIGN_IN_METHOD="facebook.com",Er.PROVIDER_ID="facebook.com";class Sr extends Ir{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return gr._fromParams({providerId:Sr.PROVIDER_ID,signInMethod:Sr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Sr.credentialFromTaggedObject(e)}static credentialFromError(e){return Sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Sr.credential(n,r)}catch(i){return null}}}Sr.GOOGLE_SIGN_IN_METHOD="google.com",Sr.PROVIDER_ID="google.com";class kr extends Ir{constructor(){super("github.com")}static credential(e){return gr._fromParams({providerId:kr.PROVIDER_ID,signInMethod:kr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return kr.credentialFromTaggedObject(e)}static credentialFromError(e){return kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return kr.credential(t.oauthAccessToken)}catch(n){return null}}}kr.GITHUB_SIGN_IN_METHOD="github.com",kr.PROVIDER_ID="github.com";class Tr extends Ir{constructor(){super("twitter.com")}static credential(e,t){return gr._fromParams({providerId:Tr.PROVIDER_ID,signInMethod:Tr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Tr.credentialFromTaggedObject(e)}static credentialFromError(e){return Tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Tr.credential(n,r)}catch(i){return null}}}async function Nr(e,t){return ln(e,"POST","/v1/accounts:signUp",sn(e,t))}Tr.TWITTER_SIGN_IN_METHOD="twitter.com",Tr.PROVIDER_ID="twitter.com";class Cr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await Nn._fromIdTokenResponse(e,n,r),s=Ar(n);return new Cr({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Ar(n);return new Cr({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Ar(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Dr extends Q{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Dr.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Dr(e,t,n,r)}}function Pr(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw Dr._fromErrorAndOperation(e,n,t,r);throw n})}async function Rr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await xn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Cr._forOperation(e,"link",r)}async function Or(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(yt(r.app))return Promise.reject(Bt(r));const i="reauthenticate";try{const s=await xn(e,Pr(r,i,t,e),n);Ht(s.idToken,r,"internal-error");const o=bn(s.idToken);Ht(o,r,"internal-error");const{sub:a}=o;return Ht(e.uid===a,r,"user-mismatch"),Cr._forOperation(e,i,s)}catch(s){throw"auth/user-not-found"===(null===s||void 0===s?void 0:s.code)&&Ut(r,"user-mismatch"),s}}async function Lr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(yt(e.app))return Promise.reject(Bt(e));const r="signIn",i=await Pr(e,r,t),s=await Cr._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}function jr(e,t){return on(e,"POST","/v2/accounts/mfaEnrollment:start",sn(e,t))}new WeakMap;const Mr="__sak";class Fr{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Mr,"1"),this.storage.removeItem(Mr),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Vr extends Fr{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Hn(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);qn()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Vr.type="LOCAL";const Ur=Vr;function zr(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp(`${r}=([^;]+)`);return null!==(n=null===(t=document.cookie.match(i))||void 0===t?void 0:t[1])&&void 0!==n?n:null}function $r(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class Br{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=$r(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return zr(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=$r(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=$r(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=zr(n);const i=setInterval(()=>{const e=zr(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(i))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}Br.type="COOKIE";class qr extends Fr{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}qr.type="SESSION";const Hr=qr;class Wr{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Wr(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map(async e=>e(t.origin,i)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Kr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Wr.receivers=[];class Gr{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((o,a)=>{const l=Kr("",20);r.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Qr(){return window}function Xr(){return"undefined"!==typeof Qr().WorkerGlobalScope&&"function"===typeof Qr().importScripts}const Jr="firebaseLocalStorageDb",Yr="firebaseLocalStorage",Zr="fbase_key";class ei{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ti(e,t){return e.transaction([Yr],t?"readwrite":"readonly").objectStore(Yr)}function ni(){const e=indexedDB.open(Jr,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Yr,{keyPath:Zr})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Yr)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Jr);return new ei(e).toPromise()}(),t(await ni()))})})}async function ri(e,t,n){const r=ti(e,!0).put({[Zr]:t,value:n});return new ei(r).toPromise()}function ii(e,t){const n=ti(e,!0).delete(t);return new ei(n).toPromise()}class si{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await ni()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Xr()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wr._getInstance(Xr()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Gr(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ni();return await ri(e,Mr,"1"),await ii(e,Mr),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>ri(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=ti(e,!1).get(t),r=await new ei(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ii(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=ti(e,!1).getAll();return new ei(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}si.type="LOCAL";const oi=si;function ai(e,t){return on(e,"POST","/v2/accounts/mfaSignIn:start",sn(e,t))}er("rcb"),new Yt(3e4,6e4);const li="recaptcha";async function ci(e,t,n){var r;if(!e._getRecaptchaConfig())try{await ar(e)}catch(i){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"===typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){Ht("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=or(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===rr){Ht((null===n||void 0===n?void 0:n.type)===li,e,"argument-error");return jr(e,await ui(e,t,n))}return jr(e,t)},"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{Ht("signin"===t.type,e,"internal-error");const s=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;Ht(s,e,"missing-multi-factor-info");const o={mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=or(e,o,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===rr){Ht((null===n||void 0===n?void 0:n.type)===li,e,"argument-error");return ai(e,await ui(e,t,n))}return ai(e,t)},"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=or(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===rr){Ht((null===n||void 0===n?void 0:n.type)===li,e,"argument-error");return yr(e,await ui(e,t,n))}return yr(e,t)},"PHONE_PROVIDER");return(await r.catch(e=>Promise.reject(e))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function ui(e,t,n){Ht(n.type===li,e,"argument-error");const r=await n.verify();Ht("string"===typeof r,e,"argument-error");const i=Object.assign({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:s}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class hi{constructor(e){this.providerId=hi.PROVIDER_ID,this.auth=Xn(e)}verifyPhoneNumber(e,t){return ci(this.auth,e,se(t))}static credential(e,t){return br._fromVerification(e,t)}static credentialFromResult(e){const t=e;return hi.credentialFromTaggedObject(t)}static credentialFromError(e){return hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?br._fromTokenResponse(n,r):null}}function di(e,t){return t?An(t):(Ht(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}hi.PROVIDER_ID="phone",hi.PHONE_SIGN_IN_METHOD="phone";class fi extends hr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return mr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return mr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function pi(e){return Lr(e.auth,new fi(e),e.bypassAuthState)}function mi(e){const{auth:t,user:n}=e;return Ht(n,t,"internal-error"),Or(n,new fi(e),e.bypassAuthState)}async function gi(e){const{auth:t,user:n}=e;return Ht(n,t,"internal-error"),Rr(n,new fi(e),e.bypassAuthState)}class yi{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return pi;case"linkViaPopup":case"linkViaRedirect":return gi;case"reauthViaPopup":case"reauthViaRedirect":return mi;default:Ut(this.auth,"internal-error")}}resolve(e){Kt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Kt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const vi=new Yt(2e3,1e4);class bi extends yi{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,bi.currentPopupAction&&bi.currentPopupAction.cancel(),bi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ht(e,this.auth,"internal-error"),e}async onExecution(){Kt(1===this.filter.length,"Popup operations only handle one event");const e=Kr();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(zt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(zt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,bi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zt(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,vi.get())};e()}}bi.currentPopupAction=null;const wi=new Map;class xi extends yi{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=wi.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Ei(t),r=Ii(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}wi.set(this.auth._key(),e)}return this.bypassAuthState||wi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function _i(e,t){wi.set(e._key(),t)}function Ii(e){return An(e._redirectPersistence)}function Ei(e){return Rn("pendingRedirect",e.config.apiKey,e.name)}async function Si(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(yt(e.app))return Promise.reject(Bt(e));const r=Xn(e),i=di(r,t),s=new xi(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class ki{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ni(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ni(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(zt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ti(e))}saveEventToCache(e){this.cachedEventUids.add(Ti(e)),this.lastProcessedEventTime=Date.now()}}function Ti(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Ni(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const Ci=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ai=/^https?/;async function Di(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return on(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(Pi(r))return}catch(n){}Ut(e,"unauthorized-domain")}function Pi(e){const t=Gt(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Ai.test(n))return!1;if(Ci.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Ri=new Yt(3e4,6e4);function Oi(){const e=Qr().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Li(e){return new Promise((t,n)=>{var r,i,s;function o(){Oi(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Oi(),n(zt(e,"network-request-failed"))},timeout:Ri.get()})}if(null===(i=null===(r=Qr().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Qr().gapi)||void 0===s?void 0:s.load)){const t=er("iframefcb");return Qr()[t]=()=>{gapi.load?o():n(zt(e,"network-request-failed"))},Zn(`${Yn.gapiScript}?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw ji=null,e})}let ji=null;const Mi=new Yt(5e3,15e3),Fi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Vi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ui(e){const t=e.config;Ht(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Zt(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:wt},i=Vi.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${ee(r).slice(1)}`}async function zi(e){const t=await function(e){return ji=ji||Li(e),ji}(e),n=Qr().gapi;return Ht(n,e,"internal-error"),t.open({where:document.body,url:Ui(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Fi,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=zt(e,"network-request-failed"),s=Qr().setTimeout(()=>{r(i)},Mi.get());function o(){Qr().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})}))}const $i={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Bi{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function qi(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},$i),{width:r.toString(),height:i.toString(),top:s,left:o}),c=q().toLowerCase();n&&(a=Fn(c)?"_blank":n),jn(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`},"");if(function(){var e;return Bn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:q())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new Bi(null);const h=window.open(t||"",a,u);Ht(h,e,"popup-blocked");try{h.focus()}catch(d){}return new Bi(h)}const Hi="__/auth/handler",Wi="emulator/auth/handler",Ki=encodeURIComponent("fac");async function Gi(e,t,n,r,i,s){Ht(e.config.authDomain,e,"auth-domain-config-required"),Ht(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:wt,eventId:i};if(t instanceof _r){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Ir){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?`#${Ki}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Hi}`;return Zt(t,Wi)}(e)}?${ee(a).slice(1)}${c}`}const Qi="webStorageSupport";const Xi=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Hr,this._completeRedirectFn=Si,this._overrideRedirectResult=_i}async _openPopup(e,t,n,r){var i;Kt(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return qi(e,await Gi(e,t,n,Gt(),r),Kr())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Qr().location.href=e}(await Gi(e,t,n,Gt(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Kt(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await zi(e),n=new ki(e);return t.register("authEvent",t=>{Ht(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qi,{type:Qi},n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Qi];void 0!==i&&t(!!i),Ut(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Di(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Hn()||Mn()||Bn()}};var Ji="@firebase/auth",Yi="1.10.8";class Zi{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ht(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const es=M("authIdTokenMaxAge")||300;let ts=null;function ns(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_t();const t=gt(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=gt(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Y(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Ut(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Xi,persistence:[oi,Ur,Hr]}),r=M("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>es)return;const r=null===t||void 0===t?void 0:t.token;ts!==r&&(ts=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){se(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){se(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var i;const s=L("auth");return s&&lr(n,`http://${s}`),n}var rs;Yn={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=zt("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},rs="Browser",mt(new oe("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Ht(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:rs,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Wn(rs)},c=new Qn(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(An);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),mt(new oe("auth-internal",e=>(e=>new Zi(e))(Xn(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),It(Ji,Yi,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(rs)),It(Ji,Yi,"esm2017");var is,ss,os="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},as={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function s(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return d(o(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var a=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(a,a);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=y(n),r=y(r);var i=v(n,1),s=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var c=s.add(r);0>=c.l(e)&&(i=i.add(n),s=c),r=v(r,1),n=v(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(s=o(n)).j(t);h(c)||0<c.l(e);)c=(s=o(n-=r)).j(t);u(s)&&(s=l),i=i.add(s),e=f(e,c)}return new m(i,e)}function y(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],o=0;o<i;o++)s[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,s=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var o=i+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(c)&&0>e.l(c))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var l=this.i(i)>>>16,f=65535&this.i(i),m=e.i(s)>>>16,g=65535&e.i(s);n[2*i+2*s]+=f*g,p(n,2*i+2*s),n[2*i+2*s+1]+=l*g,p(n,2*i+2*s+1),n[2*i+2*s+1]+=f*m,p(n,2*i+2*s+1),n[2*i+2*s+2]+=l*m,p(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,ss=as.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=o(Math.pow(n,8)),i=a,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);8>l?(l=o(Math.pow(n,l)),i=i.j(l).add(o(c))):i=(i=i.j(r)).add(o(c))}return i},is=as.Integer=r}).apply("undefined"!==typeof os?os:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var ls,cs,us,hs,ds,fs,ps,ms,gs="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},ys={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof gs&&gs];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(e,t){return t})}});var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function d(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var y=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function v(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function _(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function I(e){i.setTimeout(()=>{throw e},0)}function E(){var e=C;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var S=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new k,e=>e.reset());class k{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let T,N=!1,C=new class{constructor(){this.h=this.g=null}add(e,t){const n=S.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},A=()=>{const e=i.Promise.resolve(void 0);T=()=>{e.then(D)}};var D=()=>{for(var e;e=E();){try{e.h.call(e.g)}catch(n){I(n)}var t=S;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}N=!1};function P(){this.s=this.s,this.C=this.C}function R(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}P.prototype.s=!1,P.prototype.ma=function(){this.s||(this.s=!0,this.N())},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},R.prototype.h=function(){this.defaultPrevented=!0};var O=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function L(e,t){if(R.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(y){e:{try{g(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:j[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}h(L,R);var j={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),F=0;function V(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++F,this.da=this.fa=!1}function U(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function z(e){this.src=e,this.g={},this.h=0}function $(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(U(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function B(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}z.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=B(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new V(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),H={};function W(e,t,n,r,i){if(r&&r.once)return G(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)W(e,t[s],n,r,i);return null}return n=te(n),e&&e[M]?e.K(t,n,o(r)?!!r.capture:!!r,i):K(e,t,n,!1,r,i)}function K(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var a=o(i)?!!i.capture:!!i,l=Z(e);if(l||(e[q]=l=new z(e)),(n=l.add(t,n,r,a,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Y;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)O||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(J(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function G(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)G(e,t[s],n,r,i);return null}return n=te(n),e&&e[M]?e.L(t,n,o(r)?!!r.capture:!!r,i):K(e,t,n,!0,r,i)}function Q(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=te(n),e&&e[M]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=B(s=e.g[t],n,r,i))&&(U(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=B(t,n,r,i)),(n=-1<e?t[e]:null)&&X(n))}function X(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[M])$(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(J(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?($(n,e),0==n.h&&(n.src=null,t[q]=null)):U(e)}}}function J(e){return e in H?H[e]:H[e]="on"+e}function Y(e,t){if(e.da)e=!0;else{t=new L(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&X(e),e=n.call(r,t)}return e}function Z(e){return(e=e[q])instanceof z?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){P.call(this),this.i=new z(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new R(t,e);else if(t instanceof R)t.target=t.target||e;else{var i=t;x(t=new R(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=ie(o,r,!0,t)&&i}if(i=ie(o=t.g=e,r,!0,t)&&i,i=ie(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ie(o=t.g=n[s],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.fa&&$(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function oe(e){e.g=se(()=>{e.g=null,e.i&&(e.i=!1,oe(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,P),ne.prototype[M]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)U(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ae extends P{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){P.call(this),this.h=e,this.g={}}h(le,P);var ce=[];function ue(e){v(e.g,function(e,t){this.g.hasOwnProperty(t)&&X(e)},e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=i.JSON.stringify,de=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ye={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){R.call(this,"d")}function be(){R.call(this,"c")}h(ve,R),h(be,R);var we={},xe=null;function _e(){return xe=xe||new ne}function Ie(e){R.call(this,we.La,e)}function Ee(e){const t=_e();re(t,new Ie(t))}function Se(e,t){R.call(this,we.STAT_EVENT,e),this.stat=t}function ke(e){const t=_e();re(t,new Se(t,e))}function Te(e,t){R.call(this,we.Ma,e),this.size=t}function Ne(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function Ce(){this.g=!0}function Ae(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return he(n)}catch(a){return t}}(e,n)+(r?" "+r:"")})}we.La="serverreachability",h(Ie,R),we.STAT_EVENT="statevent",h(Se,R),we.Ma="timingevent",h(Te,R),Ce.prototype.xa=function(){this.g=!1},Ce.prototype.info=function(){};var De,Pe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Re={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Oe(){}function Le(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new je}function je(){this.i=null,this.g="",this.h=!1}h(Oe,pe),Oe.prototype.g=function(){return new XMLHttpRequest},Oe.prototype.i=function(){return{}},De=new Oe;var Me={},Fe={};function Ve(e,t,n){e.L=1,e.v=ht(ot(t)),e.m=n,e.P=!0,Ue(e,null)}function Ue(e,t){e.F=Date.now(),Be(e),e.A=ot(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),St(n.i,"t",r),e.C=0,n=e.j.J,e.h=new je,e.g=fn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var s=0;s<i.length;s++){var o=W(n,i[s],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ee(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.u,e.A,e.l,e.R,e.m)}function ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function $e(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fe:(n=Number(t.substring(n,r)),isNaN(n)?Me:(r+=1)+n>t.length?Fe:(t=t.slice(r,r+n),e.C=r+n,t))}function Be(e){e.S=Date.now()+e.I,qe(e,e.I)}function qe(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ne(c(e.ba,e),t)}function He(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function We(e){0==e.j.G||e.J||ln(e.j,e)}function Ke(e){He(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ge(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;an(n),Xt(n)}rn(n),ke(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ne(c(n.Za,n),6e3));if(1>=Ye(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((e.K||n.g==e)&&an(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((r=n).qa=dn(r,r.J?r.ia:null,r.W),o.K){tt(r.h,o);var a=o,l=r.L;l&&(a.I=l),a.B&&(He(a),Be(a)),r.g=o}else nn(r);0<n.i.length&&Yt(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ee()}catch(u){}}Le.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Ht(e)?t.j():this.Y(e)},Le.prototype.Y=function(e){try{if(e==this.g)e:{const d=Ht(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||Wt(this.g)))){this.J||4!=d||7==t||Ee(),He(this);var n=this.g.Z();this.X=n;t:if(ze(this)){var r=Wt(this.g);e="";var s=r.length,o=4==Ht(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),We(this);var a="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(o&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,ke(12),Ke(this),We(this);break e}Ae(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ge(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=$e(this,a),e==Fe){4==d&&(this.s=4,ke(14),n=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}if(e==Me){this.s=4,ke(15),Ae(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Ae(this.i,this.l,e,null),Ge(this,e)}if(ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=a.length||this.h.h||(this.s=1,ke(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),sn(h),h.M=!0,ke(11))}}else Ae(this.i,this.l,a,"[Invalid Chunked Response]"),Ke(this),We(this)}else Ae(this.i,this.l,a,null),Ge(this,a);4==d&&Ke(this),this.o&&!this.J&&(4==d?ln(this.j,this):(this.o=!1,Be(this)))}else(function(e){const t={};e=(e.g&&2<=Ht(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=_(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,ke(12)):(this.s=0,ke(13)),Ke(this),We(this)}}}catch(d){}},Le.prototype.cancel=function(){this.J=!0,Ke(this)},Le.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Ee(),ke(17)),Ke(this),this.s=2,We(this)):qe(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Xe(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Je(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ye(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return d(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}Xe.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new xt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,at(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),lt(this,t[4]),this.l=dt(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new xt(null,this.h))}function ot(e){return new st(e)}function at(e,t,n){e.j=n?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof xt?(e.i=t,function(e,t){t&&!e.j&&(_t(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(It(this,t),St(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,bt)),e.i=new xt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function ht(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?vt:yt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,yt=/[#\?:]/g,vt=/[#\?]/g,bt=/[#\?@]/g,wt=/#/g;function xt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function _t(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function It(e,t){_t(e),t=kt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Et(e,t){return _t(e),t=kt(e,t),e.g.has(t)}function St(e,t,n){It(e,t),0<n.length&&(e.i=null,e.g.set(kt(e,t),d(n)),e.h+=n.length)}function kt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Tt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function Nt(){this.g=new fe}function Ct(e,t,n){const r=n||"";try{rt(e,function(e,n){let i=e;o(e)&&(i=he(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function At(e){this.l=e.Ub||null,this.j=e.eb||!1}function Dt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Pt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Rt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Ot(e)}function Ot(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Lt(e){let t="";return v(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function jt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Lt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Mt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=xt.prototype).add=function(e,t){_t(this),this.i=null,e=kt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){_t(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){_t(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){_t(this);let t=[];if("string"===typeof e)Et(this,e)&&(t=t.concat(this.g.get(kt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return _t(this),this.i=null,Et(this,e=kt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")},h(At,pe),At.prototype.g=function(){return new Dt(this.l,this.j)},At.prototype.i=(mt={},function(){return mt}),h(Dt,ne),(e=Dt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Ot(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Rt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ot(this)),this.g&&(this.readyState=3,Ot(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Pt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Rt(this):Ot(this),3==this.readyState&&Pt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Rt(this))},e.Qa=function(e){this.g&&(this.response=e,Rt(this))},e.ga=function(){this.g&&Rt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Dt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Mt,ne);var Ft=/^https?$/i,Vt=["POST","PUT"];function Ut(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,zt(e),Bt(e)}function zt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function $t(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=Ht(e)||2!=e.Z()))if(e.u&&4==Ht(e))se(e.Ea,0,e);else if(re(e,"readystatechange"),4==Ht(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var o=String(e.D).match(it)[1]||null;!o&&i.self&&i.self.location&&(o=i.self.location.protocol.slice(0,-1)),s=!Ft.test(o?o.toLowerCase():"")}n=s}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var a=2<Ht(e)?e.g.statusText:""}catch(l){a=""}e.l=a+" ["+e.Z()+"]",zt(e)}}finally{Bt(e)}}}function Bt(e,t){if(e.g){qt(e);const r=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function qt(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function Ht(e){return e.g?e.g.readyState:0}function Wt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Kt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Gt(e){this.Aa=0,this.i=[],this.j=new Ce,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kt("baseRetryDelayMs",5e3,e),this.cb=Kt("retryDelaySeedMs",1e4,e),this.Wa=Kt("forwardChannelMaxRetries",2,e),this.wa=Kt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Xe(e&&e.concurrentRequestLimit),this.Da=new Nt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Jt(e),3==e.G){var t=e.U++,n=ot(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),en(e,n),(t=new Le(e,e.j,t)).L=2,t.v=ht(ot(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=fn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Be(t)}hn(e)}function Xt(e){e.g&&(sn(e),e.g.cancel(),e.g=null)}function Jt(e){Xt(e),e.u&&(i.clearTimeout(e.u),e.u=null),an(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function Yt(e){if(!Je(e.h)&&!e.s){e.s=!0;var t=e.Ga;T||A(),N||(T(),N=!0),C.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const r=ot(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),en(e,r),e.m&&e.o&&jt(r,e.m,e.o),n=new Le(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ve(n,r,t)}function en(e,t){e.H&&v(e.H,function(e,n){ut(t,n,e)}),e.l&&rt({},function(e,n){ut(t,n,e)})}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let a=0;a<n;a++){let n=i[a].g;const l=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),o=!1;else try{Ct(l,e,"req"+n+"_")}catch(s){r&&r(l)}}if(o){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;T||A(),N||(T(),N=!0),C.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ne(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function sn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function on(e){e.g=new Le(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=ot(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&jt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ht(ot(t)),n.m=null,n.P=!0,Ue(n,e)}function an(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){an(e),sn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=_e(),new Te(r,n)),Yt(e)}else nn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Ye(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ne(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:un(e,5);break;case 4:un(e,10);break;case 3:un(e,6);break;default:un(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function un(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new st(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||at(r,"https"),ht(r),t?function(e,t){const n=new Ce;if(i.Image){const r=new Image;r.onload=u(Tt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Tt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Tt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Tt,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ce;const n=new AbortController,r=setTimeout(()=>{n.abort(),Tt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Tt(0,0,!0,t):Tt(0,0,!1,t)}).catch(()=>{clearTimeout(r),Tt(0,0,!1,t)})}(r.toString(),n)}else ke(2);e.G=0,e.l&&e.l.sa(t),hn(e),Jt(e)}function hn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function dn(e,t,n){var r=n instanceof st?ot(n):new st(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new st(null);r&&at(o,r),t&&(o.g=t),s&&lt(o,s),n&&(o.l=n),r=o}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),en(e,r),r}function fn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Mt(new At({eb:n})):new Mt(e.pa)).Ha(e.J),t}function pn(){}function mn(){}function gn(e,t){ne.call(this),this.g=new Gt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new bn(this)}function yn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vn(){be.call(this),this.status=1}function bn(e){this.g=e}(e=Mt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():De.g(),this.v=this.o?me(this.o):me(De),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void Ut(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Vt,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qt(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){Ut(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),Bt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Bt(this,!0)),Mt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?$t(this):this.bb())},e.bb=function(){$t(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Ht(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Gt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){ke(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=dn(this,null,this.W),Yt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Le(this,this.j,e);let s=this.o;if(this.S&&(s?(s=b(s),x(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,i,t),ut(n=ot(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),en(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Lt(s)))+"&"+t:this.m&&jt(n,this.m,s)),et(this.h,i),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),i.T=!0,Ve(i,n,null)):Ve(i,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Je(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,on(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ne(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ke(10),Xt(this),on(this))},e.Za=function(){null!=this.C&&(this.C=null,Xt(this),rn(this),ke(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),ke(2)):(this.j.info("Failed to ping google.com"),ke(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=pn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},mn.prototype.g=function(e,t){return new gn(e,t)},h(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Qt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Yt(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,gn.aa.N.call(this)},h(yn,ve),h(vn,be),h(bn,pn),bn.prototype.ua=function(){re(this.g,"a")},bn.prototype.ta=function(e){re(this.g,new yn(e))},bn.prototype.sa=function(e){re(this.g,new vn)},bn.prototype.ra=function(){re(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,ms=ys.createWebChannelTransport=function(){return new mn},ps=ys.getStatEventTarget=function(){return _e()},fs=ys.Event=we,ds=ys.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pe.NO_ERROR=0,Pe.TIMEOUT=8,Pe.HTTP_ERROR=6,hs=ys.ErrorCode=Pe,Re.COMPLETE="complete",us=ys.EventType=Re,ge.EventType=ye,ye.OPEN="a",ye.CLOSE="b",ye.ERROR="c",ye.MESSAGE="d",ne.prototype.listen=ne.prototype.K,cs=ys.WebChannel=ge,ys.FetchXmlHttpFactory=At,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,ls=ys.XhrIo=Mt}).apply("undefined"!==typeof gs?gs:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const vs="@firebase/firestore",bs="4.8.0";class ws{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ws.UNAUTHENTICATED=new ws(null),ws.GOOGLE_CREDENTIALS=new ws("google-credentials-uid"),ws.FIRST_PARTY=new ws("first-party-uid"),ws.MOCK_USER=new ws("mock-user");let xs="11.10.0";const _s=new ge("@firebase/firestore");function Is(){return _s.logLevel}function Es(e){if(_s.logLevel<=he.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ts);_s.debug(`Firestore (${xs}): ${e}`,...i)}}function Ss(e){if(_s.logLevel<=he.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ts);_s.error(`Firestore (${xs}): ${e}`,...i)}}function ks(e){if(_s.logLevel<=he.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ts);_s.warn(`Firestore (${xs}): ${e}`,...i)}}function Ts(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Ns(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,Cs(e,r,n)}function Cs(e,t,n){let r=`FIRESTORE (${xs}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw Ss(r),new Error(r)}function As(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||Cs(t,i,r)}function Ds(e,t){return e}const Ps={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Rs extends Q{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Os{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Ls{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class js{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ws.UNAUTHENTICATED))}shutdown(){}}class Ms{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Fs{constructor(e){this.t=e,this.currentUser=ws.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){As(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Os;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Os,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{Es("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Es("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Os)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Es("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(As("string"==typeof t.accessToken,31837,{l:t}),new Ls(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return As(null===e||"string"==typeof e,2055,{h:e}),new ws(e)}}class Vs{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=ws.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Us{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new Vs(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ws.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class zs{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $s{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,yt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){As(void 0===this.o,3512);const n=e=>{null!=e.error&&Es("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,Es("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{Es("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):Es("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new zs(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(As("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new zs(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Bs(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}function qs(){return new TextEncoder}class Hs{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Bs(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Ws(e,t){return e<t?-1:e>t?1:0}function Ks(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return Ws(r,i);{const s=qs(),o=Qs(s.encode(Gs(e,n)),s.encode(Gs(t,n)));return 0!==o?o:Ws(r,i)}}n+=r>65535?2:1}return Ws(e.length,t.length)}function Gs(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function Qs(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return Ws(e[n],t[n]);return Ws(e.length,t.length)}function Xs(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}function Js(e){return e+"\0"}const Ys="__name__";class Zs{constructor(e,t,n){void 0===t?t=0:t>e.length&&Ns(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&Ns(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Zs.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Zs?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=Zs.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Ws(e.length,t.length)}static compareSegments(e,t){const n=Zs.isNumericId(e),r=Zs.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Zs.extractNumericId(e).compare(Zs.extractNumericId(t)):Ks(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return is.fromString(e.substring(4,e.length-2))}}class eo extends Zs{construct(e,t,n){return new eo(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Rs(Ps.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(e=>e.length>0))}return new eo(e)}static emptyPath(){return new eo([])}}const to=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class no extends Zs{construct(e,t,n){return new no(e,t,n)}static isValidIdentifier(e){return to.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),no.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Ys}static keyField(){return new no([Ys])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Rs(Ps.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Rs(Ps.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Rs(Ps.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Rs(Ps.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new no(t)}static emptyPath(){return new no([])}}class ro{constructor(e){this.path=e}static fromPath(e){return new ro(eo.fromString(e))}static fromName(e){return new ro(eo.fromString(e).popFirst(5))}static empty(){return new ro(eo.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===eo.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return eo.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ro(new eo(e.slice()))}}function io(e,t,n){if(!n)throw new Rs(Ps.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function so(e){if(!ro.isDocumentKey(e))throw new Rs(Ps.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function oo(e){if(ro.isDocumentKey(e))throw new Rs(Ps.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function ao(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function lo(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Ns(12329,{type:typeof e})}function co(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Rs(Ps.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=lo(e);throw new Rs(Ps.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function uo(e,t){if(t<=0)throw new Rs(Ps.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}function ho(e,t){const n={typeString:e};return t&&(n.value=t),n}function fo(e,t){if(!ao(e))throw new Rs(Ps.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(void 0!==s&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new Rs(Ps.INVALID_ARGUMENT,n);return!0}const po=-62135596800,mo=1e6;class go{static now(){return go.fromMillis(Date.now())}static fromDate(e){return go.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*mo);return new go(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Rs(Ps.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Rs(Ps.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<po)throw new Rs(Ps.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Rs(Ps.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/mo}_compareTo(e){return this.seconds===e.seconds?Ws(this.nanoseconds,e.nanoseconds):Ws(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:go._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(fo(e,go._jsonSchema))return new go(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-po;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}go._jsonSchemaVersion="firestore/timestamp/1.0",go._jsonSchema={type:ho("string",go._jsonSchemaVersion),seconds:ho("number"),nanoseconds:ho("number")};class yo{static fromTimestamp(e){return new yo(e)}static min(){return new yo(new go(0,0))}static max(){return new yo(new go(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const vo=-1;class bo{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function wo(e){return e.fields.find(e=>2===e.kind)}function xo(e){return e.fields.filter(e=>2!==e.kind)}bo.UNKNOWN_ID=-1;class _o{constructor(e,t){this.fieldPath=e,this.kind=t}}class Io{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Io(0,ko.min())}}function Eo(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=yo.fromTimestamp(1e9===r?new go(n+1,0):new go(n,r));return new ko(i,ro.empty(),t)}function So(e){return new ko(e.readTime,e.key,vo)}class ko{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ko(yo.min(),ro.empty(),vo)}static max(){return new ko(yo.max(),ro.empty(),vo)}}function To(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ro.comparator(e.documentKey,t.documentKey),0!==n?n:Ws(e.largestBatchId,t.largestBatchId))}const No="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Co{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Ao(e){if(e.code!==Ps.FAILED_PRECONDITION||e.message!==No)throw e;Es("LocalStore","Unexpectedly lost primary lease")}class Do{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ns(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Do((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Do?t:Do.resolve(t)}catch(e){return Do.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Do.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Do.reject(t)}static resolve(e){return new Do((t,n)=>{t(e)})}static reject(e){return new Do((t,n)=>{n(e)})}static waitFor(e){return new Do((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=Do.resolve(!1);for(const n of e)t=t.next(e=>e?Do.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Do((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Do((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}const Po="SimpleDb";class Ro{static open(e,t,n,r){try{return new Ro(t,e.transaction(r,n))}catch(e){throw new Mo(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Os,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Mo(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{const n=$o(t.target.error);this.S.reject(new Mo(e,n))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Es(Po,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Vo(t)}}class Oo{static delete(e){return Es(Po,"Removing database:",e),Uo(R().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!G())return!1;if(Oo.F())return!0;const e=q(),t=Oo.M(e),n=0<t&&t<10,r=Lo(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static F(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.O)}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.B=n,this.L=null,12.2===Oo.M(q())&&Ss("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Es(Po,"Opening database:",this.name),this.db=await new Promise((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Mo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Rs(Ps.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Rs(Ps.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Mo(e,r))},r.onupgradeneeded=e=>{Es(Po,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;if(null!==this.L&&this.L!==e.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${e.oldVersion}, event.newVersion=${e.newVersion}, db.version=${t.version}`);this.B.q(t,r.transaction,e.oldVersion,this.version).next(()=>{Es(Po,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",e=>{const t=e.target;this.L=t.version},{passive:!0})),this.db.addEventListener("versionchange",e=>{var t;null===e.newVersion&&(ks('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),null===(t=this.databaseDeletedListener)||void 0===t||t.call(this))},{passive:!0}),this.db}setDatabaseDeletedListener(e){if(this.databaseDeletedListener)throw new Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=e}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.k(e);const t=Ro.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next(e=>(t.v(),e)).catch(e=>(t.abort(e),Do.reject(e))).toPromise();return s.catch(()=>{}),await t.D,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(Es(Po,"Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Lo(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class jo{constructor(e){this.$=e,this.U=!1,this.K=null}get isDone(){return this.U}get W(){return this.K}set cursor(e){this.$=e}done(){this.U=!0}G(e){this.K=e}delete(){return Uo(this.$.delete())}}class Mo extends Rs{constructor(e,t){super(Ps.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Fo(e){return"IndexedDbTransactionError"===e.name}class Vo{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(Es(Po,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(Es(Po,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Uo(n)}add(e){return Es(Po,"ADD",this.store.name,e,e),Uo(this.store.add(e))}get(e){return Uo(this.store.get(e)).next(t=>(void 0===t&&(t=null),Es(Po,"GET",this.store.name,e,t),t))}delete(e){return Es(Po,"DELETE",this.store.name,e),Uo(this.store.delete(e))}count(){return Es(Po,"COUNT",this.store.name),Uo(this.store.count())}j(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new Do((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{const e=this.cursor(n),t=[];return this.J(e,(e,n)=>{t.push(n)}).next(()=>t)}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Do((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}})}Y(e,t){Es(Po,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Z=!1;const r=this.cursor(n);return this.J(r,(e,t,n)=>n.delete())}X(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.J(r,t)}ee(e){const t=this.cursor({});return new Do((n,r)=>{t.onerror=e=>{const t=$o(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()}})}J(e,t){const n=[];return new Do((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new jo(i),o=t(i.primaryKey,i.value,s);if(o instanceof Do){const e=o.catch(e=>(s.done(),Do.reject(e)));n.push(e)}s.isDone?r():null===s.W?i.continue():i.continue(s.W)}}).next(()=>Do.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Z?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Uo(e){return new Do((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=$o(e.target.error);n(t)}})}let zo=!1;function $o(e){const t=Oo.M(q());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Rs("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return zo||(zo=!0,setTimeout(()=>{throw e},0)),e}}return e}const Bo="IndexBackfiller";class qo{constructor(e,t){this.asyncQueue=e,this.te=t,this.task=null}start(){this.ne(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ne(e){Es(Bo,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const e=await this.te.re();Es(Bo,`Documents written: ${e}`)}catch(e){Fo(e)?Es(Bo,"Ignoring IndexedDB error during index backfill: ",e):await Ao(e)}await this.ne(6e4)})}}class Ho{constructor(e,t){this.localStore=e,this.persistence=t}async re(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ie(t,e))}ie(e,t){const n=new Set;let r=t,i=!0;return Do.doWhile(()=>!0===i&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!n.has(t))return Es(Bo,`Processing collection: ${t}`),this.se(e,t,r).next(e=>{r-=e,n.add(t)});i=!1})).next(()=>t-r)}se(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.oe(r,n)).next(n=>(Es(Bo,`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>i.size)}))}oe(e,t){let n=e;return t.changes.forEach((e,t)=>{const r=So(t);To(r,n)>0&&(n=r)}),new ko(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Wo{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this._e(e),this.ae=e=>t.writeSequenceNumber(e))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Wo.ue=-1;const Ko=-1;function Go(e){return null==e}function Qo(e){return 0===e&&1/e==-1/0}function Xo(e){return"number"==typeof e&&Number.isInteger(e)&&!Qo(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Jo="\x01";function Yo(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=ea(t)),t=Zo(e.get(n),t);return ea(t)}function Zo(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case Jo:n+="\x01\x11";break;default:n+=t}}return n}function ea(e){return e+Jo+"\x01"}function ta(e){const t=e.length;if(As(t>=2,64408,{path:e}),2===t)return As(e.charAt(0)===Jo&&"\x01"===e.charAt(1),56145,{path:e}),eo.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf(Jo,s);switch((t<0||t>n)&&Ns(50515,{path:e}),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:Ns(61167,{path:e})}s=t+2}return new eo(r)}const na="remoteDocuments",ra="owner",ia="owner",sa="mutationQueues",oa="mutations",aa="batchId",la="userMutationsIndex",ca=["userId","batchId"];function ua(e,t){return[e,Yo(t)]}function ha(e,t,n){return[e,Yo(t),n]}const da={},fa="documentMutations",pa="remoteDocumentsV14",ma=["prefixPath","collectionGroup","readTime","documentId"],ga="documentKeyIndex",ya=["prefixPath","collectionGroup","documentId"],va="collectionGroupIndex",ba=["collectionGroup","readTime","prefixPath","documentId"],wa="remoteDocumentGlobal",xa="remoteDocumentGlobalKey",_a="targets",Ia="queryTargetsIndex",Ea=["canonicalId","targetId"],Sa="targetDocuments",ka=["targetId","path"],Ta="documentTargetsIndex",Na=["path","targetId"],Ca="targetGlobalKey",Aa="targetGlobal",Da="collectionParents",Pa=["collectionId","parent"],Ra="clientMetadata",Oa="bundles",La="namedQueries",ja="indexConfiguration",Ma="collectionGroupIndex",Fa="indexState",Va=["indexId","uid"],Ua="sequenceNumberIndex",za=["uid","sequenceNumber"],$a="indexEntries",Ba=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],qa="documentKeyIndex",Ha=["indexId","uid","orderedDocumentKey"],Wa="documentOverlays",Ka=["userId","collectionPath","documentId"],Ga="collectionPathOverlayIndex",Qa=["userId","collectionPath","largestBatchId"],Xa="collectionGroupOverlayIndex",Ja=["userId","collectionGroup","largestBatchId"],Ya="globals",Za=[sa,oa,fa,na,_a,ra,Aa,Sa,Ra,wa,Da,Oa,La],el=[...Za,Wa],tl=[sa,oa,fa,pa,_a,ra,Aa,Sa,Ra,wa,Da,Oa,La,Wa],nl=tl,rl=[...nl,ja,Fa,$a],il=rl,sl=[...rl,Ya],ol=sl;class al extends Co{constructor(e,t){super(),this.ce=e,this.currentSequenceNumber=t}}function ll(e,t){const n=Ds(e);return Oo.N(n.ce,t)}function cl(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ul(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function hl(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class dl{constructor(e,t){this.comparator=e,this.root=t||pl.EMPTY}insert(e,t){return new dl(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pl.BLACK,null,null))}remove(e){return new dl(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pl.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fl(this.root,e,this.comparator,!1)}getReverseIterator(){return new fl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fl(this.root,e,this.comparator,!0)}}class fl{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pl{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:pl.RED,this.left=null!=r?r:pl.EMPTY,this.right=null!=i?i:pl.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new pl(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return pl.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return pl.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pl.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pl.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ns(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ns(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ns(27949);return e+(this.isRed()?0:1)}}pl.EMPTY=null,pl.RED=!0,pl.BLACK=!1,pl.EMPTY=new class{constructor(){this.size=0}get key(){throw Ns(57766)}get value(){throw Ns(16141)}get color(){throw Ns(16727)}get left(){throw Ns(29726)}get right(){throw Ns(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new pl(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ml{constructor(e){this.comparator=e,this.data=new dl(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new gl(this.data.getIterator())}getIteratorFrom(e){return new gl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof ml))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ml(this.comparator);return t.data=e,t}}class gl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function yl(e){return e.hasNext()?e.getNext():void 0}class vl{constructor(e){this.fields=e,e.sort(no.comparator)}static empty(){return new vl([])}unionWith(e){let t=new ml(no.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new vl(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xs(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class bl extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class wl{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new bl("Invalid base64 string: "+e):e}}(e);return new wl(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new wl(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ws(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}wl.EMPTY_BYTE_STRING=new wl("");const xl=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _l(e){if(As(!!e,39018),"string"==typeof e){let t=0;const n=xl.exec(e);if(As(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Il(e.seconds),nanos:Il(e.nanos)}}function Il(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function El(e){return"string"==typeof e?wl.fromBase64String(e):wl.fromUint8Array(e)}const Sl="server_timestamp",kl="__type__",Tl="__previous_value__",Nl="__local_write_time__";function Cl(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[kl])||void 0===n?void 0:n.stringValue)===Sl}function Al(e){const t=e.mapValue.fields[Tl];return Cl(t)?Al(t):t}function Dl(e){const t=_l(e.mapValue.fields[Nl].timestampValue);return new go(t.seconds,t.nanos)}class Pl{constructor(e,t,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l,this.isUsingEmulator=c}}const Rl="(default)";class Ol{constructor(e,t){this.projectId=e,this.database=t||Rl}static empty(){return new Ol("","")}get isDefaultDatabase(){return this.database===Rl}isEqual(e){return e instanceof Ol&&e.projectId===this.projectId&&e.database===this.database}}const Ll="__type__",jl="__max__",Ml={mapValue:{fields:{__type__:{stringValue:jl}}}},Fl="__vector__",Vl="value",Ul={nullValue:"NULL_VALUE"};function zl(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Cl(e)?4:ic(e)?9007199254740991:nc(e)?10:11:Ns(28295,{value:e})}function $l(e,t){if(e===t)return!0;const n=zl(e);if(n!==zl(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Dl(e).isEqual(Dl(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=_l(e.timestampValue),r=_l(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return El(e.bytesValue).isEqual(El(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Il(e.geoPointValue.latitude)===Il(t.geoPointValue.latitude)&&Il(e.geoPointValue.longitude)===Il(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Il(e.integerValue)===Il(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Il(e.doubleValue),r=Il(t.doubleValue);return n===r?Qo(n)===Qo(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Xs(e.arrayValue.values||[],t.arrayValue.values||[],$l);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(cl(n)!==cl(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!$l(n[i],r[i])))return!1;return!0}(e,t);default:return Ns(52216,{left:e})}}function Bl(e,t){return void 0!==(e.values||[]).find(e=>$l(e,t))}function ql(e,t){if(e===t)return 0;const n=zl(e),r=zl(t);if(n!==r)return Ws(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ws(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Il(e.integerValue||e.doubleValue),r=Il(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Hl(e.timestampValue,t.timestampValue);case 4:return Hl(Dl(e),Dl(t));case 5:return Ks(e.stringValue,t.stringValue);case 6:return function(e,t){const n=El(e),r=El(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=Ws(n[i],r[i]);if(0!==e)return e}return Ws(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Ws(Il(e.latitude),Il(t.latitude));return 0!==n?n:Ws(Il(e.longitude),Il(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Wl(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o[Vl])||void 0===n?void 0:n.arrayValue,c=null===(r=a[Vl])||void 0===r?void 0:r.arrayValue,u=Ws((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:Wl(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Ml.mapValue&&t===Ml.mapValue)return 0;if(e===Ml.mapValue)return 1;if(t===Ml.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=Ks(r[o],s[o]);if(0!==e)return e;const t=ql(n[r[o]],i[s[o]]);if(0!==t)return t}return Ws(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Ns(23264,{le:n})}}function Hl(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Ws(e,t);const n=_l(e),r=_l(t),i=Ws(n.seconds,r.seconds);return 0!==i?i:Ws(n.nanos,r.nanos)}function Wl(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=ql(n[i],r[i]);if(e)return e}return Ws(n.length,r.length)}function Kl(e){return Gl(e)}function Gl(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=_l(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return El(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return ro.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Gl(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Gl(e.fields[i])}`;return n+"}"}(e.mapValue):Ns(61005,{value:e})}function Ql(e){switch(zl(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Al(e);return t?16+Ql(t):16;case 5:return 2*e.stringValue.length;case 6:return El(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Ql(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return ul(e.fields,(e,n)=>{t+=e.length+Ql(n)}),t}(e.mapValue);default:throw Ns(13486,{value:e})}}function Xl(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Jl(e){return!!e&&"integerValue"in e}function Yl(e){return!!e&&"arrayValue"in e}function Zl(e){return!!e&&"nullValue"in e}function ec(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function tc(e){return!!e&&"mapValue"in e}function nc(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[Ll])||void 0===n?void 0:n.stringValue)===Fl}function rc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ul(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=rc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=rc(e.arrayValue.values[n]);return t}return Object.assign({},e)}function ic(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===jl}const sc={mapValue:{fields:{[Ll]:{stringValue:Fl},[Vl]:{arrayValue:{}}}}};function oc(e){return"nullValue"in e?Ul:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Xl(Ol.empty(),ro.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?nc(e)?sc:{mapValue:{}}:Ns(35942,{value:e})}function ac(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Xl(Ol.empty(),ro.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?sc:"mapValue"in e?nc(e)?{mapValue:{}}:Ml:Ns(61959,{value:e})}function lc(e,t){const n=ql(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function cc(e,t){const n=ql(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class uc{constructor(e){this.value=e}static empty(){return new uc({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!tc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rc(t)}setAll(e){let t=no.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=rc(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());tc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $l(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];tc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ul(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new uc(rc(this.value))}}function hc(e){const t=[];return ul(e.fields,(e,n)=>{const r=new no([e]);if(tc(n)){const e=hc(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new vl(t)}class dc{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new dc(e,0,yo.min(),yo.min(),yo.min(),uc.empty(),0)}static newFoundDocument(e,t,n,r){return new dc(e,1,t,yo.min(),n,r,0)}static newNoDocument(e,t){return new dc(e,2,t,yo.min(),yo.min(),uc.empty(),0)}static newUnknownDocument(e,t){return new dc(e,3,t,yo.min(),yo.min(),uc.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(yo.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=uc.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=uc.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=yo.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof dc&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dc(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class fc{constructor(e,t){this.position=e,this.inclusive=t}}function pc(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?ro.comparator(ro.fromName(o.referenceValue),n.key):ql(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function mc(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!$l(e.position[n],t.position[n]))return!1;return!0}class gc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function yc(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class vc{}class bc extends vc{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Cc(e,t,n):"array-contains"===t?new Rc(e,n):"in"===t?new Oc(e,n):"not-in"===t?new Lc(e,n):"array-contains-any"===t?new jc(e,n):new bc(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Ac(e,n):new Dc(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(ql(t,this.value)):null!==t&&zl(this.value)===zl(t)&&this.matchesComparison(ql(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ns(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class wc extends vc{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new wc(e,t)}matches(e){return xc(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.he||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function xc(e){return"and"===e.op}function _c(e){return"or"===e.op}function Ic(e){return Ec(e)&&xc(e)}function Ec(e){for(const t of e.filters)if(t instanceof wc)return!1;return!0}function Sc(e){if(e instanceof bc)return e.field.canonicalString()+e.op.toString()+Kl(e.value);if(Ic(e))return e.filters.map(e=>Sc(e)).join(",");{const t=e.filters.map(e=>Sc(e)).join(",");return`${e.op}(${t})`}}function kc(e,t){return e instanceof bc?function(e,t){return t instanceof bc&&e.op===t.op&&e.field.isEqual(t.field)&&$l(e.value,t.value)}(e,t):e instanceof wc?function(e,t){return t instanceof wc&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&kc(n,t.filters[r]),!0)}(e,t):void Ns(19439)}function Tc(e,t){const n=e.filters.concat(t);return wc.create(n,e.op)}function Nc(e){return e instanceof bc?function(e){return`${e.field.canonicalString()} ${e.op} ${Kl(e.value)}`}(e):e instanceof wc?function(e){return e.op.toString()+" {"+e.getFilters().map(Nc).join(" ,")+"}"}(e):"Filter"}class Cc extends bc{constructor(e,t,n){super(e,t,n),this.key=ro.fromName(n.referenceValue)}matches(e){const t=ro.comparator(e.key,this.key);return this.matchesComparison(t)}}class Ac extends bc{constructor(e,t){super(e,"in",t),this.keys=Pc("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Dc extends bc{constructor(e,t){super(e,"not-in",t),this.keys=Pc("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Pc(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>ro.fromName(e.referenceValue))}class Rc extends bc{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Yl(t)&&Bl(t.arrayValue,this.value)}}class Oc extends bc{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Bl(this.value.arrayValue,t)}}class Lc extends bc{constructor(e,t){super(e,"not-in",t)}matches(e){if(Bl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Bl(this.value.arrayValue,t)}}class jc extends bc{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Yl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Bl(this.value.arrayValue,e))}}class Mc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Pe=null}}function Fc(e){return new Mc(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Vc(e){const t=Ds(e);if(null===t.Pe){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Sc(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Go(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Kl(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Kl(e)).join(",")),t.Pe=e}return t.Pe}function Uc(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!yc(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!kc(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!mc(e.startAt,t.startAt)&&mc(e.endAt,t.endAt)}function zc(e){return ro.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function $c(e,t){return e.filters.filter(e=>e instanceof bc&&e.field.isEqual(t))}function Bc(e,t,n){let r=Ul,i=!0;for(const s of $c(e,t)){let e=Ul,t=!0;switch(s.op){case"<":case"<=":e=oc(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=Ul}lc({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];lc({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function qc(e,t,n){let r=Ml,i=!0;for(const s of $c(e,t)){let e=Ml,t=!0;switch(s.op){case">=":case">":e=ac(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=Ml}cc({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];cc({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class Hc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function Wc(e,t,n,r,i,s,o,a){return new Hc(e,t,n,r,i,s,o,a)}function Kc(e){return new Hc(e)}function Gc(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Qc(e){return null!==e.collectionGroup}function Xc(e){const t=Ds(e);if(null===t.Te){t.Te=[];const e=new Set;for(const i of t.explicitOrderBy)t.Te.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new ml(no.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Te.push(new gc(r,n))}),e.has(no.keyField().canonicalString())||t.Te.push(new gc(no.keyField(),n))}return t.Te}function Jc(e){const t=Ds(e);return t.Ie||(t.Ie=Yc(t,Xc(e))),t.Ie}function Yc(e,t){if("F"===e.limitType)return Fc(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new gc(e.field,t)});const n=e.endAt?new fc(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new fc(e.startAt.position,e.startAt.inclusive):null;return Fc(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Zc(e,t){const n=e.filters.concat([t]);return new Hc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function eu(e,t,n){return new Hc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function tu(e,t){return Uc(Jc(e),Jc(t))&&e.limitType===t.limitType}function nu(e){return`${Vc(Jc(e))}|lt:${e.limitType}`}function ru(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>Nc(e)).join(", ")}]`),Go(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Kl(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Kl(e)).join(",")),`Target(${t})`}(Jc(e))}; limitType=${e.limitType})`}function iu(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ro.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Xc(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=pc(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Xc(e),t))&&!(e.endAt&&!function(e,t,n){const r=pc(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Xc(e),t))}(e,t)}function su(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ou(e){return(t,n)=>{let r=!1;for(const i of Xc(e)){const e=au(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function au(e,t,n){const r=e.field.isKeyField()?ro.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?ql(r,i):Ns(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Ns(19790,{direction:e.dir})}}class lu{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ul(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return hl(this.inner)}size(){return this.innerSize}}const cu=new dl(ro.comparator);function uu(){return cu}const hu=new dl(ro.comparator);function du(){let e=hu;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function fu(e){let t=hu;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function pu(){return gu()}function mu(){return gu()}function gu(){return new lu(e=>e.toString(),(e,t)=>e.isEqual(t))}const yu=new dl(ro.comparator),vu=new ml(ro.comparator);function bu(){let e=vu;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const wu=new ml(Ws);function xu(){return wu}function _u(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qo(t)?"-0":t}}function Iu(e){return{integerValue:""+e}}function Eu(e,t){return Xo(t)?Iu(t):_u(e,t)}class Su{constructor(){this._=void 0}}function ku(e,t,n){return e instanceof Cu?function(e,t){const n={fields:{[kl]:{stringValue:Sl},[Nl]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Cl(t)&&(t=Al(t)),t&&(n.fields[Tl]=t),{mapValue:n}}(n,t):e instanceof Au?Du(e,t):e instanceof Pu?Ru(e,t):function(e,t){const n=Nu(e,t),r=Lu(n)+Lu(e.Ee);return Jl(n)&&Jl(e.Ee)?Iu(r):_u(e.serializer,r)}(e,t)}function Tu(e,t,n){return e instanceof Au?Du(e,t):e instanceof Pu?Ru(e,t):n}function Nu(e,t){return e instanceof Ou?function(e){return Jl(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Cu extends Su{}class Au extends Su{constructor(e){super(),this.elements=e}}function Du(e,t){const n=ju(t);for(const r of e.elements)n.some(e=>$l(e,r))||n.push(r);return{arrayValue:{values:n}}}class Pu extends Su{constructor(e){super(),this.elements=e}}function Ru(e,t){let n=ju(t);for(const r of e.elements)n=n.filter(e=>!$l(e,r));return{arrayValue:{values:n}}}class Ou extends Su{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Lu(e){return Il(e.integerValue||e.doubleValue)}function ju(e){return Yl(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Mu{constructor(e,t){this.field=e,this.transform=t}}class Fu{constructor(e,t){this.version=e,this.transformResults=t}}class Vu{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Vu}static exists(e){return new Vu(void 0,e)}static updateTime(e){return new Vu(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Uu(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class zu{}function $u(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Yu(e.key,Vu.none()):new Ku(e.key,e.data,Vu.none());{const n=e.data,r=uc.empty();let i=new ml(no.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Gu(e.key,r,new vl(i.toArray()),Vu.none())}}function Bu(e,t,n){e instanceof Ku?function(e,t,n){const r=e.value.clone(),i=Xu(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Gu?function(e,t,n){if(!Uu(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Xu(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Qu(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function qu(e,t,n,r){return e instanceof Ku?function(e,t,n,r){if(!Uu(e.precondition,t))return n;const i=e.value.clone(),s=Ju(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Gu?function(e,t,n,r){if(!Uu(e.precondition,t))return n;const i=Ju(e.fieldTransforms,r,t),s=t.data;return s.setAll(Qu(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Uu(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Hu(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Nu(r.transform,e||null);null!=i&&(null===n&&(n=uc.empty()),n.set(r.field,i))}return n||null}function Wu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Xs(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Au&&t instanceof Au||e instanceof Pu&&t instanceof Pu?Xs(e.elements,t.elements,$l):e instanceof Ou&&t instanceof Ou?$l(e.Ee,t.Ee):e instanceof Cu&&t instanceof Cu}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ku extends zu{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Gu extends zu{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Qu(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Xu(e,t,n){const r=new Map;As(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Tu(o,a,n[i]))}return r}function Ju(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,ku(e,s,t))}return r}class Yu extends zu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Zu extends zu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class eh{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Bu(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=qu(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=qu(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=mu();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=$u(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(yo.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),bu())}isEqual(e){return this.batchId===e.batchId&&Xs(this.mutations,e.mutations,(e,t)=>Wu(e,t))&&Xs(this.baseMutations,e.baseMutations,(e,t)=>Wu(e,t))}}class th{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){As(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let r=yu;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new th(e,t,n,r)}}class nh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class rh{constructor(e,t){this.count=e,this.unchangedNames=t}}var ih,sh;function oh(e){switch(e){case Ps.OK:return Ns(64938);case Ps.CANCELLED:case Ps.UNKNOWN:case Ps.DEADLINE_EXCEEDED:case Ps.RESOURCE_EXHAUSTED:case Ps.INTERNAL:case Ps.UNAVAILABLE:case Ps.UNAUTHENTICATED:return!1;case Ps.INVALID_ARGUMENT:case Ps.NOT_FOUND:case Ps.ALREADY_EXISTS:case Ps.PERMISSION_DENIED:case Ps.FAILED_PRECONDITION:case Ps.ABORTED:case Ps.OUT_OF_RANGE:case Ps.UNIMPLEMENTED:case Ps.DATA_LOSS:return!0;default:return Ns(15467,{code:e})}}function ah(e){if(void 0===e)return Ss("GRPC error has no .code"),Ps.UNKNOWN;switch(e){case ih.OK:return Ps.OK;case ih.CANCELLED:return Ps.CANCELLED;case ih.UNKNOWN:return Ps.UNKNOWN;case ih.DEADLINE_EXCEEDED:return Ps.DEADLINE_EXCEEDED;case ih.RESOURCE_EXHAUSTED:return Ps.RESOURCE_EXHAUSTED;case ih.INTERNAL:return Ps.INTERNAL;case ih.UNAVAILABLE:return Ps.UNAVAILABLE;case ih.UNAUTHENTICATED:return Ps.UNAUTHENTICATED;case ih.INVALID_ARGUMENT:return Ps.INVALID_ARGUMENT;case ih.NOT_FOUND:return Ps.NOT_FOUND;case ih.ALREADY_EXISTS:return Ps.ALREADY_EXISTS;case ih.PERMISSION_DENIED:return Ps.PERMISSION_DENIED;case ih.FAILED_PRECONDITION:return Ps.FAILED_PRECONDITION;case ih.ABORTED:return Ps.ABORTED;case ih.OUT_OF_RANGE:return Ps.OUT_OF_RANGE;case ih.UNIMPLEMENTED:return Ps.UNIMPLEMENTED;case ih.DATA_LOSS:return Ps.DATA_LOSS;default:return Ns(39323,{code:e})}}(sh=ih||(ih={}))[sh.OK=0]="OK",sh[sh.CANCELLED=1]="CANCELLED",sh[sh.UNKNOWN=2]="UNKNOWN",sh[sh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",sh[sh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",sh[sh.NOT_FOUND=5]="NOT_FOUND",sh[sh.ALREADY_EXISTS=6]="ALREADY_EXISTS",sh[sh.PERMISSION_DENIED=7]="PERMISSION_DENIED",sh[sh.UNAUTHENTICATED=16]="UNAUTHENTICATED",sh[sh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",sh[sh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",sh[sh.ABORTED=10]="ABORTED",sh[sh.OUT_OF_RANGE=11]="OUT_OF_RANGE",sh[sh.UNIMPLEMENTED=12]="UNIMPLEMENTED",sh[sh.INTERNAL=13]="INTERNAL",sh[sh.UNAVAILABLE=14]="UNAVAILABLE",sh[sh.DATA_LOSS=15]="DATA_LOSS";let lh=null;const ch=new is([4294967295,4294967295],0);function uh(e){const t=qs().encode(e),n=new ss;return n.update(t),new Uint8Array(n.digest())}function hh(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new is([n,r],0),new is([i,s],0)]}class dh{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new fh(`Invalid padding: ${t}`);if(n<0)throw new fh(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new fh(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new fh(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=is.fromNumber(this.fe)}pe(e,t,n){let r=e.add(t.multiply(is.fromNumber(n)));return 1===r.compare(ch)&&(r=new is([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.fe)return!1;const t=uh(e),[n,r]=hh(t);for(let i=0;i<this.hashCount;i++){const e=this.pe(n,r,i);if(!this.ye(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new dh(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.fe)return;const t=uh(e),[n,r]=hh(t);for(let i=0;i<this.hashCount;i++){const e=this.pe(n,r,i);this.we(e)}}we(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class fh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ph{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,mh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new ph(yo.min(),r,new dl(Ws),uu(),bu())}}class mh{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new mh(n,t,bu(),bu(),bu())}}class gh{constructor(e,t,n,r){this.Se=e,this.removedTargetIds=t,this.key=n,this.be=r}}class yh{constructor(e,t){this.targetId=e,this.De=t}}class vh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wl.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class bh{constructor(){this.ve=0,this.Ce=_h(),this.Fe=wl.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return 0!==this.ve}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=bu(),t=bu(),n=bu();return this.Ce.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ns(38017,{changeType:i})}}),new mh(this.Fe,this.Me,e,t,n)}ke(){this.xe=!1,this.Ce=_h()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,As(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class wh{constructor(e){this.We=e,this.Ge=new Map,this.ze=uu(),this.je=xh(),this.Je=xh(),this.He=new dl(Ws)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const n=this.tt(t);switch(e.state){case 0:this.nt(t)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),n.Be(e.resumeToken));break;default:Ns(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((e,n)=>{this.nt(n)&&t(n)})}it(e){const t=e.targetId,n=e.De.count,r=this.st(t);if(r){const i=r.target;if(zc(i))if(0===n){const e=new ro(i.path);this.Xe(t,e,dc.newNoDocument(e,yo.min()))}else As(1===n,20013,{expectedCount:n});else{const r=this.ot(t);if(r!==n){const n=this._t(e),i=n?this.ut(n,e,r):1;if(0!==i){this.rt(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,e)}null==lh||lh.ct(function(e,t,n,r,i){var s,o,a,l,c,u;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==d?void 0:d.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.De,this.We.lt(),n,i))}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=El(n).toUint8Array()}catch(e){if(e instanceof bl)return ks("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new dh(s,r,i)}catch(e){return ks(e instanceof fh?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.fe?null:o}ut(e,t,n){return t.De.count===n-this.ht(e,t.targetId)?0:2}ht(e,t){const n=this.We.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.We.lt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.Xe(t,n,null),r++)}),r}Pt(e){const t=new Map;this.Ge.forEach((n,r)=>{const i=this.st(r);if(i){if(n.current&&zc(i.target)){const t=new ro(i.target.path);this.Tt(t).has(r)||this.It(r,t)||this.Xe(r,t,dc.newNoDocument(t,e))}n.Ne&&(t.set(r,n.Le()),n.ke())}});let n=bu();this.Je.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.st(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.ze.forEach((t,n)=>n.setReadTime(e));const r=new ph(e,t,this.He,this.ze,n);return this.ze=uu(),this.je=xh(),this.Je=xh(),this.He=new dl(Ws),r}Ze(e,t){if(!this.nt(e))return;const n=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,n),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,n){if(!this.nt(e))return;const r=this.tt(e);this.It(e,t)?r.qe(t,1):r.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),n&&(this.ze=this.ze.insert(t,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new bh,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new ml(Ws),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new ml(Ws),this.je=this.je.insert(e,t)),t}nt(e){const t=null!==this.st(e);return t||Es("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new bh),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function xh(){return new dl(ro.comparator)}function _h(){return new dl(ro.comparator)}const Ih={asc:"ASCENDING",desc:"DESCENDING"},Eh={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Sh={and:"AND",or:"OR"};class kh{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Th(e,t){return e.useProto3Json||Go(t)?t:{value:t}}function Nh(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ch(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ah(e,t){return Nh(e,t.toTimestamp())}function Dh(e){return As(!!e,49232),yo.fromTimestamp(function(e){const t=_l(e);return new go(t.seconds,t.nanos)}(e))}function Ph(e,t){return Rh(e,t).canonicalString()}function Rh(e,t){const n=function(e){return new eo(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Oh(e){const t=eo.fromString(e);return As(nd(t),10190,{key:t.toString()}),t}function Lh(e,t){return Ph(e.databaseId,t.path)}function jh(e,t){const n=Oh(t);if(n.get(1)!==e.databaseId.projectId)throw new Rs(Ps.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Rs(Ps.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ro(Uh(n))}function Mh(e,t){return Ph(e.databaseId,t)}function Fh(e){const t=Oh(e);return 4===t.length?eo.emptyPath():Uh(t)}function Vh(e){return new eo(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Uh(e){return As(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function zh(e,t,n){return{name:Lh(e,t),fields:n.value.mapValue.fields}}function $h(e,t,n){const r=jh(e,t.name),i=Dh(t.updateTime),s=t.createTime?Dh(t.createTime):yo.min(),o=new uc({mapValue:{fields:t.fields}}),a=dc.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Bh(e,t){let n;if(t instanceof Ku)n={update:zh(e,t.key,t.value)};else if(t instanceof Yu)n={delete:Lh(e,t.key)};else if(t instanceof Gu)n={update:zh(e,t.key,t.data),updateMask:td(t.fieldMask)};else{if(!(t instanceof Zu))return Ns(16599,{Rt:t.type});n={verify:Lh(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Cu)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Au)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Pu)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ou)return{fieldPath:t.field.canonicalString(),increment:n.Ee};throw Ns(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ah(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ns(27497)}(e,t.precondition)),n}function qh(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Vu.updateTime(Dh(e.updateTime)):void 0!==e.exists?Vu.exists(e.exists):Vu.none()}(t.currentDocument):Vu.none(),r=t.updateTransforms?t.updateTransforms.map(t=>function(e,t){let n=null;if("setToServerValue"in t)As("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),n=new Cu;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Au(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Pu(e)}else"increment"in t?n=new Ou(e,t.increment):Ns(16584,{proto:t});const r=no.fromServerFormat(t.fieldPath);return new Mu(r,n)}(e,t)):[];if(t.update){t.update.name;const i=jh(e,t.update.name),s=new uc({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new vl(t.map(e=>no.fromServerFormat(e)))}(t.updateMask);return new Gu(i,s,e,n,r)}return new Ku(i,s,n,r)}if(t.delete){const r=jh(e,t.delete);return new Yu(r,n)}if(t.verify){const r=jh(e,t.verify);return new Zu(r,n)}return Ns(1463,{proto:t})}function Hh(e,t){return{documents:[Mh(e,t.path)]}}function Wh(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Mh(e,i);const s=function(e){if(0!==e.length)return ed(wc.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Yh(e.field),direction:Qh(e.dir)}}(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Th(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{Vt:n,parent:i}}function Kh(e){let t=Fh(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){As(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Gh(e);return t instanceof wc&&Ic(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new gc(Zh(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Go(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new fc(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new fc(n,t)}(n.endAt)),Wc(t,i,o,s,a,"F",l,c)}function Gh(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Zh(e.unaryFilter.field);return bc.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Zh(e.unaryFilter.field);return bc.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Zh(e.unaryFilter.field);return bc.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Zh(e.unaryFilter.field);return bc.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ns(61313);default:return Ns(60726)}}(e):void 0!==e.fieldFilter?function(e){return bc.create(Zh(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ns(58110);default:return Ns(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return wc.create(e.compositeFilter.filters.map(e=>Gh(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Ns(1026)}}(e.compositeFilter.op))}(e):Ns(30097,{filter:e})}function Qh(e){return Ih[e]}function Xh(e){return Eh[e]}function Jh(e){return Sh[e]}function Yh(e){return{fieldPath:e.canonicalString()}}function Zh(e){return no.fromServerFormat(e.fieldPath)}function ed(e){return e instanceof bc?function(e){if("=="===e.op){if(ec(e.value))return{unaryFilter:{field:Yh(e.field),op:"IS_NAN"}};if(Zl(e.value))return{unaryFilter:{field:Yh(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ec(e.value))return{unaryFilter:{field:Yh(e.field),op:"IS_NOT_NAN"}};if(Zl(e.value))return{unaryFilter:{field:Yh(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yh(e.field),op:Xh(e.op),value:e.value}}}(e):e instanceof wc?function(e){const t=e.getFilters().map(e=>ed(e));return 1===t.length?t[0]:{compositeFilter:{op:Jh(e.op),filters:t}}}(e):Ns(54877,{filter:e})}function td(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function nd(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class rd{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:yo.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:yo.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:wl.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new rd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new rd(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new rd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new rd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class id{constructor(e){this.gt=e}}function sd(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:od(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Lh(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Nh(e,t.version.toTimestamp()),createTime:Nh(e,t.createTime.toTimestamp())}}(e.gt,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ad(t.version)};else{if(!t.isUnknownDocument())return Ns(57904,{document:t});r.unknownDocument={path:n.path.toArray(),version:ad(t.version)}}return r}function od(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function ad(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function ld(e){const t=new go(e.seconds,e.nanoseconds);return yo.fromTimestamp(t)}function cd(e,t){const n=(t.baseMutations||[]).map(t=>qh(e.gt,t));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map(t=>qh(e.gt,t)),i=go.fromMillis(t.localWriteTimeMs);return new eh(t.batchId,i,n,r)}function ud(e){const t=ld(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?ld(e.lastLimboFreeSnapshotVersion):yo.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){const t=e.documents.length;return As(1===t,1966,{count:t}),Jc(Kc(Fh(e.documents[0])))}(e.query):function(e){return Jc(Kh(e))}(e.query),new rd(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,wl.fromBase64String(e.resumeToken))}function hd(e,t){const n=ad(t.snapshotVersion),r=ad(t.lastLimboFreeSnapshotVersion);let i;i=zc(t.target)?Hh(e.gt,t.target):Wh(e.gt,t.target).Vt;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Vc(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function dd(e){const t=Kh({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?eu(t,t.limit,"L"):t}function fd(e,t){return new nh(t.largestBatchId,qh(e.gt,t.overlayMutation))}function pd(e,t){const n=t.path.lastSegment();return[e,Yo(t.path.popLast()),n]}function md(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:ad(r.readTime),documentKey:Yo(r.documentKey.path),largestBatchId:r.largestBatchId}}class gd{getBundleMetadata(e,t){return yd(e).get(t).next(e=>{if(e)return function(e){return{id:e.bundleId,createTime:ld(e.createTime),version:e.version}}(e)})}saveBundleMetadata(e,t){return yd(e).put(function(e){return{bundleId:e.id,createTime:ad(Dh(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return vd(e).get(t).next(e=>{if(e)return function(e){return{name:e.name,query:dd(e.bundledQuery),readTime:ld(e.readTime)}}(e)})}saveNamedQuery(e,t){return vd(e).put(function(e){return{name:e.name,readTime:ad(Dh(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function yd(e){return ll(e,Oa)}function vd(e){return ll(e,La)}class bd{constructor(e,t){this.serializer=e,this.userId=t}static yt(e,t){const n=t.uid||"";return new bd(e,n)}getOverlay(e,t){return wd(e).get(pd(this.userId,t)).next(e=>e?fd(this.serializer,e):null)}getOverlays(e,t){const n=pu();return Do.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){const r=[];return n.forEach((n,i)=>{const s=new nh(t,i);r.push(this.wt(e,s))}),Do.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach(e=>r.add(Yo(e.getCollectionPath())));const i=[];return r.forEach(t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(wd(e).Y(Ga,r))}),Do.waitFor(i)}getOverlaysForCollection(e,t,n){const r=pu(),i=Yo(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return wd(e).j(Ga,s).next(e=>{for(const t of e){const e=fd(this.serializer,t);r.set(e.getKey(),e)}return r})}getOverlaysForCollectionGroup(e,t,n,r){const i=pu();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return wd(e).X({index:Xa,range:o},(e,t,n)=>{const o=fd(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()}).next(()=>i)}wt(e,t){return wd(e).put(function(e,t,n){const[r,i,s]=pd(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Bh(e.gt,n.mutation)}}(this.serializer,this.userId,t))}}function wd(e){return ll(e,Wa)}class xd{St(e){return ll(e,Ya)}getSessionToken(e){return this.St(e).get("sessionToken").next(e=>{const t=null==e?void 0:e.value;return t?wl.fromUint8Array(t):wl.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class _d{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(Il(e.integerValue));else if("doubleValue"in e){const n=Il(e.doubleValue);isNaN(n)?this.Ct(t,13):(this.Ct(t,15),Qo(n)?t.Ft(0):t.Ft(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ct(t,20),"string"==typeof n&&(n=_l(n)),t.Mt(`${n.seconds||""}`),t.Ft(n.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(El(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ct(t,45),t.Ft(n.latitude||0),t.Ft(n.longitude||0)}else"mapValue"in e?ic(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):nc(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):Ns(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){const n=e.fields||{};this.Ct(t,55);for(const r of Object.keys(n))this.xt(r,t),this.Dt(n[r],t)}Lt(e,t){var n,r;const i=e.fields||{};this.Ct(t,53);const s=Vl,o=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.Ct(t,15),t.Ft(Il(o)),this.xt(s,t),this.Dt(i[s],t)}qt(e,t){const n=e.values||[];this.Ct(t,50);for(const r of n)this.Dt(r,t)}Bt(e,t){this.Ct(t,37),ro.fromName(e).path.forEach(e=>{this.Ct(t,60),this.$t(e,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}}_d.Ut=new _d;const Id=255;function Ed(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function Sd(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Ed(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}class kd{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Kt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Wt(n.value),n=t.next();this.Gt()}zt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.jt(n.value),n=t.next();this.Jt()}Ht(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Wt(e);else if(e<2048)this.Wt(960|e>>>6),this.Wt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Wt(480|e>>>12),this.Wt(128|63&e>>>6),this.Wt(128|63&e);else{const e=t.codePointAt(0);this.Wt(240|e>>>18),this.Wt(128|63&e>>>12),this.Wt(128|63&e>>>6),this.Wt(128|63&e)}}this.Gt()}Yt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.jt(e);else if(e<2048)this.jt(960|e>>>6),this.jt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.jt(480|e>>>12),this.jt(128|63&e>>>6),this.jt(128|63&e);else{const e=t.codePointAt(0);this.jt(240|e>>>18),this.jt(128|63&e>>>12),this.jt(128|63&e>>>6),this.jt(128|63&e)}}this.Jt()}Zt(e){const t=this.Xt(e),n=Sd(t);this.en(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}tn(e){const t=this.Xt(e),n=Sd(t);this.en(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}nn(){this.rn(Id),this.rn(255)}sn(){this._n(Id),this._n(255)}reset(){this.position=0}seed(e){this.en(e.length),this.buffer.set(e,this.position),this.position+=e.length}an(){return this.buffer.slice(0,this.position)}Xt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Wt(e){const t=255&e;0===t?(this.rn(0),this.rn(255)):t===Id?(this.rn(Id),this.rn(0)):this.rn(t)}jt(e){const t=255&e;0===t?(this._n(0),this._n(255)):t===Id?(this._n(Id),this._n(0)):this._n(e)}Gt(){this.rn(0),this.rn(1)}Jt(){this._n(0),this._n(1)}rn(e){this.en(1),this.buffer[this.position++]=e}_n(e){this.en(1),this.buffer[this.position++]=~e}en(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class Td{constructor(e){this.un=e}Nt(e){this.un.Kt(e)}Mt(e){this.un.Ht(e)}Ft(e){this.un.Zt(e)}vt(){this.un.nn()}}class Nd{constructor(e){this.un=e}Nt(e){this.un.zt(e)}Mt(e){this.un.Yt(e)}Ft(e){this.un.tn(e)}vt(){this.un.sn()}}class Cd{constructor(){this.un=new kd,this.cn=new Td(this.un),this.ln=new Nd(this.un)}seed(e){this.un.seed(e)}hn(e){return 0===e?this.cn:this.ln}an(){return this.un.an()}reset(){this.un.reset()}}class Ad{constructor(e,t,n,r){this.Pn=e,this.Tn=t,this.In=n,this.dn=r}En(){const e=this.dn.length,t=0===e||255===this.dn[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new Ad(this.Pn,this.Tn,this.In,n)}An(e,t,n){return{indexId:this.Pn,uid:e,arrayValue:Rd(this.In),directionalValue:Rd(this.dn),orderedDocumentKey:Rd(t),documentKey:n.path.toArray()}}Rn(e,t,n){const r=this.An(e,t,n);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Dd(e,t){let n=e.Pn-t.Pn;return 0!==n?n:(n=Pd(e.In,t.In),0!==n?n:(n=Pd(e.dn,t.dn),0!==n?n:ro.comparator(e.Tn,t.Tn)))}function Pd(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}function Rd(e){return K()?function(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}(e):e}function Od(e){return"string"!=typeof e?e:function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e)}class Ld{constructor(e){this.Vn=new ml((e,t)=>no.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.mn=e.orderBy,this.fn=[];for(const t of e.filters){const e=t;e.isInequality()?this.Vn=this.Vn.add(e):this.fn.push(e)}}get gn(){return this.Vn.size>1}pn(e){if(As(e.collectionGroup===this.collectionId,49279),this.gn)return!1;const t=wo(e);if(void 0!==t&&!this.yn(t))return!1;const n=xo(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.yn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Vn.size>0){const e=this.Vn.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.wn(e,t)||!this.Sn(this.mn[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.mn.length||!this.Sn(this.mn[s++],e))return!1}return!0}bn(){if(this.gn)return null;let e=new ml(no.comparator);const t=[];for(const n of this.fn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new _o(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new _o(n.field,0))}for(const n of this.mn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new _o(n.field,"asc"===n.dir?0:1)));return new bo(bo.UNKNOWN_ID,this.collectionId,t,Io.empty())}yn(e){for(const t of this.fn)if(this.wn(t,e))return!0;return!1}wn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}Sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function jd(e){var t,n;if(As(e instanceof bc||e instanceof wc,20012),e instanceof bc){if(e instanceof Oc){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map(t=>bc.create(e.field,"==",t)))||[];return wc.create(r,"or")}return e}const r=e.filters.map(e=>jd(e));return wc.create(r,e.op)}function Md(e){if(0===e.getFilters().length)return[];const t=zd(jd(e));return As(Ud(t),7391),Fd(t)||Vd(t)?[t]:t.getFilters()}function Fd(e){return e instanceof bc}function Vd(e){return e instanceof wc&&Ic(e)}function Ud(e){return Fd(e)||Vd(e)||function(e){if(e instanceof wc&&_c(e)){for(const t of e.getFilters())if(!Fd(t)&&!Vd(t))return!1;return!0}return!1}(e)}function zd(e){if(As(e instanceof bc||e instanceof wc,34018),e instanceof bc)return e;if(1===e.filters.length)return zd(e.filters[0]);const t=e.filters.map(e=>zd(e));let n=wc.create(t,e.op);return n=qd(n),Ud(n)?n:(As(n instanceof wc,64498),As(xc(n),40251),As(n.filters.length>1,57927),n.filters.reduce((e,t)=>$d(e,t)))}function $d(e,t){let n;return As(e instanceof bc||e instanceof wc,38388),As(t instanceof bc||t instanceof wc,25473),n=e instanceof bc?t instanceof bc?function(e,t){return wc.create([e,t],"and")}(e,t):Bd(e,t):t instanceof bc?Bd(t,e):function(e,t){if(As(e.filters.length>0&&t.filters.length>0,48005),xc(e)&&xc(t))return Tc(e,t.getFilters());const n=_c(e)?e:t,r=_c(e)?t:e,i=n.filters.map(e=>$d(e,r));return wc.create(i,"or")}(e,t),qd(n)}function Bd(e,t){if(xc(t))return Tc(t,e.getFilters());{const n=t.filters.map(t=>$d(e,t));return wc.create(n,"or")}}function qd(e){if(As(e instanceof bc||e instanceof wc,11850),e instanceof bc)return e;const t=e.getFilters();if(1===t.length)return qd(t[0]);if(Ec(e))return e;const n=t.map(e=>qd(e)),r=[];return n.forEach(t=>{t instanceof bc?r.push(t):t instanceof wc&&(t.op===e.op?r.push(...t.filters):r.push(t))}),1===r.length?r[0]:wc.create(r,e.op)}class Hd{constructor(){this.Dn=new Wd}addToCollectionParentIndex(e,t){return this.Dn.add(t),Do.resolve()}getCollectionParents(e,t){return Do.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return Do.resolve()}deleteFieldIndex(e,t){return Do.resolve()}deleteAllFieldIndexes(e){return Do.resolve()}createTargetIndexes(e,t){return Do.resolve()}getDocumentsMatchingTarget(e,t){return Do.resolve(null)}getIndexType(e,t){return Do.resolve(0)}getFieldIndexes(e,t){return Do.resolve([])}getNextCollectionGroupToUpdate(e){return Do.resolve(null)}getMinOffset(e,t){return Do.resolve(ko.min())}getMinOffsetFromCollectionGroup(e,t){return Do.resolve(ko.min())}updateCollectionGroup(e,t,n){return Do.resolve()}updateIndexEntries(e,t){return Do.resolve()}}class Wd{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new ml(eo.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new ml(eo.comparator)).toArray()}}const Kd="IndexedDbIndexManager",Gd=new Uint8Array(0);class Qd{constructor(e,t){this.databaseId=t,this.vn=new Wd,this.Cn=new lu(e=>Vc(e),(e,t)=>Uc(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const i={collectionId:n,parent:Yo(r)};return Xd(e).put(i)}return Do.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[Js(t),""],!1,!0);return Xd(e).j(r).next(e=>{for(const r of e){if(r.collectionId!==t)break;n.push(ta(r.parent))}return n})}addFieldIndex(e,t){const n=Yd(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Zd(e);return i.next(e=>{n.put(md(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const n=Yd(e),r=Zd(e),i=Jd(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Yd(e),n=Jd(e),r=Zd(e);return t.Y().next(()=>n.Y()).next(()=>r.Y())}createTargetIndexes(e,t){return Do.forEach(this.Fn(t),t=>this.getIndexType(e,t).next(n=>{if(0===n||1===n){const n=new Ld(t).bn();if(null!=n)return this.addFieldIndex(e,n)}}))}getDocumentsMatchingTarget(e,t){const n=Jd(e);let r=!0;const i=new Map;return Do.forEach(this.Fn(t),t=>this.Mn(e,t).next(e=>{r&&(r=!!e),i.set(t,e)})).next(()=>{if(r){let e=bu();const r=[];return Do.forEach(i,(i,s)=>{Es(Kd,`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`}(i)} to execute ${Vc(t)}`);const o=function(e,t){const n=wo(t);if(void 0===n)return null;for(const r of $c(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of xo(t))for(const t of $c(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),l=function(e,t){const n=[];let r=!0;for(const i of xo(t)){const t=0===i.kind?Bc(e,i.fieldPath,e.startAt):qc(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new fc(n,r)}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of xo(t)){const t=0===i.kind?qc(e,i.fieldPath,e.endAt):Bc(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new fc(n,r)}(s,i),u=this.xn(i,s,l),h=this.xn(i,s,c),d=this.On(i,s,a),f=this.Nn(i.indexId,o,u,l.inclusive,h,c.inclusive,d);return Do.forEach(f,i=>n.H(i,t.limit).next(t=>{t.forEach(t=>{const n=ro.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))})}))}).next(()=>r)}return Do.resolve(null)})}Fn(e){let t=this.Cn.get(e);return t||(t=0===e.filters.length?[e]:Md(wc.create(e.filters,"and")).map(t=>Fc(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t),t)}Nn(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),l=a/(null!=t?t.length:1),c=[];for(let u=0;u<a;++u){const a=t?this.Bn(t[u/l]):Gd,h=this.Ln(e,a,n[u%l],r),d=this.kn(e,a,i[u%l],s),f=o.map(t=>this.Ln(e,a,t,!0));c.push(...this.createRange(h,d,f))}return c}Ln(e,t,n,r){const i=new Ad(e,ro.empty(),t,n);return r?i:i.En()}kn(e,t,n,r){const i=new Ad(e,ro.empty(),t,n);return r?i.En():i}Mn(e,t){const n=new Ld(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(const r of e)n.pn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let n=2;const r=this.Fn(t);return Do.forEach(r,t=>this.Mn(e,t).next(e=>{e?0!==n&&e.fields.length<function(e){let t=new ml(no.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})).next(()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n)}qn(e,t){const n=new Cd;for(const r of xo(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.hn(r.kind);_d.Ut.bt(e,i)}return n.an()}Bn(e){const t=new Cd;return _d.Ut.bt(e,t.hn(0)),t.an()}Qn(e,t){const n=new Cd;return _d.Ut.bt(Xl(this.databaseId,t),n.hn(function(e){const t=xo(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.an()}On(e,t,n){if(null===n)return[];let r=[];r.push(new Cd);let i=0;for(const s of xo(e)){const e=n[i++];for(const n of r)if(this.$n(t,s.fieldPath)&&Yl(e))r=this.Un(r,s,e);else{const t=n.hn(s.kind);_d.Ut.bt(e,t)}}return this.Kn(r)}xn(e,t,n){return this.On(e,t,n.position)}Kn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].an();return t}Un(e,t,n){const r=[...e],i=[];for(const s of n.arrayValue.values||[])for(const e of r){const n=new Cd;n.seed(e.an()),_d.Ut.bt(s,n.hn(t.kind)),i.push(n)}return i}$n(e,t){return!!e.filters.find(e=>e instanceof bc&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const n=Yd(e),r=Zd(e);return(t?n.j(Ma,IDBKeyRange.bound(t,t)):n.j()).next(e=>{const t=[];return Do.forEach(e,e=>r.get([e.indexId,this.uid]).next(n=>{t.push(function(e,t){const n=t?new Io(t.sequenceNumber,new ko(ld(t.readTime),new ro(ta(t.documentKey)),t.largestBatchId)):Io.empty(),r=e.fields.map(e=>{let[t,n]=e;return new _o(no.fromServerFormat(t),n)});return new bo(e.indexId,e.collectionGroup,r,n)}(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:Ws(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){const r=Yd(e),i=Zd(e);return this.Wn(e).next(e=>r.j(Ma,IDBKeyRange.bound(t,t)).next(t=>Do.forEach(t,t=>i.put(md(t.indexId,this.uid,e,n)))))}updateIndexEntries(e,t){const n=new Map;return Do.forEach(t,(t,r)=>{const i=n.get(t.collectionGroup);return(i?Do.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(n.set(t.collectionGroup,i),Do.forEach(i,n=>this.Gn(e,t,n).next(t=>{const i=this.zn(r,n);return t.isEqual(i)?Do.resolve():this.jn(e,r,n,t,i)}))))})}Jn(e,t,n,r){return Jd(e).put(r.An(this.uid,this.Qn(n,t.key),t.key))}Hn(e,t,n,r){return Jd(e).delete(r.Rn(this.uid,this.Qn(n,t.key),t.key))}Gn(e,t,n){const r=Jd(e);let i=new ml(Dd);return r.X({index:qa,range:IDBKeyRange.only([n.indexId,this.uid,Rd(this.Qn(n,t))])},(e,r)=>{i=i.add(new Ad(n.indexId,t,Od(r.arrayValue),Od(r.directionalValue)))}).next(()=>i)}zn(e,t){let n=new ml(Dd);const r=this.qn(t,e);if(null==r)return n;const i=wo(t);if(null!=i){const s=e.data.field(i.fieldPath);if(Yl(s))for(const i of s.arrayValue.values||[])n=n.add(new Ad(t.indexId,e.key,this.Bn(i),r))}else n=n.add(new Ad(t.indexId,e.key,Gd,r));return n}jn(e,t,n,r,i){Es(Kd,"Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=yl(s),l=yl(o);for(;a||l;){let e=!1,t=!1;if(a&&l){const r=n(a,l);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(l),l=yl(o)):t?(i(a),a=yl(s)):(a=yl(s),l=yl(o))}}(r,i,Dd,r=>{s.push(this.Jn(e,t,n,r))},r=>{s.push(this.Hn(e,t,n,r))}),Do.waitFor(s)}Wn(e){let t=1;return Zd(e).X({index:Ua,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,r)=>{r.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>Dd(e,t)).filter((e,t,n)=>!t||0!==Dd(e,n[t-1]));const r=[];r.push(e);for(const s of n){const n=Dd(s,e),i=Dd(s,t);if(0===n)r[0]=e.En();else if(n>0&&i<0)r.push(s),r.push(s.En());else if(i>0)break}r.push(t);const i=[];for(let s=0;s<r.length;s+=2){if(this.Yn(r[s],r[s+1]))return[];const e=r[s].Rn(this.uid,Gd,ro.empty()),t=r[s+1].Rn(this.uid,Gd,ro.empty());i.push(IDBKeyRange.bound(e,t))}return i}Yn(e,t){return Dd(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(ef)}getMinOffset(e,t){return Do.mapArray(this.Fn(t),t=>this.Mn(e,t).next(e=>e||Ns(44426))).next(ef)}}function Xd(e){return ll(e,Da)}function Jd(e){return ll(e,$a)}function Yd(e){return ll(e,ja)}function Zd(e){return ll(e,Fa)}function ef(e){As(0!==e.length,28825);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;To(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new ko(t.readTime,t.documentKey,n)}const tf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},nf=41943040;class rf{static withCacheSize(e){return new rf(e,rf.DEFAULT_COLLECTION_PERCENTILE,rf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function sf(e,t,n){const r=e.store(oa),i=e.store(fa),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.X({range:o},(e,t,n)=>(a++,n.delete()));s.push(l.next(()=>{As(1===a,47070,{batchId:n.batchId})}));const c=[];for(const u of n.mutations){const e=ha(t,u.key.path,n.batchId);s.push(i.delete(e)),c.push(u.key)}return Do.waitFor(s).next(()=>c)}function of(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Ns(14731);t=e.noDocument}return JSON.stringify(t).length}rf.DEFAULT_COLLECTION_PERCENTILE=10,rf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rf.DEFAULT=new rf(nf,rf.DEFAULT_COLLECTION_PERCENTILE,rf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rf.DISABLED=new rf(-1,0,0);class af{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Zn={}}static yt(e,t,n,r){As(""!==e.uid,64387);const i=e.isAuthenticated()?e.uid:"";return new af(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return cf(e).X({index:la,range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const i=uf(e),s=cf(e);return s.add({}).next(o=>{As("number"==typeof o,49019);const a=new eh(o,t,n,r),l=function(e,t,n){const r=n.baseMutations.map(t=>Bh(e.gt,t)),i=n.mutations.map(t=>Bh(e.gt,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),c=[];let u=new ml((e,t)=>Ws(e.canonicalString(),t.canonicalString()));for(const e of r){const t=ha(this.userId,e.key.path,o);u=u.add(e.key.path.popLast()),c.push(s.put(l)),c.push(i.put(t,da))}return u.forEach(t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Zn[o]=a.keys()}),Do.waitFor(c).next(()=>a)})}lookupMutationBatch(e,t){return cf(e).get(t).next(e=>e?(As(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),cd(this.serializer,e)):null)}Xn(e,t){return this.Zn[t]?Do.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const n=e.keys();return this.Zn[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return cf(e).X({index:la,range:r},(e,t,r)=>{t.userId===this.userId&&(As(t.batchId>=n,47524,{er:n}),i=cd(this.serializer,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Ko;return cf(e).X({index:la,range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ko],[this.userId,Number.POSITIVE_INFINITY]);return cf(e).j(la,t).next(e=>e.map(e=>cd(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=ua(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return uf(e).X({range:r},(n,r,s)=>{const[o,a,l]=n,c=ta(a);if(o===this.userId&&t.path.isEqual(c))return cf(e).get(l).next(e=>{if(!e)throw Ns(61480,{tr:n,batchId:l});As(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:l}),i.push(cd(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ml(Ws);const r=[];return t.forEach(t=>{const i=ua(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=uf(e).X({range:s},(e,r,i)=>{const[s,o,a]=e,l=ta(o);s===this.userId&&t.path.isEqual(l)?n=n.add(a):i.done()});r.push(o)}),Do.waitFor(r).next(()=>this.nr(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=ua(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new ml(Ws);return uf(e).X({range:s},(e,t,i)=>{const[s,a,l]=e,c=ta(a);s===this.userId&&n.isPrefixOf(c)?c.length===r&&(o=o.add(l)):i.done()}).next(()=>this.nr(e,o))}nr(e,t){const n=[],r=[];return t.forEach(t=>{r.push(cf(e).get(t).next(e=>{if(null===e)throw Ns(35274,{batchId:t});As(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),n.push(cd(this.serializer,e))}))}),Do.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return sf(e.ce,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.rr(t.batchId)}),Do.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}rr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return Do.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return uf(e).X({range:n},(e,t,n)=>{if(e[0]===this.userId){const t=ta(e[1]);r.push(t)}else n.done()}).next(()=>{As(0===r.length,56720,{ir:r.map(e=>e.canonicalString())})})})}containsKey(e,t){return lf(e,this.userId,t)}sr(e){return hf(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:Ko,lastStreamToken:""})}}function lf(e,t,n){const r=ua(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return uf(e).X({range:s,Z:!0},(e,n,r)=>{const[s,a,l]=e;s===t&&a===i&&(o=!0),r.done()}).next(()=>o)}function cf(e){return ll(e,oa)}function uf(e){return ll(e,fa)}function hf(e){return ll(e,sa)}class df{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new df(0)}static ur(){return new df(-1)}}class ff{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.cr(e).next(t=>{const n=new df(t.highestTargetId);return t.highestTargetId=n.next(),this.lr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.cr(e).next(e=>yo.fromTimestamp(new go(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.cr(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.cr(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.lr(e,r)))}addTargetData(e,t){return this.hr(e,t).next(()=>this.cr(e).next(n=>(n.targetCount+=1,this.Pr(t,n),this.lr(e,n))))}updateTargetData(e,t){return this.hr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>pf(e).delete(t.targetId)).next(()=>this.cr(e)).next(t=>(As(t.targetCount>0,8065),t.targetCount-=1,this.lr(e,t)))}removeTargets(e,t,n){let r=0;const i=[];return pf(e).X((s,o)=>{const a=ud(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))}).next(()=>Do.waitFor(i)).next(()=>r)}forEachTarget(e,t){return pf(e).X((e,n)=>{const r=ud(n);t(r)})}cr(e){return mf(e).get(Ca).next(e=>(As(null!==e,2888),e))}lr(e,t){return mf(e).put(Ca,t)}hr(e,t){return pf(e).put(hd(this.serializer,t))}Pr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.cr(e).next(e=>e.targetCount)}getTargetData(e,t){const n=Vc(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return pf(e).X({range:r,index:Ia},(e,n,r)=>{const s=ud(n);Uc(t,s.target)&&(i=s,r.done())}).next(()=>i)}addMatchingKeys(e,t,n){const r=[],i=gf(e);return t.forEach(t=>{const s=Yo(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))}),Do.waitFor(r)}removeMatchingKeys(e,t,n){const r=gf(e);return Do.forEach(t,t=>{const i=Yo(t.path);return Do.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){const n=gf(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=gf(e);let i=bu();return r.X({range:n,Z:!0},(e,t,n)=>{const r=ta(e[1]),s=new ro(r);i=i.add(s)}).next(()=>i)}containsKey(e,t){const n=Yo(t.path),r=IDBKeyRange.bound([n],[Js(n)],!1,!0);let i=0;return gf(e).X({index:Ta,Z:!0,range:r},(e,t,n)=>{let[r,s]=e;0!==r&&(i++,n.done())}).next(()=>i>0)}Et(e,t){return pf(e).get(t).next(e=>e?ud(e):null)}}function pf(e){return ll(e,_a)}function mf(e){return ll(e,Aa)}function gf(e){return ll(e,Sa)}const yf="LruGarbageCollector",vf=1048576;function bf(e,t){let[n,r]=e,[i,s]=t;const o=Ws(n,i);return 0===o?Ws(r,s):o}class wf{constructor(e){this.Tr=e,this.buffer=new ml(bf),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();bf(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xf{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Ar=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return null!==this.Ar}Rr(e){Es(yf,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Fo(e)?Es(yf,"Ignoring IndexedDB error during garbage collection: ",e):await Ao(e)}await this.Rr(3e5)})}}class _f{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Do.resolve(Wo.ue);const n=new wf(t);return this.Vr.forEachTarget(e,e=>n.Er(e.sequenceNumber)).next(()=>this.Vr.gr(e,e=>n.Er(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Es("LruGarbageCollector","Garbage collection skipped; disabled"),Do.resolve(tf)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Es("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),tf):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let n,r,i,s,o,a,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(Es("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),Is()<=he.DEBUG&&Es("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-c}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-c}ms`),Do.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function If(e,t){return new _f(e,t)}class Ef{constructor(e,t){this.db=e,this.garbageCollector=If(this,t)}mr(e){const t=this.yr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}yr(e){let t=0;return this.gr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}gr(e,t){return this.wr(e,(e,n)=>t(n))}addReference(e,t,n){return Sf(e,n)}removeReference(e,t,n){return Sf(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Sf(e,t)}Sr(e,t){return function(e,t){let n=!1;return hf(e).ee(r=>lf(e,r,t).next(e=>(e&&(n=!0),Do.resolve(!e)))).next(()=>n)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.wr(e,(s,o)=>{if(o<=t){const t=this.Sr(e,s).next(t=>{if(!t)return i++,n.getEntry(e,s).next(()=>(n.removeEntry(s,yo.min()),gf(e).delete(function(e){return[0,Yo(e.path)]}(s))))});r.push(t)}}).next(()=>Do.waitFor(r)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Sf(e,t)}wr(e,t){const n=gf(e);let r,i=Wo.ue;return n.X({index:Ta},(e,n)=>{let[s,o]=e,{path:a,sequenceNumber:l}=n;0===s?(i!==Wo.ue&&t(new ro(ta(r)),i),i=l,r=a):i=Wo.ue}).next(()=>{i!==Wo.ue&&t(new ro(ta(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Sf(e,t){return gf(e).put(function(e,t){return{targetId:0,path:Yo(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class kf{constructor(){this.changes=new lu(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,dc.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Do.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Tf{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Df(e).put(n)}removeEntry(e,t,n){return Df(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],od(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.br(e,n)))}getEntry(e,t){let n=dc.newInvalidDocument(t);return Df(e).X({index:ga,range:IDBKeyRange.only(Pf(t))},(e,r)=>{n=this.Dr(t,r)}).next(()=>n)}vr(e,t){let n={size:0,document:dc.newInvalidDocument(t)};return Df(e).X({index:ga,range:IDBKeyRange.only(Pf(t))},(e,r)=>{n={document:this.Dr(t,r),size:of(r)}}).next(()=>n)}getEntries(e,t){let n=uu();return this.Cr(e,t,(e,t)=>{const r=this.Dr(e,t);n=n.insert(e,r)}).next(()=>n)}Fr(e,t){let n=uu(),r=new dl(ro.comparator);return this.Cr(e,t,(e,t)=>{const i=this.Dr(e,t);n=n.insert(e,i),r=r.insert(e,of(t))}).next(()=>({documents:n,Mr:r}))}Cr(e,t,n){if(t.isEmpty())return Do.resolve();let r=new ml(Of);t.forEach(e=>r=r.add(e));const i=IDBKeyRange.bound(Pf(r.first()),Pf(r.last())),s=r.getIterator();let o=s.getNext();return Df(e).X({index:ga,range:i},(e,t,r)=>{const i=ro.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&Of(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.G(Pf(o)):r.done()}).next(()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),od(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Df(e).j(IDBKeyRange.bound(o,a,!0)).next(e=>{null==i||i.incrementDocumentReadCount(e.length);let n=uu();for(const i of e){const e=this.Dr(ro.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(iu(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,t,n,r){let i=uu();const s=Rf(t,n),o=Rf(t,ko.max());return Df(e).X({index:va,range:IDBKeyRange.bound(s,o,!0)},(e,t,n)=>{const s=this.Dr(ro.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()}).next(()=>i)}newChangeBuffer(e){return new Cf(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return Af(e).get(xa).next(e=>(As(!!e,20021),e))}br(e,t){return Af(e).put(xa,t)}Dr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=$h(e.gt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=ro.fromSegments(t.noDocument.path),r=ld(t.noDocument.readTime);n=dc.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Ns(56709);{const e=ro.fromSegments(t.unknownDocument.path),r=ld(t.unknownDocument.version);n=dc.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new go(e[0],e[1]);return yo.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(yo.min()))return e}return dc.newInvalidDocument(e)}}function Nf(e){return new Tf(e)}class Cf extends kf{constructor(e,t){super(),this.Or=e,this.trackRemovals=t,this.Nr=new lu(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let n=0,r=new ml((e,t)=>Ws(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{const o=this.Nr.get(i);if(t.push(this.Or.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=sd(this.Or.serializer,s);r=r.add(i.path.popLast());const l=of(a);n+=l-o.size,t.push(this.Or.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=sd(this.Or.serializer,s.convertToNoDocument(yo.min()));t.push(this.Or.addEntry(e,i,n))}}),r.forEach(n=>{t.push(this.Or.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.Or.updateMetadata(e,n)),Do.waitFor(t)}getFromCache(e,t){return this.Or.vr(e,t).next(e=>(this.Nr.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Or.Fr(e,t).next(e=>{let{documents:t,Mr:n}=e;return n.forEach((e,n)=>{this.Nr.set(e,{size:n,readTime:t.get(e).readTime})}),t})}}function Af(e){return ll(e,wa)}function Df(e){return ll(e,pa)}function Pf(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Rf(e,t){const n=t.documentKey.path.toArray();return[e,od(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Of(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Ws(n[s],r[s]),i)return i;return i=Ws(n.length,r.length),i||(i=Ws(n[n.length-2],r[r.length-2]),i||Ws(n[n.length-1],r[r.length-1]))}class Lf{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class jf{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&qu(n.mutation,e,vl.empty(),go.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,bu()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bu();const r=pu();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=du();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=pu();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,bu()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=uu();const s=gu(),o=gu();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Gu)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),qu(o.mutation,t,o.mutation.getFieldMask(),go.now())):s.set(t.key,vl.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new Lf(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=gu();let r=new dl((e,t)=>e-t),i=bu();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||vl.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||bu()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=mu();l.forEach(e=>{if(!i.has(e)){const r=$u(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return Do.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return ro.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Qc(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Do.resolve(pu());let o=vo,a=i;return s.next(t=>Do.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Do.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,bu())).next(e=>({batchId:o,changes:fu(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ro(t)).next(e=>{let t=du();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=du();return this.indexManager.getCollectionParents(e,i).next(o=>Do.forEach(o,o=>{const a=function(e,t){return new Hc(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,dc.newInvalidDocument(r)))});let n=du();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&qu(s.mutation,r,vl.empty(),go.now()),iu(t,r)&&(n=n.insert(e,r))}),n})}}class Mf{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return Do.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Dh(e.createTime)}}(t)),Do.resolve()}getNamedQuery(e,t){return Do.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(e){return{name:e.name,query:dd(e.bundledQuery),readTime:Dh(e.readTime)}}(t)),Do.resolve()}}class Ff{constructor(){this.overlays=new dl(ro.comparator),this.kr=new Map}getOverlay(e,t){return Do.resolve(this.overlays.get(t))}getOverlays(e,t){const n=pu();return Do.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.wt(e,t,r)}),Do.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.kr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.kr.delete(n)),Do.resolve()}getOverlaysForCollection(e,t,n){const r=pu(),i=t.length+1,s=new ro(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Do.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new dl((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=pu(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=pu(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return Do.resolve(o)}wt(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.kr.get(r.largestBatchId).delete(n.key);this.kr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new nh(t,n));let i=this.kr.get(t);void 0===i&&(i=bu(),this.kr.set(t,i)),this.kr.set(t,i.add(n.key))}}class Vf{constructor(){this.sessionToken=wl.EMPTY_BYTE_STRING}getSessionToken(e){return Do.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Do.resolve()}}class Uf{constructor(){this.qr=new ml(zf.Qr),this.$r=new ml(zf.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const n=new zf(e,t);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Wr(new zf(e,t))}Gr(e,t){e.forEach(e=>this.removeReference(e,t))}zr(e){const t=new ro(new eo([])),n=new zf(t,e),r=new zf(t,e+1),i=[];return this.$r.forEachInRange([n,r],e=>{this.Wr(e),i.push(e.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new ro(new eo([])),n=new zf(t,e),r=new zf(t,e+1);let i=bu();return this.$r.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new zf(e,0),n=this.qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class zf{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return ro.comparator(e.key,t.key)||Ws(e.Hr,t.Hr)}static Ur(e,t){return Ws(e.Hr,t.Hr)||ro.comparator(e.key,t.key)}}class $f{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new ml(zf.Qr)}checkEmpty(e){return Do.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new eh(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.Yr=this.Yr.add(new zf(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Do.resolve(s)}lookupMutationBatch(e,t){return Do.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Xr(n),i=r<0?0:r;return Do.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Do.resolve(0===this.mutationQueue.length?Ko:this.er-1)}getAllMutationBatches(e){return Do.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new zf(t,0),r=new zf(t,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([n,r],e=>{const t=this.Zr(e.Hr);i.push(t)}),Do.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ml(Ws);return t.forEach(e=>{const t=new zf(e,0),r=new zf(e,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([t,r],e=>{n=n.add(e.Hr)})}),Do.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;ro.isDocumentKey(i)||(i=i.child(""));const s=new zf(new ro(i),0);let o=new ml(Ws);return this.Yr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Hr)),!0)},s),Do.resolve(this.ei(o))}ei(e){const t=[];return e.forEach(e=>{const n=this.Zr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){As(0===this.ti(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Yr;return Do.forEach(t.mutations,r=>{const i=new zf(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,t){const n=new zf(t,0),r=this.Yr.firstAfterOrEqual(n);return Do.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Do.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Bf{constructor(e){this.ni=e,this.docs=new dl(ro.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ni(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Do.resolve(n?n.document.mutableCopy():dc.newInvalidDocument(t))}getEntries(e,t){let n=uu();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():dc.newInvalidDocument(e))}),Do.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=uu();const s=t.path,o=new ro(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||To(So(o),n)<=0||(r.has(o.key)||iu(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Do.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Ns(9500)}ri(e,t){return Do.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new qf(this)}getSize(e){return Do.resolve(this.size)}}class qf extends kf{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Or.addEntry(e,r)):this.Or.removeEntry(n)}),Do.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}class Hf{constructor(e){this.persistence=e,this.ii=new lu(e=>Vc(e),Uc),this.lastRemoteSnapshotVersion=yo.min(),this.highestTargetId=0,this.si=0,this.oi=new Uf,this.targetCount=0,this._i=df.ar()}forEachTarget(e,t){return this.ii.forEach((e,n)=>t(n)),Do.resolve()}getLastRemoteSnapshotVersion(e){return Do.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Do.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),Do.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.si&&(this.si=t),Do.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new df(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,Do.resolve()}updateTargetData(e,t){return this.hr(t),Do.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,Do.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.ii.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.ii.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),Do.waitFor(i).next(()=>r)}getTargetCount(e){return Do.resolve(this.targetCount)}getTargetData(e,t){const n=this.ii.get(t)||null;return Do.resolve(n)}addMatchingKeys(e,t,n){return this.oi.Kr(t,n),Do.resolve()}removeMatchingKeys(e,t,n){this.oi.Gr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Do.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),Do.resolve()}getMatchingKeysForTargetId(e,t){const n=this.oi.Jr(t);return Do.resolve(n)}containsKey(e,t){return Do.resolve(this.oi.containsKey(t))}}class Wf{constructor(e,t){this.ai={},this.overlays={},this.ui=new Wo(0),this.ci=!1,this.ci=!0,this.li=new Vf,this.referenceDelegate=e(this),this.hi=new Hf(this),this.indexManager=new Hd,this.remoteDocumentCache=function(e){return new Bf(e)}(e=>this.referenceDelegate.Pi(e)),this.serializer=new id(t),this.Ti=new Mf(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ff,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ai[e.toKey()];return n||(n=new $f(t,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,n){Es("MemoryPersistence","Starting transaction:",e);const r=new Kf(this.ui.next());return this.referenceDelegate.Ii(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ei(e,t){return Do.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,t)))}}class Kf extends Co{constructor(e){super(),this.currentSequenceNumber=e}}class Gf{constructor(e){this.persistence=e,this.Ai=new Uf,this.Ri=null}static Vi(e){return new Gf(e)}get mi(){if(this.Ri)return this.Ri;throw Ns(60996)}addReference(e,t,n){return this.Ai.addReference(n,t),this.mi.delete(n.toString()),Do.resolve()}removeReference(e,t,n){return this.Ai.removeReference(n,t),this.mi.add(n.toString()),Do.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),Do.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(e=>this.mi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.mi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Do.forEach(this.mi,n=>{const r=ro.fromPath(n);return this.fi(e,r).next(e=>{e||t.removeEntry(r,yo.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(e=>{e?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return Do.or([()=>Do.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Qf{constructor(e,t){this.persistence=e,this.gi=new lu(e=>Yo(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=If(this,t)}static Vi(e,t){return new Qf(e,t)}Ii(){}di(e){return Do.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}yr(e){let t=0;return this.gr(e,e=>{t++}).next(()=>t)}gr(e,t){return Do.forEach(this.gi,(n,r)=>this.Sr(e,n,r).next(e=>e?Do.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ri(e,r=>this.Sr(e,r,t).next(e=>{e||(n++,i.removeEntry(r,yo.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),Do.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),Do.resolve()}removeReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),Do.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),Do.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ql(e.data.value)),t}Sr(e,t,n){return Do.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.gi.get(t);return Do.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Xf{constructor(e){this.serializer=e}q(e,t,n,r){const i=new Ro("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(ra)}(e),function(e){e.createObjectStore(sa,{keyPath:"userId"});e.createObjectStore(oa,{keyPath:aa,autoIncrement:!0}).createIndex(la,ca,{unique:!0}),e.createObjectStore(fa)}(e),Jf(e),function(e){e.createObjectStore(na)}(e));let s=Do.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(Sa),e.deleteObjectStore(_a),e.deleteObjectStore(Aa)}(e),Jf(e)),s=s.next(()=>function(e){const t=e.store(Aa),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:yo.min().toTimestamp(),targetCount:0};return t.put(Ca,n)}(i))),n<4&&r>=4&&(0!==n&&(s=s.next(()=>function(e,t){return t.store(oa).j().next(n=>{e.deleteObjectStore(oa),e.createObjectStore(oa,{keyPath:aa,autoIncrement:!0}).createIndex(la,ca,{unique:!0});const r=t.store(oa),i=n.map(e=>r.put(e));return Do.waitFor(i)})}(e,i))),s=s.next(()=>{!function(e){e.createObjectStore(Ra,{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(s=s.next(()=>this.pi(i))),n<6&&r>=6&&(s=s.next(()=>(function(e){e.createObjectStore(wa)}(e),this.yi(i)))),n<7&&r>=7&&(s=s.next(()=>this.wi(i))),n<8&&r>=8&&(s=s.next(()=>this.Si(e,i))),n<9&&r>=9&&(s=s.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(s=s.next(()=>this.bi(i))),n<11&&r>=11&&(s=s.next(()=>{!function(e){e.createObjectStore(Oa,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(La,{keyPath:"name"})}(e)})),n<12&&r>=12&&(s=s.next(()=>{!function(e){const t=e.createObjectStore(Wa,{keyPath:Ka});t.createIndex(Ga,Qa,{unique:!1}),t.createIndex(Xa,Ja,{unique:!1})}(e)})),n<13&&r>=13&&(s=s.next(()=>function(e){const t=e.createObjectStore(pa,{keyPath:ma});t.createIndex(ga,ya),t.createIndex(va,ba)}(e)).next(()=>this.Di(e,i)).next(()=>e.deleteObjectStore(na))),n<14&&r>=14&&(s=s.next(()=>this.Ci(e,i))),n<15&&r>=15&&(s=s.next(()=>function(e){e.createObjectStore(ja,{keyPath:"indexId",autoIncrement:!0}).createIndex(Ma,"collectionGroup",{unique:!1});e.createObjectStore(Fa,{keyPath:Va}).createIndex(Ua,za,{unique:!1});e.createObjectStore($a,{keyPath:Ba}).createIndex(qa,Ha,{unique:!1})}(e))),n<16&&r>=16&&(s=s.next(()=>{t.objectStore(Fa).clear()}).next(()=>{t.objectStore($a).clear()})),n<17&&r>=17&&(s=s.next(()=>{!function(e){e.createObjectStore(Ya,{keyPath:"name"})}(e)})),n<18&&r>=18&&K()&&(s=s.next(()=>{t.objectStore(Fa).clear()}).next(()=>{t.objectStore($a).clear()})),s}yi(e){let t=0;return e.store(na).X((e,n)=>{t+=of(n)}).next(()=>{const n={byteSize:t};return e.store(wa).put(xa,n)})}pi(e){const t=e.store(sa),n=e.store(oa);return t.j().next(t=>Do.forEach(t,t=>{const r=IDBKeyRange.bound([t.userId,Ko],[t.userId,t.lastAcknowledgedBatchId]);return n.j(la,r).next(n=>Do.forEach(n,n=>{As(n.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:n.batchId});const r=cd(this.serializer,n);return sf(e,t.userId,r).next(()=>{})}))}))}wi(e){const t=e.store(Sa),n=e.store(na);return e.store(Aa).get(Ca).next(e=>{const r=[];return n.X((n,i)=>{const s=new eo(n),o=function(e){return[0,Yo(e)]}(s);r.push(t.get(o).next(n=>n?Do.resolve():(n=>t.put({targetId:0,path:Yo(n),sequenceNumber:e.highestListenSequenceNumber}))(s)))}).next(()=>Do.waitFor(r))})}Si(e,t){e.createObjectStore(Da,{keyPath:Pa});const n=t.store(Da),r=new Wd,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Yo(r)})}};return t.store(na).X({Z:!0},(e,t)=>{const n=new eo(e);return i(n.popLast())}).next(()=>t.store(fa).X({Z:!0},(e,t)=>{let[n,r,s]=e;const o=ta(r);return i(o.popLast())}))}bi(e){const t=e.store(_a);return t.X((e,n)=>{const r=ud(n),i=hd(this.serializer,r);return t.put(i)})}Di(e,t){const n=t.store(na),r=[];return n.X((e,n)=>{const i=t.store(pa),s=function(e){return e.document?new ro(eo.fromString(e.document.name).popFirst(5)):e.noDocument?ro.fromSegments(e.noDocument.path):e.unknownDocument?ro.fromSegments(e.unknownDocument.path):Ns(36783)}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))}).next(()=>Do.waitFor(r))}Ci(e,t){const n=t.store(oa),r=Nf(this.serializer),i=new Wf(Gf.Vi,this.serializer.gt);return n.j().next(e=>{const n=new Map;return e.forEach(e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:bu();cd(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),Do.forEach(n,(e,n)=>{const s=new ws(n),o=bd.yt(this.serializer,s),a=i.getIndexManager(s),l=af.yt(s,this.serializer,a,i.referenceDelegate);return new jf(r,l,o,a).recalculateAndSaveOverlaysForDocumentKeys(new al(t,Wo.ue),e).next()})})}}function Jf(e){e.createObjectStore(Sa,{keyPath:ka}).createIndex(Ta,Na,{unique:!0}),e.createObjectStore(_a,{keyPath:"targetId"}).createIndex(Ia,Ea,{unique:!0}),e.createObjectStore(Aa)}const Yf="IndexedDbPersistence",Zf=18e5,ep=5e3,tp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",np="main";class rp{constructor(e,t,n,r,i,s,o,a,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:18;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Fi=i,this.window=s,this.document=o,this.Mi=l,this.xi=c,this.Oi=u,this.ui=null,this.ci=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.Bi=null,this.Li=null,this.ki=Number.NEGATIVE_INFINITY,this.qi=e=>Promise.resolve(),!rp.C())throw new Rs(Ps.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ef(this,r),this.Qi=t+np,this.serializer=new id(a),this.$i=new Oo(this.Qi,this.Oi,new Xf(this.serializer)),this.li=new xd,this.hi=new ff(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Nf(this.serializer),this.Ti=new gd,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,!1===c&&Ss(Yf,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ki().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Rs(Ps.FAILED_PRECONDITION,tp);return this.Wi(),this.Gi(),this.zi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.hi.getHighestSequenceNumber(e))}).then(e=>{this.ui=new Wo(e,this.Mi)}).then(()=>{this.ci=!0}).catch(e=>(this.$i&&this.$i.close(),Promise.reject(e)))}ji(e){return this.qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.$i.setDatabaseDeletedListener(e)}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Fi.enqueueAndForget(async()=>{this.started&&await this.Ki()}))}Ki(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>sp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ji(e).next(e=>{e||(this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Yi(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if(Fo(e))return Es(Yf,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Es(Yf,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Fi.enqueueRetryable(()=>this.qi(e)),this.isPrimary=e})}Ji(e){return ip(e).get(ia).next(e=>Do.resolve(this.Xi(e)))}es(e){return sp(e).delete(this.clientId)}async ts(){if(this.isPrimary&&!this.ns(this.ki,Zf)){this.ki=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=ll(e,Ra);return t.j().next(e=>{const n=this.rs(e,Zf),r=e.filter(e=>-1===n.indexOf(e));return Do.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this.Ui)for(const t of e)this.Ui.removeItem(this.ss(t.clientId))}}zi(){this.Li=this.Fi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ki().then(()=>this.ts()).then(()=>this.zi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.xi?Do.resolve(!0):ip(e).get(ia).next(t=>{if(null!==t&&this.ns(t.leaseTimestampMs,ep)&&!this._s(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new Rs(Ps.FAILED_PRECONDITION,tp);return!1}}return!(!this.networkEnabled||!this.inForeground)||sp(e).j().next(e=>void 0===this.rs(e,ep).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&Es(Yf,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.ci=!1,this.us(),this.Li&&(this.Li.cancel(),this.Li=null),this.cs(),this.ls(),await this.$i.runTransaction("shutdown","readwrite",[ra,Ra],e=>{const t=new al(e,Wo.ue);return this.Yi(t).next(()=>this.es(t))}),this.$i.close(),this.hs()}rs(e,t){return e.filter(e=>this.ns(e.updateTimeMs,t)&&!this._s(e.clientId))}Ps(){return this.runTransaction("getActiveClients","readonly",e=>sp(e).j().next(e=>this.rs(e,Zf).map(e=>e.clientId)))}get started(){return this.ci}getGlobalsCache(){return this.li}getMutationQueue(e,t){return af.yt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Qd(e,this.serializer.gt.databaseId)}getDocumentOverlayCache(e){return bd.yt(this.serializer,e)}getBundleCache(){return this.Ti}runTransaction(e,t,n){Es(Yf,"Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 18===e?ol:17===e?sl:16===e?il:15===e?rl:14===e?nl:13===e?tl:12===e?el:11===e?Za:void Ns(60245)}(this.Oi);let s;return this.$i.runTransaction(e,r,i,r=>(s=new al(r,this.ui?this.ui.next():Wo.ue),"readwrite-primary"===t?this.Ji(s).next(e=>!!e||this.Hi(s)).next(t=>{if(!t)throw Ss(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)),new Rs(Ps.FAILED_PRECONDITION,No);return n(s)}).next(e=>this.Zi(s).next(()=>e)):this.Ts(s).next(()=>n(s)))).then(e=>(s.raiseOnCommittedEvent(),e))}Ts(e){return ip(e).get(ia).next(e=>{if(null!==e&&this.ns(e.leaseTimestampMs,ep)&&!this._s(e.ownerId)&&!this.Xi(e)&&!(this.xi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Rs(Ps.FAILED_PRECONDITION,tp)})}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ip(e).put(ia,t)}static C(){return Oo.C()}Yi(e){const t=ip(e);return t.get(ia).next(e=>this.Xi(e)?(Es(Yf,"Releasing primary lease."),t.delete(ia)):Do.resolve())}ns(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Ss(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Wi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bi=()=>{this.Fi.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Ki()))},this.document.addEventListener("visibilitychange",this.Bi),this.inForeground="visible"===this.document.visibilityState)}cs(){this.Bi&&(this.document.removeEventListener("visibilitychange",this.Bi),this.Bi=null)}Gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ni=()=>{this.us();const e=/(?:Version|Mobile)\/1[456]/;W()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Fi.enterRestrictedMode(!0),this.Fi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ni))}ls(){this.Ni&&(this.window.removeEventListener("pagehide",this.Ni),this.Ni=null)}_s(e){var t;try{const n=null!==(null===(t=this.Ui)||void 0===t?void 0:t.getItem(this.ss(e)));return Es(Yf,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return Ss(Yf,"Failed to get zombied client id.",e),!1}}us(){if(this.Ui)try{this.Ui.setItem(this.ss(this.clientId),String(Date.now()))}catch(e){Ss("Failed to set zombie client id.",e)}}hs(){if(this.Ui)try{this.Ui.removeItem(this.ss(this.clientId))}catch(e){}}ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ip(e){return ll(e,ra)}function sp(e){return ll(e,Ra)}function op(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class ap{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Is=n,this.ds=r}static Es(e,t){let n=bu(),r=bu();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new ap(e,t.fromCache,n,r)}}class lp{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class cp{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=W()?8:Lo(q())>0?6:4}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ps(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ys(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new lp;return this.ws(e,t,n).next(r=>{if(i.result=r,this.Rs)return this.Ss(e,t,n,r.size)})}).next(()=>i.result)}Ss(e,t,n,r){return n.documentReadCount<this.Vs?(Is()<=he.DEBUG&&Es("QueryEngine","SDK will not create cache indexes for query:",ru(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Do.resolve()):(Is()<=he.DEBUG&&Es("QueryEngine","Query:",ru(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.fs*r?(Is()<=he.DEBUG&&Es("QueryEngine","The SDK decides to create cache indexes for query:",ru(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jc(t))):Do.resolve())}ps(e,t){if(Gc(t))return Do.resolve(null);let n=Jc(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=eu(t,null,"F"),n=Jc(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=bu(...r);return this.gs.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.bs(t,r);return this.Ds(t,s,i,n.readTime)?this.ps(e,eu(t,null,"F")):this.vs(e,s,t,n)}))})))}ys(e,t,n,r){return Gc(t)||r.isEqual(yo.min())?Do.resolve(null):this.gs.getDocuments(e,n).next(i=>{const s=this.bs(t,i);return this.Ds(t,s,n,r)?Do.resolve(null):(Is()<=he.DEBUG&&Es("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ru(t)),this.vs(e,s,t,Eo(r,vo)).next(e=>e))})}bs(e,t){let n=new ml(ou(e));return t.forEach((t,r)=>{iu(e,r)&&(n=n.add(r))}),n}Ds(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}ws(e,t,n){return Is()<=he.DEBUG&&Es("QueryEngine","Using full collection scan to execute query:",ru(t)),this.gs.getDocumentsMatchingQuery(e,t,ko.min(),n)}vs(e,t,n,r){return this.gs.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const up="LocalStore",hp=3e8;class dp{constructor(e,t,n,r){this.persistence=e,this.Cs=t,this.serializer=r,this.Fs=new dl(Ws),this.Ms=new lu(e=>Vc(e),Uc),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jf(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function fp(e,t,n,r){return new dp(e,t,n,r)}async function pp(e,t){const n=Ds(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Ns(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=bu();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Bs:e,removedBatchIds:i,addedBatchIds:s}))})})}function mp(e){const t=Ds(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.hi.getLastRemoteSnapshotVersion(e))}function gp(e,t,n){let r=bu(),i=bu();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=uu();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(yo.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):Es(up,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Ls:r,ks:i}})}function yp(e,t){const n=Ds(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Ko),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function vp(e,t){const n=Ds(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.hi.getTargetData(e,t).next(i=>i?(r=i,Do.resolve(r)):n.hi.allocateTargetId(e).next(i=>(r=new rd(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.hi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Fs.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(e.targetId,e),n.Ms.set(t,e.targetId)),e})}async function bp(e,t,n){const r=Ds(e),i=r.Fs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!Fo(e))throw e;Es(up,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function wp(e,t,n){const r=Ds(e);let i=yo.min(),s=bu();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=Ds(e),i=r.Ms.get(n);return void 0!==i?Do.resolve(r.Fs.get(i)):r.hi.getTargetData(t,n)}(r,e,Jc(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Cs.getDocumentsMatchingQuery(e,t,n?i:yo.min(),n?s:bu())).next(e=>(xp(r,su(t),e),{documents:e,qs:s})))}function xp(e,t,n){let r=e.xs.get(t)||yo.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.xs.set(t,r)}class _p{constructor(){this.activeTargetIds=xu()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ip{constructor(){this.Fo=new _p,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,n){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new _p,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ep{xo(e){}shutdown(){}}const Sp="ConnectivityMonitor";class kp{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Es(Sp,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Es(Sp,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Tp=null;function Np(){return null===Tp?Tp=268435456+Math.round(2147483648*Math.random()):Tp++,"0x"+Tp.toString(16)}const Cp="RestConnection",Ap={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Dp{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${n}/databases/${r}`,this.Ko=this.databaseId.database===Rl?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Wo(e,t,n,r,i){const s=Np(),o=this.Go(e,t.toUriEncodedString());Es(Cp,`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(a,r,i);const{host:l}=new URL(o),c=V(l);return this.jo(e,o,a,n,c).then(t=>(Es(Cp,`Received RPC '${e}' ${s}: `,t),t),t=>{throw ks(Cp,`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t})}Jo(e,t,n,r,i,s){return this.Wo(e,t,n,r,i)}zo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+xs,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}Go(e,t){const n=Ap[e];return`${this.$o}/v1/${t}:${n}`}terminate(){}}class Pp{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}const Rp="WebChannelConnection";class Op extends Dp{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,n,r,i){const s=Np();return new Promise((i,o)=>{const a=new ls;a.setWithCredentials(!0),a.listenOnce(us.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case hs.NO_ERROR:const t=a.getResponseJson();Es(Rp,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case hs.TIMEOUT:Es(Rp,`RPC '${e}' ${s} timed out`),o(new Rs(Ps.DEADLINE_EXCEEDED,"Request time out"));break;case hs.HTTP_ERROR:const n=a.getStatus();if(Es(Rp,`RPC '${e}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Ps).indexOf(t)>=0?t:Ps.UNKNOWN}(t.status);o(new Rs(e,t.message))}else o(new Rs(Ps.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Rs(Ps.UNAVAILABLE,"Connection failed."));break;default:Ns(9055,{c_:e,streamId:s,l_:a.getLastErrorCode(),h_:a.getLastError()})}}finally{Es(Rp,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(r);Es(Rp,`RPC '${e}' ${s} sending request:`,r),a.send(t,"POST",l,n,15)})}P_(e,t,n){const r=Np(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=ms(),o=ps(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.zo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");Es(Rp,`Creating RPC '${e}' stream ${r}: ${c}`,a);const u=s.createWebChannel(c,a);this.T_(u);let h=!1,d=!1;const f=new Pp({Ho:t=>{d?Es(Rp,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(Es(Rp,`Opening RPC '${e}' stream ${r} transport.`),u.open(),h=!0),Es(Rp,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Yo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,cs.EventType.OPEN,()=>{d||(Es(Rp,`RPC '${e}' stream ${r} transport opened.`),f.s_())}),p(u,cs.EventType.CLOSE,()=>{d||(d=!0,Es(Rp,`RPC '${e}' stream ${r} transport closed`),f.__(),this.I_(u))}),p(u,cs.EventType.ERROR,t=>{d||(d=!0,ks(Rp,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),f.__(new Rs(Ps.UNAVAILABLE,"The operation could not be completed")))}),p(u,cs.EventType.MESSAGE,t=>{var n;if(!d){const i=t.data[0];As(!!i,16349);const s=i,o=(null==s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Es(Rp,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=ih[e];if(void 0!==t)return ah(t)}(t),i=o.message;void 0===n&&(n=Ps.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),d=!0,f.__(new Rs(n,i)),u.close()}else Es(Rp,`RPC '${e}' stream ${r} received:`,i),f.a_(i)}}),p(o,fs.STAT_EVENT,t=>{t.stat===ds.PROXY?Es(Rp,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===ds.NOPROXY&&Es(Rp,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.o_()},0),f}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function Lp(){return"undefined"!=typeof window?window:null}function jp(){return"undefined"!=typeof document?document:null}function Mp(e){return new kh(e,!0)}class Fp{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Fi=e,this.timerId=t,this.d_=n,this.E_=r,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),r=Math.max(0,t-n);r>0&&Es("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){null!==this.V_&&(this.V_.skipDelay(),this.V_=null)}cancel(){null!==this.V_&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}const Vp="PersistentStream";class Up{constructor(e,t,n,r,i,s,o,a){this.Fi=e,this.w_=n,this.S_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Fp(e,t)}M_(){return 1===this.state||5===this.state||this.x_()}x_(){return 2===this.state||3===this.state}start(){this.C_=0,4!==this.state?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&null===this.D_&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,4!==e?this.F_.reset():t&&t.code===Ps.RESOURCE_EXHAUSTED?(Ss(t.toString()),Ss("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===Ps.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.b_===t&&this.W_(n,r)},t=>{e(()=>{const e=new Rs(Ps.UNKNOWN,"Fetching auth token failed: "+t.message);return this.G_(e)})})}W_(e,t){const n=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(e=>{n(()=>this.G_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.C_?this.j_(e):this.onNext(e))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return Es(Vp,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(Es(Vp,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zp extends Up{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Ns(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(As(void 0===t||"string"==typeof t,58123),wl.fromBase64String(t||"")):(As(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),wl.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Ps.UNKNOWN:ah(e.code);return new Rs(t,e.message||"")}(o);n=new vh(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=jh(e,r.document.name),s=Dh(r.document.updateTime),o=r.document.createTime?Dh(r.document.createTime):yo.min(),a=new uc({mapValue:{fields:r.document.fields}}),l=dc.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new gh(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=jh(e,r.document),s=r.readTime?Dh(r.readTime):yo.min(),o=dc.newNoDocument(i,s),a=r.removedTargetIds||[];n=new gh([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=jh(e,r.document),s=r.removedTargetIds||[];n=new gh([],s,i,null)}else{if(!("filter"in t))return Ns(11601,{At:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new rh(r,i),o=e.targetId;n=new yh(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return yo.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?yo.min():t.readTime?Dh(t.readTime):yo.min()}(e);return this.listener.J_(t,n)}H_(e){const t={};t.database=Vh(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=zc(r)?{documents:Hh(e,r)}:{query:Wh(e,r).Vt},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Ch(e,t.resumeToken);const r=Th(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(yo.min())>0){n.readTime=Nh(e,t.snapshotVersion.toTimestamp());const r=Th(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ns(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.k_(t)}Y_(e){const t={};t.database=Vh(this.serializer),t.removeTarget=e,this.k_(t)}}class $p extends Up{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return As(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,As(!e.writeResults||0===e.writeResults.length,55816),this.listener.ea()}onNext(e){As(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=function(e,t){return e&&e.length>0?(As(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Dh(e.updateTime):Dh(t);return n.isEqual(yo.min())&&(n=Dh(t)),new Fu(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Dh(e.commitTime);return this.listener.ta(n,t)}na(){const e={};e.database=Vh(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Bh(this.serializer,e))};this.k_(t)}}class Bp{}class qp extends Bp{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new Rs(Ps.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.connection.Wo(e,Rh(t,n),r,s,o)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Ps.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Rs(Ps.UNKNOWN,e.toString())})}Jo(e,t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[o,a]=s;return this.connection.Jo(e,Rh(t,n),r,o,a,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Ps.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Rs(Ps.UNKNOWN,e.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class Hp{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){0===this.sa&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){"Online"===this.state?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,"Online"===e&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Ss(t),this._a=!1):Es("OnlineStateTracker",t)}ha(){null!==this.oa&&(this.oa.cancel(),this.oa=null)}}const Wp="RemoteStore";class Kp{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(e=>{n.enqueueAndForget(async()=>{nm(this)&&(Es(Wp,"Restarting streams for network reachability change."),await async function(e){const t=Ds(e);t.Ia.add(4),await Qp(t),t.Aa.set("Unknown"),t.Ia.delete(4),await Gp(t)}(this))})}),this.Aa=new Hp(n,r)}}async function Gp(e){if(nm(e))for(const t of e.da)await t(!0)}async function Qp(e){for(const t of e.da)await t(!1)}function Xp(e,t){const n=Ds(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),tm(n)?em(n):xm(n).x_()&&Yp(n,t))}function Jp(e,t){const n=Ds(e),r=xm(n);n.Ta.delete(t),r.x_()&&Zp(n,t),0===n.Ta.size&&(r.x_()?r.B_():nm(n)&&n.Aa.set("Unknown"))}function Yp(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(yo.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}xm(e).H_(t)}function Zp(e,t){e.Ra.$e(t),xm(e).Y_(t)}function em(e){e.Ra=new wh({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),xm(e).start(),e.Aa.aa()}function tm(e){return nm(e)&&!xm(e).M_()&&e.Ta.size>0}function nm(e){return 0===Ds(e).Ia.size}function rm(e){e.Ra=void 0}async function im(e){e.Aa.set("Online")}async function sm(e){e.Ta.forEach((t,n)=>{Yp(e,t)})}async function om(e,t){rm(e),tm(e)?(e.Aa.la(t),em(e)):e.Aa.set("Unknown")}async function am(e,t,n){if(e.Aa.set("Online"),t instanceof vh&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ta.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ta.delete(r),e.Ra.removeTarget(r))}(e,t)}catch(n){Es(Wp,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await lm(e,n)}else if(t instanceof gh?e.Ra.Ye(t):t instanceof yh?e.Ra.it(t):e.Ra.et(t),!n.isEqual(yo.min()))try{const t=await mp(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Ra.Pt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ta.get(r);i&&e.Ta.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ta.get(t);if(!r)return;e.Ta.set(t,r.withResumeToken(wl.EMPTY_BYTE_STRING,r.snapshotVersion)),Zp(e,t);const i=new rd(r.target,t,n,r.sequenceNumber);Yp(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Es(Wp,"Failed to raise snapshot:",t),await lm(e,t)}}async function lm(e,t,n){if(!Fo(t))throw t;e.Ia.add(1),await Qp(e),e.Aa.set("Offline"),n||(n=()=>mp(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Es(Wp,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await Gp(e)})}function cm(e,t){return t().catch(n=>lm(e,n,t))}async function um(e){const t=Ds(e),n=_m(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:Ko;for(;hm(t);)try{const e=await yp(t.localStore,r);if(null===e){0===t.Pa.length&&n.B_();break}r=e.batchId,dm(t,e)}catch(e){await lm(t,e)}fm(t)&&pm(t)}function hm(e){return nm(e)&&e.Pa.length<10}function dm(e,t){e.Pa.push(t);const n=_m(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function fm(e){return nm(e)&&!_m(e).M_()&&e.Pa.length>0}function pm(e){_m(e).start()}async function mm(e){_m(e).na()}async function gm(e){const t=_m(e);for(const n of e.Pa)t.X_(n.mutations)}async function ym(e,t,n){const r=e.Pa.shift(),i=th.from(r,t,n);await cm(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await um(e)}async function vm(e,t){t&&_m(e).Z_&&await async function(e,t){if(function(e){return oh(e)&&e!==Ps.ABORTED}(t.code)){const n=e.Pa.shift();_m(e).N_(),await cm(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await um(e)}}(e,t),fm(e)&&pm(e)}async function bm(e,t){const n=Ds(e);n.asyncQueue.verifyOperationInProgress(),Es(Wp,"RemoteStore received new credentials");const r=nm(n);n.Ia.add(3),await Qp(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await Gp(n)}async function wm(e,t){const n=Ds(e);t?(n.Ia.delete(2),await Gp(n)):t||(n.Ia.add(2),await Qp(n),n.Aa.set("Unknown"))}function xm(e){return e.Va||(e.Va=function(e,t,n){const r=Ds(e);return r.ia(),new zp(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Zo:im.bind(null,e),e_:sm.bind(null,e),n_:om.bind(null,e),J_:am.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),tm(e)?em(e):e.Aa.set("Unknown")):(await e.Va.stop(),rm(e))})),e.Va}function _m(e){return e.ma||(e.ma=function(e,t,n){const r=Ds(e);return r.ia(),new $p(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:mm.bind(null,e),n_:vm.bind(null,e),ea:gm.bind(null,e),ta:ym.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await um(e)):(await e.ma.stop(),e.Pa.length>0&&(Es(Wp,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}class Im{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Os,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Im(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Rs(Ps.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Em(e,t){if(Ss("AsyncQueue",`${t}: ${e}`),Fo(e))return new Rs(Ps.UNAVAILABLE,`${t}: ${e}`);throw e}class Sm{static emptySet(e){return new Sm(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||ro.comparator(t.key,n.key):(e,t)=>ro.comparator(e.key,t.key),this.keyedMap=du(),this.sortedSet=new dl(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Sm))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Sm;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class km{constructor(){this.fa=new dl(ro.comparator)}track(e){const t=e.doc.key,n=this.fa.get(t);n?0!==e.type&&3===n.type?this.fa=this.fa.insert(t,e):3===e.type&&1!==n.type?this.fa=this.fa.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.fa=this.fa.remove(t):1===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Ns(63341,{At:e,ga:n}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,n)=>{e.push(n)}),e}}class Tm{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Tm(e,t,Sm.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&tu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Nm{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class Cm{constructor(){this.queries=Am(),this.onlineState="Unknown",this.Da=new Set}terminate(){!function(e,t){const n=Ds(e),r=n.queries;n.queries=Am(),r.forEach((e,n)=>{for(const r of n.wa)r.onError(t)})}(this,new Rs(Ps.ABORTED,"Firestore shutting down"))}}function Am(){return new lu(e=>nu(e),tu)}async function Dm(e,t){const n=Ds(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Sa()&&t.ba()&&(r=2):(s=new Nm,r=t.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Em(e,`Initialization of query '${ru(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.wa.push(t),t.va(n.onlineState),s.ya&&t.Ca(s.ya)&&Lm(n)}async function Pm(e,t){const n=Ds(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.wa.indexOf(t);e>=0&&(s.wa.splice(e,1),0===s.wa.length?i=t.ba()?0:1:!s.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Rm(e,t){const n=Ds(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.wa)e.Ca(i)&&(r=!0);t.ya=i}}r&&Lm(n)}function Om(e,t,n){const r=Ds(e),i=r.queries.get(t);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(t)}function Lm(e){e.Da.forEach(e=>{e.next()})}var jm,Mm;(Mm=jm||(jm={})).Fa="default",Mm.Cache="cache";class Fm{constructor(e,t,n){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Tm(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache)return!0;if(!this.ba())return!0;const n="Offline"!==t;return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}La(e){e=Tm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==jm.Cache}}class Vm{constructor(e){this.key=e}}class Um{constructor(e){this.key=e}}class zm{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=bu(),this.mutatedKeys=bu(),this.Xa=ou(e),this.eu=new Sm(this.Xa)}get tu(){return this.Ha}nu(e,t){const n=t?t.ru:new km,r=t?t.eu:this.eu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=iu(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.iu(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Xa(u,a)>0||l&&this.Xa(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{eu:s,ru:n,Ds:o,mutatedKeys:i}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const s=e.ru.pa();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ns(20277,{At:e})}};return n(e)-n(t)}(e.type,t.type)||this.Xa(e.doc,t.doc)),this.su(n),r=null!=r&&r;const o=t&&!r?this.ou():[],a=0===this.Za.size&&this.current&&!r?1:0,l=a!==this.Ya;return this.Ya=a,0!==s.length||l?{snapshot:new Tm(this.query,e.eu,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:o}:{_u:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({eu:this.eu,ru:new km,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(e=>this.Ha=this.Ha.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ha=this.Ha.delete(e)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=bu(),this.eu.forEach(e=>{this.au(e.key)&&(this.Za=this.Za.add(e.key))});const t=[];return e.forEach(e=>{this.Za.has(e)||t.push(new Um(e))}),this.Za.forEach(n=>{e.has(n)||t.push(new Vm(n))}),t}uu(e){this.Ha=e.qs,this.Za=bu();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Tm.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,0===this.Ya,this.hasCachedResults)}}const $m="SyncEngine";class Bm{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class qm{constructor(e){this.key=e,this.lu=!1}}class Hm{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.hu={},this.Pu=new lu(e=>nu(e),tu),this.Tu=new Map,this.Iu=new Set,this.du=new dl(ro.comparator),this.Eu=new Map,this.Au=new Uf,this.Ru={},this.Vu=new Map,this.mu=df.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return!0===this.fu}}async function Wm(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=fg(e);let i;const s=r.Pu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await Gm(r,t,n,!0),i}async function Km(e,t){const n=fg(e);await Gm(n,t,!0,!1)}async function Gm(e,t,n,r){const i=await vp(e.localStore,Jc(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Qm(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&Xp(e.remoteStore,i),a}async function Qm(e,t,n,r,i){e.gu=(t,n,r)=>async function(e,t,n,r){let i=t.view.nu(n);i.Ds&&(i=await wp(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.nu(n,i)}));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return ag(e,t.targetId,a._u),a.snapshot}(e,t,n,r);const s=await wp(e.localStore,t,!0),o=new zm(t,s.qs),a=o.nu(s.documents),l=mh.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);ag(e,n,c._u);const u=new Bm(t,n,o);return e.Pu.set(t,u),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),c.snapshot}async function Xm(e,t,n){const r=Ds(e),i=r.Pu.get(t),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(e=>!tu(e,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await bp(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Jp(r.remoteStore,i.targetId),sg(r,i.targetId)}).catch(Ao)):(sg(r,i.targetId),await bp(r.localStore,i.targetId,!0))}async function Jm(e,t){const n=Ds(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Jp(n.remoteStore,r.targetId))}async function Ym(e,t){const n=Ds(e);try{const e=await function(e,t){const n=Ds(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.hi.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.hi.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(wl.EMPTY_BYTE_STRING,yo.min()).withLastLimboFreeSnapshotVersion(yo.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=hp||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,s)&&o.push(n.hi.updateTargetData(e,c))});let a=uu(),l=bu();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(gp(e,s,t.documentUpdates).next(e=>{a=e.Ls,l=e.ks})),!r.isEqual(yo.min())){const t=n.hi.getLastRemoteSnapshotVersion(e).next(t=>n.hi.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return Do.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Fs=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Eu.get(t);r&&(As(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.lu=!0:e.modifiedDocuments.size>0?As(r.lu,14607):e.removedDocuments.size>0&&(As(r.lu,42227),r.lu=!1))}),await ug(n,e,t)}catch(e){await Ao(e)}}function Zm(e,t,n){const r=Ds(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Pu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=Ds(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.wa)i.va(t)&&(r=!0)}),r&&Lm(n)}(r.eventManager,t),e.length&&r.hu.J_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function eg(e,t,n){const r=Ds(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let e=new dl(ro.comparator);e=e.insert(s,dc.newNoDocument(s,yo.min()));const n=bu().add(s),i=new ph(yo.min(),new Map,new dl(Ws),e,n);await Ym(r,i),r.du=r.du.remove(s),r.Eu.delete(t),cg(r)}else await bp(r.localStore,t,!1).then(()=>sg(r,t,n)).catch(Ao)}async function tg(e,t){const n=Ds(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Ds(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Do.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);As(null!==s,48541),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=bu();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);ig(n,r,null),rg(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ug(n,e)}catch(e){await Ao(e)}}async function ng(e,t,n){const r=Ds(e);try{const e=await function(e,t){const n=Ds(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(As(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);ig(r,t,n),rg(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await ug(r,e)}catch(n){await Ao(n)}}function rg(e,t){(e.Vu.get(t)||[]).forEach(e=>{e.resolve()}),e.Vu.delete(t)}function ig(e,t,n){const r=Ds(e);let i=r.Ru[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function sg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(t=>{e.Au.containsKey(t)||og(e,t)})}function og(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Jp(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),cg(e))}function ag(e,t,n){for(const r of n)r instanceof Vm?(e.Au.addReference(r.key,t),lg(e,r)):r instanceof Um?(Es($m,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||og(e,r.key)):Ns(19791,{yu:r})}function lg(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(Es($m,"New document in limbo: "+n),e.Iu.add(r),cg(e))}function cg(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new ro(eo.fromString(t)),r=e.mu.next();e.Eu.set(r,new qm(n)),e.du=e.du.insert(n,r),Xp(e.remoteStore,new rd(Jc(Kc(n.path)),r,"TargetPurposeLimboResolution",Wo.ue))}}async function ug(e,t,n){const r=Ds(e),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((e,a)=>{o.push(r.gu(a,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=ap.Es(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.hu.J_(i),await async function(e,t){const n=Ds(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Do.forEach(t,t=>Do.forEach(t.Is,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Do.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!Fo(e))throw e;Es(up,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Fs.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Fs=n.Fs.insert(e,i)}}}(r.localStore,s))}async function hg(e,t){const n=Ds(e);if(!n.currentUser.isEqual(t)){Es($m,"User change. New user:",t.toKey());const e=await pp(n.localStore,t);n.currentUser=t,function(e,t){e.Vu.forEach(e=>{e.forEach(e=>{e.reject(new Rs(Ps.CANCELLED,t))})}),e.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await ug(n,e.Bs)}}function dg(e,t){const n=Ds(e),r=n.Eu.get(t);if(r&&r.lu)return bu().add(r.key);{let e=bu();const r=n.Tu.get(t);if(!r)return e;for(const t of r){const r=n.Pu.get(t);e=e.unionWith(r.view.tu)}return e}}function fg(e){const t=Ds(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ym.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=dg.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=eg.bind(null,t),t.hu.J_=Rm.bind(null,t.eventManager),t.hu.pu=Om.bind(null,t.eventManager),t}function pg(e){const t=Ds(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=tg.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=ng.bind(null,t),t}class mg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Mp(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return fp(this.persistence,new cp,e.initialUser,this.serializer)}Du(e){return new Wf(Gf.Vi,this.serializer)}bu(e){return new Ip}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}mg.provider={build:()=>new mg};class gg extends mg{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){As(this.persistence.referenceDelegate instanceof Qf,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new xf(n,e.asyncQueue,t)}Du(e){const t=void 0!==this.cacheSizeBytes?rf.withCacheSize(this.cacheSizeBytes):rf.DEFAULT;return new Wf(e=>Qf.Vi(e,t),this.serializer)}}class yg extends mg{constructor(e,t,n){super(),this.Mu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Mu.initialize(this,e),await pg(this.Mu.syncEngine),await um(this.Mu.remoteStore),await this.persistence.ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return fp(this.persistence,new cp,e.initialUser,this.serializer)}Cu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new xf(n,e.asyncQueue,t)}Fu(e,t){const n=new Ho(t,this.persistence);return new qo(e.asyncQueue,n)}Du(e){const t=op(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?rf.withCacheSize(this.cacheSizeBytes):rf.DEFAULT;return new rp(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Lp(),jp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new Ip}}class vg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Zm(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=hg.bind(null,this.syncEngine),await wm(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Cm}createDatastore(e){const t=Mp(e.databaseInfo.databaseId),n=function(e){return new Op(e)}(e.databaseInfo);return function(e,t,n,r){return new qp(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Kp(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>Zm(this.syncEngine,e,0),kp.C()?new kp:new Ep)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Hm(e,t,n,r,i,s);return o&&(a.fu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Ds(e);Es(Wp,"RemoteStore shutting down."),t.Ia.add(5),await Qp(t),t.Ea.shutdown(),t.Aa.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}vg.provider={build:()=>new vg};class bg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Ss("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const wg="FirestoreClient";class xg{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ws.UNAUTHENTICATED,this.clientId=Hs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{Es(wg,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Es(wg,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Os;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Em(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function _g(e,t){e.asyncQueue.verifyOperationInProgress(),Es(wg,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await pp(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>{ks("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{Es("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(e=>{ks("Terminating Firestore due to IndexedDb database deletion failed",e)})}),e._offlineComponents=t}async function Ig(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Eg(e);Es(wg,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>bm(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>bm(t.remoteStore,n)),e._onlineComponents=t}async function Eg(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Es(wg,"Using user provided OfflineComponentProvider");try{await _g(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Ps.FAILED_PRECONDITION||e.code===Ps.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;ks("Error using user provided cache. Falling back to memory cache: "+n),await _g(e,new mg)}}else Es(wg,"Using default OfflineComponentProvider"),await _g(e,new gg(void 0));return e._offlineComponents}async function Sg(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Es(wg,"Using user provided OnlineComponentProvider"),await Ig(e,e._uninitializedComponentsProvider._online)):(Es(wg,"Using default OnlineComponentProvider"),await Ig(e,new vg))),e._onlineComponents}function kg(e){return Sg(e).then(e=>e.syncEngine)}async function Tg(e){const t=await Sg(e),n=t.eventManager;return n.onListen=Wm.bind(null,t.syncEngine),n.onUnlisten=Xm.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Km.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Jm.bind(null,t.syncEngine),n}function Ng(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Os;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new bg({next:a=>{s.Ou(),t.enqueueAndForget(()=>Pm(e,o));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new Rs(Ps.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new Rs(Ps.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new Fm(Kc(n.path),s,{includeMetadataChanges:!0,ka:!0});return Dm(e,o)}(await Tg(e),e.asyncQueue,t,n,r)),r.promise}function Cg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Os;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new bg({next:n=>{s.Ou(),t.enqueueAndForget(()=>Pm(e,o)),n.fromCache&&"server"===r.source?i.reject(new Rs(Ps.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Fm(n,s,{includeMetadataChanges:!0,ka:!0});return Dm(e,o)}(await Tg(e),e.asyncQueue,t,n,r)),r.promise}function Ag(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Dg=new Map,Pg="firestore.googleapis.com",Rg=!0;class Og{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Rs(Ps.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Pg,this.ssl=Rg}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Rg;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=nf;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<vf)throw new Rs(Ps.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Rs(Ps.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ag(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Rs(Ps.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Rs(Ps.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Rs(Ps.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Lg{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Og({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Rs(Ps.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Rs(Ps.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Og(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new js;switch(e.type){case"firstParty":return new Us(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Rs(Ps.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Dg.get(e);t&&(Es("ComponentProvider","Removing Datastore"),Dg.delete(e),t.terminate())}(this),Promise.resolve()}}function jg(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;e=co(e,Lg);const s=V(t),o=e._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${n}`;s&&(U(`https://${l}`),B("Firestore",!0)),o.host!==Pg&&o.host!==l&&ks("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:l,ssl:s,emulatorOptions:r});if(!Y(c,a)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=ws.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[D(JSON.stringify({alg:"none",type:"JWT"})),D(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Rs(Ps.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ws(s)}e._authCredentials=new Ms(new Ls(t,n))}}class Mg{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Mg(this.firestore,e,this._query)}}class Fg{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fg(this.firestore,e,this._key)}toJSON(){return{type:Fg._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(fo(t,Fg._jsonSchema))return new Fg(e,n||null,new ro(eo.fromString(t.referencePath)))}}Fg._jsonSchemaVersion="firestore/documentReference/1.0",Fg._jsonSchema={type:ho("string",Fg._jsonSchemaVersion),referencePath:ho("string")};class Vg extends Mg{constructor(e,t,n){super(e,t,Kc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fg(this.firestore,null,new ro(e))}withConverter(e){return new Vg(this.firestore,e,this._path)}}function Ug(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=se(e),io("collection","path",t),e instanceof Lg){const n=eo.fromString(t,...r);return oo(n),new Vg(e,null,n)}{if(!(e instanceof Fg||e instanceof Vg))throw new Rs(Ps.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(eo.fromString(t,...r));return oo(n),new Vg(e.firestore,null,n)}}function zg(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=se(e),1===arguments.length&&(t=Hs.newId()),io("doc","path",t),e instanceof Lg){const n=eo.fromString(t,...r);return so(n),new Fg(e,null,new ro(n))}{if(!(e instanceof Fg||e instanceof Vg))throw new Rs(Ps.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(eo.fromString(t,...r));return so(n),new Fg(e.firestore,e instanceof Vg?e.converter:null,new ro(n))}}const $g="AsyncQueue";class Bg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Fp(this,"async_queue_retry"),this.oc=()=>{const e=jp();e&&Es($g,"Visibility state changed to "+e.visibilityState),this.F_.y_()},this._c=e;const t=jp();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=jp();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new Os;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(0!==this.Zu.length){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Fo(e))throw e;Es($g,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(e=>{throw this.tc=e,this.nc=!1,Ss("INTERNAL UNHANDLED ERROR: ",qg(e)),e}).then(e=>(this.nc=!1,e))));return this._c=t,t}enqueueAfterDelay(e,t,n){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const r=Im.createAndSchedule(this,e,t,n,e=>this.lc(e));return this.ec.push(r),r}ac(){this.tc&&Ns(47125,{hc:qg(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do{e=this._c,await e}while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function qg(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Hg(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Wg extends Lg{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Bg,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Bg(e),this._firestoreClient=void 0,await e}}}function Kg(e,t){const n="object"==typeof e?e:_t(),r="string"==typeof e?e:t||Rl,i=gt(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=(e=>{const t=L(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&jg(i,...e)}return i}function Gg(e){if(e._terminated)throw new Rs(Ps.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Qg(e),e._firestoreClient}function Qg(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new Pl(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Ag(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new xg(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function Xg(e,t,n){if((e=co(e,Wg))._firestoreClient||e._terminated)throw new Rs(Ps.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new Rs(Ps.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},Qg(e)}class Jg{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jg(wl.fromBase64String(e))}catch(e){throw new Rs(Ps.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Jg(wl.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Jg._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(fo(e,Jg._jsonSchema))return Jg.fromBase64String(e.bytes)}}Jg._jsonSchemaVersion="firestore/bytes/1.0",Jg._jsonSchema={type:ho("string",Jg._jsonSchemaVersion),bytes:ho("string")};class Yg{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Rs(Ps.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new no(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Zg{constructor(e){this._methodName=e}}class ey{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Rs(Ps.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Rs(Ps.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ws(this._lat,e._lat)||Ws(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ey._jsonSchemaVersion}}static fromJSON(e){if(fo(e,ey._jsonSchema))return new ey(e.latitude,e.longitude)}}ey._jsonSchemaVersion="firestore/geoPoint/1.0",ey._jsonSchema={type:ho("string",ey._jsonSchemaVersion),latitude:ho("number"),longitude:ho("number")};class ty{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ty._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(fo(e,ty._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new ty(e.vectorValues);throw new Rs(Ps.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ty._jsonSchemaVersion="firestore/vectorValue/1.0",ty._jsonSchema={type:ho("string",ty._jsonSchemaVersion),vectorValues:ho("object")};const ny=/^__.*__$/;class ry{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Gu(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ku(e,this.data,t,this.fieldTransforms)}}class iy{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Gu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function sy(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ns(40011,{Ec:e})}}class oy{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new oy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.fc(e),r}gc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.Ac(),r}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Sy(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(0===e.length)throw this.wc("Document fields must not be empty");if(sy(this.Ec)&&ny.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class ay{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Mp(e)}Dc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new oy({Ec:e,methodName:t,bc:n,path:no.emptyPath(),mc:!1,Sc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ly(e){const t=e._freezeSettings(),n=Mp(e._databaseId);return new ay(e._databaseId,!!t.ignoreUndefinedProperties,n)}function cy(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Dc(s.merge||s.mergeFields?2:0,t,n,i);xy("Data must be an object, but it was:",o,r);const a=by(r,o);let l,c;if(s.merge)l=new vl(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=_y(t,r,n);if(!o.contains(i))throw new Rs(Ps.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);ky(e,i)||e.push(i)}l=new vl(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new ry(new uc(a),l,c)}class uy extends Zg{_toFieldTransform(e){if(2!==e.Ec)throw 1===e.Ec?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof uy}}function hy(e,t,n){return new oy({Ec:3,bc:t.settings.bc,methodName:e._methodName,mc:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class dy extends Zg{_toFieldTransform(e){return new Mu(e.path,new Cu)}isEqual(e){return e instanceof dy}}class fy extends Zg{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=hy(this,e,!0),n=this.vc.map(e=>vy(e,t)),r=new Au(n);return new Mu(e.path,r)}isEqual(e){return e instanceof fy&&Y(this.vc,e.vc)}}class py extends Zg{constructor(e,t){super(e),this.Cc=t}_toFieldTransform(e){const t=new Ou(e.serializer,Eu(e.serializer,this.Cc));return new Mu(e.path,t)}isEqual(e){return e instanceof py&&this.Cc===e.Cc}}function my(e,t,n,r){const i=e.Dc(1,t,n);xy("Data must be an object, but it was:",i,r);const s=[],o=uc.empty();ul(r,(e,r)=>{const a=Ey(t,e,n);r=se(r);const l=i.gc(a);if(r instanceof uy)s.push(a);else{const e=vy(r,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new vl(s);return new iy(o,a,i.fieldTransforms)}function gy(e,t,n,r,i,s){const o=e.Dc(1,t,n),a=[_y(t,r,n)],l=[i];if(s.length%2!=0)throw new Rs(Ps.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(_y(t,s[d])),l.push(s[d+1]);const c=[],u=uc.empty();for(let d=a.length-1;d>=0;--d)if(!ky(c,a[d])){const e=a[d];let t=l[d];t=se(t);const n=o.gc(e);if(t instanceof uy)c.push(e);else{const r=vy(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new vl(c);return new iy(u,h,o.fieldTransforms)}function yy(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return vy(n,e.Dc(r?4:3,t))}function vy(e,t){if(wy(e=se(e)))return xy("Unsupported field value:",t,e),by(e,t);if(e instanceof Zg)return function(e,t){if(!sy(t.Ec))throw t.wc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.wc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&4!==t.Ec)throw t.wc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=vy(i,t.yc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=se(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Eu(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=go.fromDate(e);return{timestampValue:Nh(t.serializer,n)}}if(e instanceof go){const n=new go(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Nh(t.serializer,n)}}if(e instanceof ey)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Jg)return{bytesValue:Ch(t.serializer,e._byteString)};if(e instanceof Fg){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.wc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ph(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof ty)return function(e,t){return{mapValue:{fields:{[Ll]:{stringValue:Fl},[Vl]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.wc("VectorValues must only contain numeric values.");return _u(t.serializer,e)})}}}}}}(e,t);throw t.wc(`Unsupported field value: ${lo(e)}`)}(e,t)}function by(e,t){const n={};return hl(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ul(e,(e,r)=>{const i=vy(r,t.Vc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function wy(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof go||e instanceof ey||e instanceof Jg||e instanceof Fg||e instanceof Zg||e instanceof ty)}function xy(e,t,n){if(!wy(n)||!ao(n)){const r=lo(n);throw"an object"===r?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function _y(e,t,n){if((t=se(t))instanceof Yg)return t._internalPath;if("string"==typeof t)return Ey(e,t);throw Sy("Field path arguments must be of type string or ",e,!1,void 0,n)}const Iy=new RegExp("[~\\*/\\[\\]]");function Ey(e,t,n){if(t.search(Iy)>=0)throw Sy(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Yg(...t.split("."))._internalPath}catch(r){throw Sy(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Sy(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new Rs(Ps.INVALID_ARGUMENT,a+e+l)}function ky(e,t){return e.some(e=>e.isEqual(t))}class Ty{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Fg(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Ny(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Cy("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Ny extends Ty{data(){return super.data()}}function Cy(e,t){return"string"==typeof t?Ey(e,t):t instanceof Yg?t._internalPath:t._delegate._internalPath}function Ay(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Rs(Ps.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Dy{}class Py extends Dy{}function Ry(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof Dy&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof Ly).length,n=e.filter(e=>e instanceof Oy).length;if(t>1||t>0&&n>0)throw new Rs(Ps.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class Oy extends Py{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Oy(e,t,n)}_apply(e){const t=this._parse(e);return zy(e._query,t),new Mg(e.firestore,e.converter,Zc(e._query,t))}_parse(e){const t=ly(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Rs(Ps.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Uy(o,s);const t=[];for(const n of o)t.push(Vy(r,e,n));a={arrayValue:{values:t}}}else a=Vy(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Uy(o,s),a=yy(n,t,o,"in"===s||"not-in"===s);return bc.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class Ly extends Dy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ly(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:wc.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)zy(n,i),n=Zc(n,i)}(e._query,t),new Mg(e.firestore,e.converter,Zc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class jy extends Py{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new jy(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Rs(Ps.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Rs(Ps.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new gc(t,n)}(e._query,this._field,this._direction);return new Mg(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Hc(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class My extends Py{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new My(e,t,n)}_apply(e){return new Mg(e.firestore,e.converter,eu(e._query,this._limit,this._limitType))}}function Fy(e){return uo("limit",e),My._create("limit",e,"F")}function Vy(e,t,n){if("string"==typeof(n=se(n))){if(""===n)throw new Rs(Ps.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Qc(t)&&-1!==n.indexOf("/"))throw new Rs(Ps.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(eo.fromString(n));if(!ro.isDocumentKey(r))throw new Rs(Ps.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Xl(e,new ro(r))}if(n instanceof Fg)return Xl(e,n._key);throw new Rs(Ps.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lo(n)}.`)}function Uy(e,t){if(!Array.isArray(e)||0===e.length)throw new Rs(Ps.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function zy(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Rs(Ps.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Rs(Ps.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class $y{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(zl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Il(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(El(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ns(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return ul(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[Vl].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>Il(e.doubleValue));return new ty(i)}convertGeoPoint(e){return new ey(Il(e.latitude),Il(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Al(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Dl(e));default:return null}}convertTimestamp(e){const t=_l(e);return new go(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=eo.fromString(e);As(nd(n),9688,{name:e});const r=new Ol(n.get(1),n.get(3)),i=new ro(n.popFirst(5));return r.isEqual(t)||Ss(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function By(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class qy{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hy extends Ty{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Wy(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Cy("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Rs(Ps.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Hy._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Hy._jsonSchemaVersion="firestore/documentSnapshot/1.0",Hy._jsonSchema={type:ho("string",Hy._jsonSchemaVersion),bundleSource:ho("string","DocumentSnapshot"),bundleName:ho("string"),bundle:ho("string")};class Wy extends Hy{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Ky{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new qy(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Wy(this._firestore,this._userDataWriter,n.key,n,new qy(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Rs(Ps.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Wy(e._firestore,e._userDataWriter,n.doc.key,n.doc,new qy(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Wy(e._firestore,e._userDataWriter,t.doc.key,t.doc,new qy(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Gy(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Rs(Ps.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ky._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Hs.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Gy(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ns(61501,{type:e})}}function Qy(e){e=co(e,Fg);const t=co(e.firestore,Wg);return Ng(Gg(t),e._key).then(n=>nv(t,e,n))}Ky._jsonSchemaVersion="firestore/querySnapshot/1.0",Ky._jsonSchema={type:ho("string",Ky._jsonSchemaVersion),bundleSource:ho("string","QuerySnapshot"),bundleName:ho("string"),bundle:ho("string")};class Xy extends $y{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jg(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fg(this.firestore,null,t)}}function Jy(e){e=co(e,Mg);const t=co(e.firestore,Wg),n=Gg(t),r=new Xy(t);return Ay(e._query),Cg(n,e._query).then(n=>new Ky(t,r,e,n))}function Yy(e,t,n){e=co(e,Fg);const r=co(e.firestore,Wg),i=ly(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=se(t))||t instanceof Yg?gy(i,"updateDoc",e._key,t,n,a):my(i,"updateDoc",e._key,t),tv(r,[s.toMutation(e._key,Vu.exists(!0))])}function Zy(e,t){const n=co(e.firestore,Wg),r=zg(e),i=By(e.converter,t);return tv(n,[cy(ly(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Vu.exists(!1))]).then(()=>r)}function ev(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,o;e=se(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||Hg(n[l])||(a=n[l++]);const c={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Hg(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let u,h,d;if(e instanceof Fg)h=co(e.firestore,Wg),d=Kc(e._key.path),u={next:t=>{n[l]&&n[l](nv(h,e,t))},error:n[l+1],complete:n[l+2]};else{const t=co(e,Mg);h=co(t.firestore,Wg),d=t._query;const r=new Xy(h);u={next:e=>{n[l]&&n[l](new Ky(h,r,t,e))},error:n[l+1],complete:n[l+2]},Ay(e._query)}return function(e,t,n,r){const i=new bg(r),s=new Fm(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>Dm(await Tg(e),s)),()=>{i.Ou(),e.asyncQueue.enqueueAndForget(async()=>Pm(await Tg(e),s))}}(Gg(h),d,c,u)}function tv(e,t){return function(e,t){const n=new Os;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=pg(e);try{const e=await function(e,t){const n=Ds(e),r=go.now(),i=t.reduce((e,t)=>e.add(t.key),bu());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=uu(),l=bu();return n.Os.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=Hu(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Gu(e.key,t,hc(t.value.mapValue),Vu.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:fu(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ru[e.currentUser.toKey()];r||(r=new dl(Ws)),r=r.insert(t,n),e.Ru[e.currentUser.toKey()]=r}(r,e.batchId,n),await ug(r,e.changes),await um(r.remoteStore)}catch(e){const t=Em(e,"Failed to persist write");n.reject(t)}}(await kg(e),t,n)),n.promise}(Gg(e),t)}function nv(e,t,n){const r=n.docs.get(t._key),i=new Xy(e);return new Hy(e,i,t._key,r,new qy(n.hasPendingWrites,n.fromCache),t.converter)}class rv{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ly(e)}set(e,t,n){this._verifyNotCommitted();const r=iv(e,this._firestore),i=By(r.converter,t,n),s=cy(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Vu.none())),this}update(e,t,n){this._verifyNotCommitted();const r=iv(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=se(t))||t instanceof Yg?gy(this._dataReader,"WriteBatch.update",r._key,t,n,o):my(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,Vu.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=iv(e,this._firestore);return this._mutations=this._mutations.concat(new Yu(t._key,Vu.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Rs(Ps.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function iv(e,t){if((e=se(e)).firestore!==t)throw new Rs(Ps.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function sv(){return new dy("serverTimestamp")}function ov(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new fy("arrayUnion",t)}function av(e){return new py("increment",e)}function lv(e){return Gg(e=co(e,Wg)),new rv(e,t=>tv(e,t))}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){xs=e}(wt),mt(new oe("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new Wg(new Fs(e.getProvider("auth-internal")),new $s(s,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Rs(Ps.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ol(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),It(vs,bs,e),It(vs,bs,"esm2017")}();let cv=!1,uv=null,hv=null,dv=null,fv="disconnected",pv=null,mv=0;const gv={apiKey:"AIzaSyBNJtmpRWzjobrY556bnHkwbZmpFJqgPX8",authDomain:"text-adventure-game-cb731.firebaseapp.com",projectId:"text-adventure-game-cb731",storageBucket:"text-adventure-game-cb731.appspot.com",messagingSenderId:"1092941614820",appId:"1:1092941614820:web:5545f36014b73c268026f1",measurementId:"G-FNGF42T1FP"},yv=()=>({status:fv,error:pv,retryCount:mv,isInitialized:cv}),vv=()=>{if(cv&&uv&&hv&&dv)return{app:uv,auth:dv,db:hv};try{return fv="connecting",console.log("Firebase \ucd08\uae30\ud654 \uc2dc\ub3c4 \uc911..."),uv=xt(gv),dv=ns(uv),hv=Kg(uv),function(e,t){ks("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return Xg(e,vg.provider,{build:e=>new yg(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()}(hv).then(()=>{console.log("\uc624\ud504\ub77c\uc778 \uc9c0\uc18d\uc131\uc774 \ud65c\uc131\ud654\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}).catch(e=>{"failed-precondition"===e.code?console.warn("\uc5ec\ub7ec \ud0ed\uc774 \uc5f4\ub824 \uc788\uc5b4 \uc624\ud504\ub77c\uc778 \uc9c0\uc18d\uc131\uc744 \ud65c\uc131\ud654\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."):"unimplemented"===e.code&&console.warn("\ud604\uc7ac \ube0c\ub77c\uc6b0\uc800\ub294 \uc624\ud504\ub77c\uc778 \uc9c0\uc18d\uc131\uc744 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.")}),cv=!0,fv="connected",mv=0,pv=null,console.log("Firebase \ucd08\uae30\ud654 \uc131\uacf5"),{app:uv,auth:dv,db:hv}}catch(e){return fv="error",pv=e,console.error("Firebase \ucd08\uae30\ud654 \uc2e4\ud328:",e),mv<5&&(mv++,console.log(`${mv}\ubc88\uc9f8 \uc7ac\uc2dc\ub3c4 \uc608\uc815 (3000ms \ud6c4)...`),setTimeout(()=>{vv()},3e3)),{app:null,auth:null,db:null,error:e}}},bv=e=>e?ns(e):(console.warn("\uc720\ud6a8\ud55c Firebase \uc571 \uc778\uc2a4\ud134\uc2a4\uac00 \ud544\uc694\ud569\ub2c8\ub2e4."),null),wv=e=>e?Kg(e):(console.warn("\uc720\ud6a8\ud55c Firebase \uc571 \uc778\uc2a4\ud134\uc2a4\uac00 \ud544\uc694\ud569\ub2c8\ub2e4."),null),xv=async e=>{if(!e)return console.warn("\uc720\ud6a8\ud55c Firebase \uc778\uc99d \uc778\uc2a4\ud134\uc2a4\uac00 \ud544\uc694\ud569\ub2c8\ub2e4."),Promise.reject(new Error("\uc720\ud6a8\ud55c Firebase \uc778\uc99d \uc778\uc2a4\ud134\uc2a4\uac00 \ud544\uc694\ud569\ub2c8\ub2e4."));let t=0;const n=async()=>{try{return t++,await async function(e){var t;if(yt(e.app))return Promise.reject(Bt(e));const n=Xn(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Cr({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Nr(n,{returnSecureToken:!0}),i=await Cr._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(e)}catch(r){if(console.error(`\uc775\uba85 \ub85c\uadf8\uc778 \uc2e4\ud328 (\uc2dc\ub3c4 ${t}/3):`,r),t<3){console.log(`${t}\ubc88\uc9f8 \ub85c\uadf8\uc778 \uc7ac\uc2dc\ub3c4 \uc911...`);const e=1e3*Math.pow(2,t-1);return await new Promise(t=>setTimeout(t,e)),n()}throw r}};return n()},_v=(e,t)=>e?function(e,t,n,r){return se(e).onAuthStateChanged(t,n,r)}(e,t):(console.warn("\uc720\ud6a8\ud55c Firebase \uc778\uc99d \uc778\uc2a4\ud134\uc2a4\uac00 \ud544\uc694\ud569\ub2c8\ub2e4."),()=>{}),Iv={initializeFirebase:vv,getFirebaseAuth:bv,getFirebaseFirestore:wv,signInAnonymouslyWithFirebase:xv,onAuthStateChangedListener:_v,firebaseConfig:gv};let Ev={lastCallTime:null,lastCallSuccess:!0,failureCount:0,inCooldown:!1,cooldownUntil:null};const Sv=new Map,kv=[{title:"\uc608\uc0c1\uce58 \ubabb\ud55c \uae30\ud6c4 \ubcc0\ud654",description:"\uac11\uc791\uc2a4\ub7ec\uc6b4 \uae30\ud6c4 \ubcc0\ud654\ub85c \uc778\ud574 \ub18d\uc791\ubb3c \uc0dd\uc0b0\uc5d0 \uc601\ud5a5\uc774 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.",effects:[{nation:"\ub85c\ub9c8",effect:"\uc790\uc6d0\ubcc0\uacbd",value:-30},{nation:"\ud398\ub974\uc2dc\uc544",effect:"\uc548\uc815\ub3c4\ubcc0\uacbd",value:-5}]},{title:"\ubb34\uc5ed\ub85c \ubc1c\uacac",description:"\uc0c8\ub85c\uc6b4 \ubb34\uc5ed\ub85c\uac00 \ubc1c\uacac\ub418\uc5b4 \uc790\uc6d0 \uc0dd\uc0b0\uc774 \uc99d\uac00\ud588\uc2b5\ub2c8\ub2e4.",effects:[{nation:"\ub85c\ub9c8",effect:"\uc790\uc6d0\ubcc0\uacbd",value:50},{nation:"\ud398\ub974\uc2dc\uc544",effect:"\uc790\uc6d0\ubcc0\uacbd",value:50}]},{title:"\uae30\uc220 \ud601\uc2e0",description:"\uc5f0\uad6c\uc790\ub4e4\uc774 \uc911\uc694\ud55c \uae30\uc220\uc801 \ub3cc\ud30c\uad6c\ub97c \ubc1c\uacac\ud588\uc2b5\ub2c8\ub2e4.",effects:[{nation:"\ub85c\ub9c8",effect:"\uae30\uc220\ubc1c\uc804",value:1,tech_name:"engineering"},{nation:"\ud398\ub974\uc2dc\uc544",effect:"\uae30\uc220\ubc1c\uc804",value:1,tech_name:"agriculture"}]},{title:"\uc9c8\ubcd1 \ubc1c\uc0dd",description:"\uc804\uc5fc\ubcd1\uc774 \ubc1c\uc0dd\ud558\uc5ec \uad70\uc0ac\ub825\uc5d0 \uc601\ud5a5\uc744 \ubbf8\ucce4\uc2b5\ub2c8\ub2e4.",effects:[{nation:"\ub85c\ub9c8",effect:"\uad70\uc0ac\ub825\ubcc0\uacbd",value:-3},{nation:"\ud398\ub974\uc2dc\uc544",effect:"\uad70\uc0ac\ub825\ubcc0\uacbd",value:-3}]},{title:"\uc678\uad50\uc801 \uc131\uacf5",description:"\uc131\uacf5\uc801\uc778 \uc678\uad50 \ud611\uc0c1\uc73c\ub85c \uad6d\uac00 \uc548\uc815\ub3c4\uac00 \ud5a5\uc0c1\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",effects:[{nation:"\ub85c\ub9c8",effect:"\uc548\uc815\ub3c4\ubcc0\uacbd",value:10},{nation:"\ud398\ub974\uc2dc\uc544",effect:"\uc548\uc815\ub3c4\ubcc0\uacbd",value:10}]}],Tv={"\uad6d\ubc29":[{action:"build_military",value:10,explanation:"10\uba85\uc758 \uad70\ub300\ub97c \ud6c8\ub828\ud569\ub2c8\ub2e4."},{action:"attack",from:"\ub85c\ub9c8",to:"\uce74\ub974\ud0c0\uace0",explanation:"\ub85c\ub9c8\uc5d0\uc11c \uce74\ub974\ud0c0\uace0\ub97c \uacf5\uaca9\ud569\ub2c8\ub2e4."}],"\uc7ac\ubb34":[{action:"research",tech_name:"agriculture",explanation:"\ub18d\uc5c5 \uae30\uc220\uc744 \uc5f0\uad6c\ud569\ub2c8\ub2e4."},{action:"research",tech_name:"engineering",explanation:"\uacf5\ud559 \uae30\uc220\uc744 \uc5f0\uad6c\ud569\ub2c8\ub2e4."}],"\uc678\uad50":[{action:"research",tech_name:"diplomacy",explanation:"\uc678\uad50 \uae30\uc220\uc744 \uc5f0\uad6c\ud569\ub2c8\ub2e4."},{action:"move_troops",from:"\ub85c\ub9c8",to:"\uc2dc\uce60\ub9ac\uc544",value:5,explanation:"\ub85c\ub9c8\uc5d0\uc11c \uc2dc\uce60\ub9ac\uc544\ub85c 5\uba85\uc758 \ubd80\ub300\ub97c \uc774\ub3d9\ud569\ub2c8\ub2e4."}],"\uc815\ubcf4":[{action:"research",tech_name:"espionage",explanation:"\ucca9\ubcf4 \uae30\uc220\uc744 \uc5f0\uad6c\ud569\ub2c8\ub2e4."},{action:"build_military",value:5,explanation:"5\uba85\uc758 \uad70\ub300\ub97c \ud6c8\ub828\ud569\ub2c8\ub2e4."}]},Nv=()=>{if(Ev.lastCallTime=Date.now(),Ev.lastCallSuccess=!1,Ev.failureCount++,Ev.failureCount>=3){Ev.inCooldown=!0;const e=Math.min(3e4*Math.pow(2,Ev.failureCount-3),3e5);Ev.cooldownUntil=Date.now()+e,console.warn(`API \uc5f0\uc18d \uc2e4\ud328\ub85c ${e/1e3}\ucd08 \ub3d9\uc548 \ucfe8\ub2e4\uc6b4 \uc124\uc815\ub428`)}},Cv=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"llama-3.1-405b-reasoning",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const i=((e,t)=>`${t}:${e}`)(e,t),s=(e=>{if(!Sv.has(e))return null;const t=Sv.get(e);return Date.now()-t.timestamp>864e5?(Sv.delete(e),null):t.data})(i);if(s)return console.log("\uce90\uc2dc\ub41c \uc751\ub2f5 \uc0ac\uc6a9:",i),s;if(!(()=>{const e=Date.now();return!(Ev.inCooldown&&e<Ev.cooldownUntil)&&(Ev.inCooldown&&e>=Ev.cooldownUntil&&(Ev.inCooldown=!1,Ev.failureCount=0),!0)})())return console.warn("API \ucfe8\ub2e4\uc6b4 \uc911, \ub85c\uceec \ud3f4\ubc31 \uc0ac\uc6a9"),Av(e,t,r);const o=t.includes("JSON"),a={model:n,messages:[{role:"system",content:t},{role:"user",content:e}],temperature:.8,max_tokens:1024,...o&&{response_format:{type:"json_object"}}};try{var l,c,u;console.log("Groq API \ud638\ucd9c \uc911...");const n=new AbortController,s=setTimeout(()=>n.abort(),1e4),d=await fetch("https://api.groq.com/openai/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify(a),signal:n.signal});if(clearTimeout(s),!d.ok)return console.error(`Groq API \ud638\ucd9c \uc2e4\ud328 (\uc0c1\ud0dc: ${d.status})`),Nv(),Av(e,t,r);const f=(null===(l=(await d.json()).choices)||void 0===l||null===(c=l[0])||void 0===c||null===(u=c.message)||void 0===u?void 0:u.content)||"{}";let p;if(o)try{p=JSON.parse(f)}catch(h){return console.error("JSON \ud30c\uc2f1 \uc2e4\ud328:",h),Nv(),Av(e,t,r)}else p={content:f};return((e,t)=>{if(Sv.size>=50){const e=[...Sv.entries()].sort((e,t)=>e[1].timestamp-t[1].timestamp)[0][0];Sv.delete(e)}Sv.set(e,{data:t,timestamp:Date.now()})})(i,p),Ev.lastCallTime=Date.now(),Ev.lastCallSuccess=!0,Ev.failureCount=0,Ev.inCooldown=!1,p}catch(d){return console.error("Groq API \ud638\ucd9c \uc911 \uc624\ub958:",d),Nv(),Av(e,t,r)}},Av=(e,t,n)=>{if(console.log("\ub85c\uceec \ud3f4\ubc31 \uc751\ub2f5 \uc0dd\uc131 \uc911..."),t.includes("\uc2a4\ud1a0\ub9ac\ud154\ub7ec")&&t.includes("\ubb34\uc791\uc704 \uc774\ubca4\ud2b8")){const e=(e=>{let t=[];try{e&&e.nations&&(t=Object.keys(e.nations))}catch(r){console.warn("\uac8c\uc784 \ub370\uc774\ud130\uc5d0\uc11c \uad6d\uac00 \uc774\ub984\uc744 \ucd94\ucd9c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4:",r)}const n={...kv[Math.floor(Math.random()*kv.length)]};return t.length>0&&(n.effects=n.effects.map(e=>({...e,nation:t[Math.floor(Math.random()*t.length)]}))),n})(n);return console.log("\ub85c\uceec \uc774\ubca4\ud2b8 \uc0dd\uc131\ub428:",e.title),e}if(t.includes("\uc0ac\uc6a9\uc790\uc758 \uba85\ub839\uc744 \ubd84\uc11d")){let i="\uad6d\ubc29";try{const e=t.match(/\ub2f9\uc2e0\uc740 '([^']+)'\uc774\uba70/);e&&e[1]&&("\ub9e4\ud30c"===e[1]?i="\uad6d\ubc29":"\uad00\ub8cc"===e[1]?i="\uc7ac\ubb34":"\ube44\ub458\uae30\ud30c"===e[1]?i="\uc678\uad50":"\ud604\uc2e4\uc8fc\uc758\uc790"===e[1]&&(i="\uc815\ubcf4"))}catch(r){console.warn("\ubcf4\uc88c\uad00 \uc720\ud615\uc744 \ucd94\ucd9c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4:",r)}const s=((e,t,n)=>{const i=Tv[e]||Tv["\uad6d\ubc29"];let s={...i[Math.floor(Math.random()*i.length)]};try{if(n&&n.map&&n.map.territories){const e=Object.values(n.map.territories),t=e.filter(e=>e.owner===n.currentNation),r=e.filter(e=>e.owner!==n.currentNation&&null!==e.owner);"attack"===s.action&&t.length>0&&r.length>0?(s.from=t[0].name,s.to=r[0].name,s.explanation=`${s.from}\uc5d0\uc11c ${s.to}\ub97c \uacf5\uaca9\ud569\ub2c8\ub2e4.`):"move_troops"===s.action&&t.length>=2&&(s.from=t[0].name,s.to=t[1].name,s.explanation=`${s.from}\uc5d0\uc11c ${s.to}\ub85c ${s.value}\uba85\uc758 \ubd80\ub300\ub97c \uc774\ub3d9\ud569\ub2c8\ub2e4.`)}}catch(r){console.warn("\uac8c\uc784 \ub370\uc774\ud130\uc5d0\uc11c \uc601\ud1a0 \uc815\ubcf4\ub97c \ucd94\ucd9c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4:",r)}return t.includes("\uacf5\uaca9")||t.includes("\uce68\ub7b5")?s={...Tv["\uad6d\ubc29"][0]}:t.includes("\uc5f0\uad6c")||t.includes("\uae30\uc220")?s={...Tv["\uc7ac\ubb34"][0]}:(t.includes("\ud6c8\ub828")||t.includes("\uad70\ub300"))&&(s={...Tv["\uad6d\ubc29"][1]}),s})(i,e,n);return console.log("\ub85c\uceec \ubcf4\uc88c\uad00 \uc751\ub2f5 \uc0dd\uc131\ub428:",s.action),s}return{content:"AI \uc11c\ube44\uc2a4\uc5d0 \uc5f0\uacb0\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ub098\uc911\uc5d0 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.",isLocalFallback:!0}},Dv=()=>({...Ev,cacheSize:Sv.size,isAvailable:!Ev.inCooldown}),Pv={callGroqLlmApi:Cv,getApiStatus:Dv},Rv=e,Ov=t,Lv=()=>{const e=T({maxWidth:639}),t=T({minWidth:640,maxWidth:767}),n=T({minWidth:768,maxWidth:1023}),r=T({minWidth:1024,maxWidth:1279});return{isMobile:e,isTablet:t,isLaptop:n,isDesktop:r,isLargeDesktop:T({minWidth:1280}),isMinWidth:{sm:T({minWidth:640}),md:T({minWidth:768}),lg:T({minWidth:1024}),xl:T({minWidth:1280})},isMaxWidth:{xs:T({maxWidth:639}),sm:T({maxWidth:767}),md:T({maxWidth:1023}),lg:T({maxWidth:1279})},deviceType:e?"mobile":t?"tablet":n?"laptop":r?"desktop":"largeDesktop"}},jv={"\uad6d\ubc29":{name:"\uad6d\ubc29\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 '\ub9e4\ud30c'\uc774\uba70, \uad70\uc0ac\uc801 \ud574\uacb0\ucc45\uc744 \uc120\ud638\ud569\ub2c8\ub2e4.",ambition:"\uad70\uc0ac\ub825 \uadf9\ub300\ud654"},"\uc7ac\ubb34":{name:"\uc7ac\ubb34\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 \uc2e0\uc911\ud55c '\uad00\ub8cc'\uc774\uba70, \uacbd\uc81c\uc801 \uc548\uc815\uc131\uc744 \ucd5c\uc6b0\uc120\uc73c\ub85c \uc0dd\uac01\ud569\ub2c8\ub2e4.",ambition:"\uad6d\uace0 \ucd5c\ub300\ud654"},"\uc678\uad50":{name:"\uc678\uad50\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 '\ube44\ub458\uae30\ud30c'\uc774\uba70, \ub300\ud654\uc640 \ud611\uc0c1\uc744 \uc120\ud638\ud569\ub2c8\ub2e4.",ambition:"\ubaa8\ub4e0 \uad6d\uac00\uc640 \ub3d9\ub9f9"},"\uc815\ubcf4":{name:"\uc815\ubcf4\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 '\ud604\uc2e4\uc8fc\uc758\uc790'\uc774\uba70, \ucca9\ubcf4\uc640 \uacf5\uc791\uc744 \uc120\ud638\ud569\ub2c8\ub2e4.",ambition:"\uc815\ubcf4\ub9dd \uc7a5\uc545"}},Mv={territories:{T1:{id:"T1",name:"\uc5d0\ub77c\uc2dc\uc544 \uc218\ub3c4",owner:"\uc5d0\ub77c\uc2dc\uc544",army:100,isCapital:!0,x:100,y:150,neighbors:["T2","T4"]},T2:{id:"T2",name:"\uc11c\ubd80 \ud574\uc548",owner:"\uc5d0\ub77c\uc2dc\uc544",army:0,isCapital:!1,x:50,y:100,neighbors:["T1","T3"]},T3:{id:"T3",name:"\ubd81\ubd80 \uc0b0\ub9e5",owner:null,army:10,isCapital:!1,x:150,y:50,neighbors:["T2","T5"]},T4:{id:"T4",name:"\uc911\uc559 \ud3c9\uc6d0",owner:null,army:10,isCapital:!1,x:200,y:150,neighbors:["T1","T5","T6"]},T5:{id:"T5",name:"\ube0c\ub77c\uce74\ub2e4 \uc218\ub3c4",owner:"\ube0c\ub77c\uce74\ub2e4",army:80,isCapital:!0,x:250,y:100,neighbors:["T3","T4"]},T6:{id:"T6",name:"\uc544\ube14\ub9ac \uc218\ub3c4",owner:"\uc544\ube14\ub9ac",army:150,isCapital:!0,x:250,y:250,neighbors:["T4"]}}},Fv={agriculture:{name:"\ub18d\uc5c5",description:"\ub9e4 \ud134 \uc601\ud1a0\ub2f9 \uc790\uc6d0 \uc0dd\uc0b0\ub7c9 +15%",baseCost:500,effectPerLevel:.15,maxLevel:5},engineering:{name:"\uacf5\ud559",description:"\uad70\uc0ac \uc720\ub2db \ud6c8\ub828 \ube44\uc6a9 -15%, \uc804\ud22c \uc2dc \uacf5\uaca9\ub825 +10%",baseCost:700,discountPerLevel:.15,combatBonusPerLevel:.1,maxLevel:5},espionage:{name:"\ucca9\ubcf4",description:"\uc801\uad6d \uc548\uc815\ub3c4 \uac10\uc18c \ud6a8\uacfc +3, \uc0c1\ub300\ubc29 \uc815\ubcf4 \ud68d\ub4dd \ud655\ub960 \uc99d\uac00",baseCost:600,stabilityEffectPerLevel:3,infoChancePerLevel:.15,maxLevel:5},diplomacy:{name:"\uc678\uad50",description:"\uc870\uc57d \uccb4\uacb0 \uc2dc \uc548\uc815\ub3c4 +5, \uc678\uad50 \uc81c\uc548 \uc218\ub77d \ud655\ub960 \uc99d\uac00",baseCost:550,stabilityBonusPerLevel:5,acceptanceChancePerLevel:.1,maxLevel:5}},Vv=async(e,t)=>{const n=lv(e),r=zg(e,"games",t.id);let i=JSON.parse(JSON.stringify(t.map)),s=JSON.parse(JSON.stringify(t.nations)),o=JSON.parse(JSON.stringify(t.players)),a=JSON.parse(JSON.stringify(t.advisors)),l=[];await Uv(o,a,s,t.turn,l),await zv(t,s,i,l),$v(t,i,s,o,l),Bv(o,s,i,t.turn,l),qv(o,s,a,t.turn,l);const c=o.filter(e=>"playing"===e.status);if(1===c.length){const e=c[0];l.push({turn:t.turn,type:"victory",content:`${e.nation}\uc774 \ucd5c\ud6c4\uc758 \uc2b9\uc790\uac00 \ub418\uc5c8\uc2b5\ub2c8\ub2e4!`}),n.update(r,{status:"finished",winner:e.nation,players:o,nations:s,map:i,advisors:a,events:[...t.events,...l],turn:t.turn+1,pendingActions:[]})}else o.forEach(e=>{e.isTurnReady=!1}),n.update(r,{players:o,nations:s,map:i,advisors:a,events:[...t.events,...l],turn:t.turn+1,pendingActions:[]});await n.commit()},Uv=async(e,t,n,r,i)=>{for(const s of e){if("playing"!==s.status)continue;const e=t[s.uid],o=n[s.nation];for(const t in e){if(e[t].loyalty<20&&Math.random()<.33){const e=Math.floor(.1*o.resources);o.resources-=e,i.push({turn:r,type:"betrayal",nation:s.nation,content:`[\ube44\ubc00 \ubcf4\uace0] ${t} \uc7a5\uad00\uc758 \ud6a1\ub839\uc73c\ub85c \uc790\uc6d0 ${e}\uc774 \uc0ac\ub77c\uc84c\uc2b5\ub2c8\ub2e4!`,isPrivate:!0,recipient:s.uid}),i.push({turn:r,type:"economy",nation:s.nation,content:"\uad6d\uace0\uc5d0\uc11c \uc6d0\uc778 \ubd88\uba85\uc758 \uc790\uc6d0 \uc190\uc2e4\uc774 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."})}}}},zv=async(e,t,n,r)=>{if(Math.random()<.25){const s='\ub2f9\uc2e0\uc740 \uc774 \uc9c0\uc815\ud559 \uac8c\uc784\uc758 \uc2a4\ud1a0\ub9ac\ud154\ub7ec\uc785\ub2c8\ub2e4. \ud604\uc7ac \uac8c\uc784 \uc0c1\ud669\uc744 \ubc14\ud0d5\uc73c\ub85c \ud765\ubbf8\ub85c\uc6b4 \ubb34\uc791\uc704 \uc774\ubca4\ud2b8\ub97c \uc0dd\uc131\ud558\uc138\uc694. \uacb0\uacfc\ub294 \ubc18\ub4dc\uc2dc \ub2e4\uc74c JSON \ud615\uc2dd\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4: {"title": "\uc774\ubca4\ud2b8 \uc81c\ubaa9", "description": "\uc774\ubca4\ud2b8 \uc124\uba85", "effects": [{"nation": "\uad6d\uac00\uba85", "effect": "\uc790\uc6d0\ubcc0\uacbd/\uc548\uc815\ub3c4\ubcc0\uacbd/\uad70\uc0ac\ub825\ubcc0\uacbd/\uae30\uc220\ubc1c\uc804", "value": \uc22b\uc790, "tech_name": "\uae30\uc220\uba85(\uae30\uc220\ubc1c\uc804\uc778 \uacbd\uc6b0\ub9cc)"}]}. \ud6a8\uacfc\ub294 \uac8c\uc784\uc5d0 \ucc38\uc5ec\uc911\uc778 \uad6d\uac00 \uc911 \ud558\ub098 \uc774\uc0c1\uc5d0 \uc801\uc6a9\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4.',o=`\ud604\uc7ac \uac8c\uc784 \uc0c1\ud0dc: ${JSON.stringify(e.nations)}`,a=await Ov.callGroqLlmApi(o,s);if(a&&!a.error&&a.effects){r.push({turn:e.turn,type:"dynamic_event",content:`${a.title}: ${a.description}`});for(const s of a.effects)if(t[s.nation])if("\uc790\uc6d0\ubcc0\uacbd"===s.effect)t[s.nation].resources+=s.value;else if("\uc548\uc815\ub3c4\ubcc0\uacbd"===s.effect)t[s.nation].stability=Math.max(0,Math.min(100,t[s.nation].stability+s.value));else if("\uad70\uc0ac\ub825\ubcc0\uacbd"===s.effect){var i;const e=null===(i=Object.values(n.territories).find(e=>e.owner===s.nation&&e.isCapital))||void 0===i?void 0:i.id;e&&(n.territories[e].army=Math.max(0,n.territories[e].army+s.value))}else if("\uae30\uc220\ubc1c\uc804"===s.effect&&s.tech_name&&Fv[s.tech_name]){const n=s.tech_name;t[s.nation].technologies[n]&&(t[s.nation].technologies[n].level+=s.value,r.push({turn:e.turn,type:"technology",nation:s.nation,content:`${s.nation}\uc774(\uac00) ${Fv[n].name} \uae30\uc220\uc5d0\uc11c \ub3cc\ud30c\uad6c\ub97c \ubc1c\uacac\ud588\uc2b5\ub2c8\ub2e4! (\ub808\ubca8 +${s.value})`}))}}}},$v=(e,t,n,r,i)=>{const s=e.pendingActions.filter(t=>"attack"===t.action&&t.turn===e.turn).sort((e,n)=>{const r=t.territories[e.details.toId],i=t.territories[n.details.toId];return r.isCapital&&!i.isCapital?-1:!r.isCapital&&i.isCapital?1:e.details.fromId.localeCompare(n.details.fromId)});for(const d of s){var o,a,l,c,u,h;const{fromId:s,toId:f}=d.details,p=t.territories[s],m=t.territories[f],g=d.fromNation,y=m.owner;if(p.owner!==g||m.owner===g){i.push({turn:e.turn,type:"battle_error",content:`${g}\uc758 ${p.name}\uc5d0\uc11c ${m.name}\ub85c\uc758 \uacf5\uaca9\uc774 \ubb34\ud6a8\ud654\ub418\uc5c8\uc2b5\ub2c8\ub2e4. (\uc18c\uc720\uad8c \ubcc0\uacbd)`});continue}const v=(null===(o=n[g])||void 0===o||null===(a=o.technologies)||void 0===a||null===(l=a.engineering)||void 0===l?void 0:l.level)||0,b=y&&(null===(c=n[y])||void 0===c||null===(u=c.technologies)||void 0===u||null===(h=u.engineering)||void 0===h?void 0:h.level)||0,w=v*(Fv.engineering.combatBonusPerLevel+.03),x=b*(Fv.engineering.combatBonusPerLevel+.03),_=.1,I=m.isCapital?.2:0,E=.1,S=1+Math.random()*E,k=1+Math.random()*E,T=p.army*S*(1+w),N=m.army*k*(1+x+_+I),C=T+N,A=.1,D=.7;let P=N/C*1.1,R=T/C*1;P=Math.max(A,Math.min(D,P)),R=Math.max(A,Math.min(D,R));const O=Math.round(p.army*P),L=Math.round(m.army*R);p.army-=O,m.army-=L;const j={attackerArmy:p.army+O,defenderArmy:m.army+L,attackerBonus:Math.round(100*w),defenderBonus:Math.round(100*(x+_+I)),attackerLosses:O,defenderLosses:L};if(i.push({turn:e.turn,type:"battle",content:`${g}\uc758 ${p.name}(${j.attackerArmy}\uba85)\uac00 ${y?y+"\uc758 ":""}${m.name}(${j.defenderArmy}\uba85)\ub97c \uacf5\uaca9! \ud53c\ud574: (\uacf5\uaca9\uce21: ${O}, \uc218\ube44\uce21: ${L})`,details:j}),m.army<=0){const s=m.owner;m.owner=g;const o=Math.max(1,Math.floor(.6*p.army));if(m.army=o,p.army=Math.max(0,p.army-o),i.push({turn:e.turn,type:"conquest",content:`${g}\uc774 ${m.name}\uc744 \uc810\ub839\ud588\uc2b5\ub2c8\ub2e4! (\uc8fc\ub454\uad70: ${o}\uba85)`}),m.isCapital&&s){n[s].status="eliminated";const o=r.find(e=>e.nation===s);o&&(o.status="eliminated"),i.push({turn:e.turn,type:"elimination",content:`${s}\uc758 \uc218\ub3c4\uac00 \ud568\ub77d\ub418\uc5b4 \uba78\ub9dd\ud588\uc2b5\ub2c8\ub2e4! ${g}\uc758 \uc2b9\ub9ac!`}),Object.values(t.territories).forEach(t=>{t.owner===s&&t.id!==m.id&&(t.owner=g,t.army=Math.max(1,Math.floor(.3*t.army)),i.push({turn:e.turn,type:"conquest",content:`${g}\uc774 \uba78\ub9dd\ud55c ${s}\uc758 \uc601\ud1a0 ${t.name}\uc744 \ud68d\ub4dd\ud588\uc2b5\ub2c8\ub2e4.`}))})}}}},Bv=(e,t,n,r,i)=>{for(const s of e){if("playing"!==s.status)continue;const e=t[s.nation],o=Object.values(n.territories).filter(e=>e.owner===s.nation),a=e.technologies.agriculture.level,l=75,c=100,u=Math.max(o.length*l,c),h=a*(Fv.agriculture.effectPerLevel+.05),d=Math.floor(u*h),f=u+d;let p=0;e.resources<100&&(p=Math.floor(.5*(100-e.resources)),i.push({turn:r,type:"economy",nation:s.nation,content:`\uc790\uc6d0 \uc704\uae30 \ud68c\ubcf5 \ubcf4\uc870\uae08 ${p}\uc774 \uc9c0\uae09\ub418\uc5c8\uc2b5\ub2c8\ub2e4.`})),e.resources+=f+p;const m=2e3+500*a;e.resources>m&&(e.resources=m,i.push({turn:r,type:"economy",nation:s.nation,content:`\uc790\uc6d0 \uc800\uc7a5 \ud55c\ub3c4(${m})\uc5d0 \ub3c4\ub2ec\ud588\uc2b5\ub2c8\ub2e4.`})),i.push({turn:r,type:"production",nation:s.nation,content:`\uc790\uc6d0 ${f+p} \uc0dd\uc0b0 (\uae30\ubcf8: ${u}, \ub18d\uc5c5 \ubcf4\ub108\uc2a4: ${d}, \ud68c\ubcf5 \ubcf4\ub108\uc2a4: ${p}, \ub18d\uc5c5 \ub808\ubca8: ${a})`})}},qv=(e,t,n,r,i)=>{for(const s of e){if("playing"!==s.status)continue;const e=t[s.nation],o=n[s.uid],a=15,l=2,c=1;let u={},h=0;for(const t in o){const n=o[t];let d=0;if(n.loyalty<a)d+=a-n.loyalty,i.push({turn:r,type:"advisor",nation:s.nation,content:`${t} \uc7a5\uad00\uc758 \ucda9\uc131\ub3c4\uac00 \ucd5c\uc18c \uc218\uc900(${a})\uc73c\ub85c \ud68c\ubcf5\ub418\uc5c8\uc2b5\ub2c8\ub2e4.`,isPrivate:!0,recipient:s.uid});else if(n.loyalty<50){d+=l+Math.floor((50-n.loyalty)/10)}if(e.stability>80&&(d+=c),0!==d){const e=Math.min(100,n.loyalty+d);o[t].loyalty=e,u[t]=d}n.loyalty<30&&h++}if(Object.keys(u).length>0){const e=Object.entries(u).map(e=>{let[t,n]=e;return`${t}: +${n}`}).join(", ");i.push({turn:r,type:"advisor",nation:s.nation,content:`\ubcf4\uc88c\uad00 \ucda9\uc131\ub3c4 \ubcc0\ud654: ${e}`,isPrivate:!0,recipient:s.uid})}let d=0;h>0&&(d-=Math.min(h,2)+(h>2?h-2:0)),e.resources<100&&(d-=3),e.stability<20&&(d+=1,i.push({turn:r,type:"stability",nation:s.nation,content:"\uad6d\uac00 \uc704\uae30 \uad00\ub9ac\ub85c \uc548\uc815\ub3c4\uac00 \uc57d\uac04 \ud68c\ubcf5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."})),e.stability=Math.max(0,Math.min(100,e.stability+d)),0!==d&&i.push({turn:r,type:"stability",nation:s.nation,content:`\uc548\uc815\ub3c4\uac00 ${d>0?"+":""}${d} \ubcc0\ud654\ud588\uc2b5\ub2c8\ub2e4.`}),e.stability<=10&&e.stability>0?i.push({turn:r,type:"warning",nation:s.nation,content:`\uacbd\uace0: \uc548\uc815\ub3c4\uac00 \ub9e4\uc6b0 \ub0ae\uc2b5\ub2c8\ub2e4(${e.stability})! \uc548\uc815\ub3c4\uac00 0\uc774 \ub418\uba74 \uad6d\uac00\uac00 \ubd95\uad34\ud569\ub2c8\ub2e4.`,isPrivate:!0,recipient:s.uid}):e.stability<=0&&(e.status="eliminated",s.status="eliminated",i.push({turn:r,type:"collapse",content:`${s.nation}\uc774 \ub0b4\ubd80 \ud63c\ub780\uc73c\ub85c \ubd95\uad34\ud588\uc2b5\ub2c8\ub2e4!`}))}},Hv=async(e,t,n,r,i)=>{var s;if(!i||"object"!==typeof i)return{success:!1,message:"\uba85\ub839\uc744 \ucc98\ub9ac\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."};const o=null===(s=n.players.find(e=>e.uid===r.uid))||void 0===s?void 0:s.nation;if(!o)return{success:!1,message:"\uad6d\uac00\ub97c \uc120\ud0dd\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."};if("playing"!==n.status)return{success:!1,message:"\uac8c\uc784\uc774 \uc544\uc9c1 \uc2dc\uc791\ub418\uc9c0 \uc54a\uc558\uac70\ub098 \uc774\ubbf8 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4."};const a=n.players.find(e=>e.uid===r.uid);if(a.isTurnReady)return{success:!1,message:"\uc774\ubbf8 \ud134\uc744 \uc885\ub8cc\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc74c \ud134\uae4c\uc9c0 \uae30\ub2e4\ub824\uc8fc\uc138\uc694."};if("advisor_command"===i.action)return await Wv(e,t,n,r,i);zg(e,"games",t);return"attack"===i.action?await Kv(e,t,n,o,i):"build_military"===i.action?await Gv(e,t,n,o,i):"research"===i.action?await Qv(e,t,n,o,i):"move_troops"===i.action?await Xv(e,t,n,o,i):{success:!1,message:"\uc54c \uc218 \uc5c6\ub294 \uba85\ub839\uc785\ub2c8\ub2e4."}},Wv=async(e,t,n,r,i)=>{var s;const o=null===(s=n.players.find(e=>e.uid===r.uid))||void 0===s?void 0:s.nation,a=i.advisor,l=i.command,c={"\uad6d\ubc29":{name:"\uad6d\ubc29\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 '\ub9e4\ud30c'\uc774\uba70, \uad70\uc0ac\uc801 \ud574\uacb0\ucc45\uc744 \uc120\ud638\ud569\ub2c8\ub2e4.",ambition:"\uad70\uc0ac\ub825 \uadf9\ub300\ud654"},"\uc7ac\ubb34":{name:"\uc7ac\ubb34\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 \uc2e0\uc911\ud55c '\uad00\ub8cc'\uc774\uba70, \uacbd\uc81c\uc801 \uc548\uc815\uc131\uc744 \ucd5c\uc6b0\uc120\uc73c\ub85c \uc0dd\uac01\ud569\ub2c8\ub2e4.",ambition:"\uad6d\uace0 \ucd5c\ub300\ud654"},"\uc678\uad50":{name:"\uc678\uad50\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 '\ube44\ub458\uae30\ud30c'\uc774\uba70, \ub300\ud654\uc640 \ud611\uc0c1\uc744 \uc120\ud638\ud569\ub2c8\ub2e4.",ambition:"\ubaa8\ub4e0 \uad6d\uac00\uc640 \ub3d9\ub9f9"},"\uc815\ubcf4":{name:"\uc815\ubcf4\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 '\ud604\uc2e4\uc8fc\uc758\uc790'\uc774\uba70, \ucca9\ubcf4\uc640 \uacf5\uc791\uc744 \uc120\ud638\ud569\ub2c8\ub2e4.",ambition:"\uc815\ubcf4\ub9dd \uc7a5\uc545"}};c[a].persona,c[a].ambition,Object.values(n.map.territories).filter(e=>e.owner===o).map(e=>e.name).join(", "),n.nations[o].resources;let u,h={action:"invalid",explanation:"\uba85\ub839\uc744 \uc774\ud574\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."};if(l.includes("\uacf5\uaca9")){const e=Object.values(n.map.territories),t=e.filter(e=>e.owner===o),r=e.filter(e=>e.owner!==o&&null!==e.owner);t.length>0&&r.length>0&&(h={action:"attack",from:t[0].name,to:r[0].name,explanation:`${t[0].name}\uc5d0\uc11c ${r[0].name}\uc744(\ub97c) \uacf5\uaca9\ud569\ub2c8\ub2e4.`})}else if(l.includes("\ud6c8\ub828")||l.includes("\uad70\ub300")){const e=l.match(/\d+/),t=e?parseInt(e[0]):10;h={action:"build_military",value:t,explanation:`${t}\uba85\uc758 \uad70\ub300\ub97c \ud6c8\ub828\ud569\ub2c8\ub2e4.`}}else if(l.includes("\uc5f0\uad6c")||l.includes("\uae30\uc220")){let e="agriculture";l.includes("\ub18d\uc5c5")?e="agriculture":l.includes("\uacf5\ud559")?e="engineering":l.includes("\ucca9\ubcf4")?e="espionage":l.includes("\uc678\uad50")&&(e="diplomacy"),h={action:"research",tech_name:e,explanation:`${Fv[e].name} \uae30\uc220\uc744 \uc5f0\uad6c\ud569\ub2c8\ub2e4.`}}else if(l.includes("\uc774\ub3d9")){const e=Object.values(n.map.territories).filter(e=>e.owner===o);if(e.length>=2){const t=l.match(/\d+/),n=t?parseInt(t[0]):5;h={action:"move_troops",from:e[0].name,to:e[1].name,value:n,explanation:`${e[0].name}\uc5d0\uc11c ${e[1].name}\uc73c\ub85c ${n}\uba85\uc758 \ubd80\ub300\ub97c \uc774\ub3d9\ud569\ub2c8\ub2e4.`}}}return"invalid"===h.action?{success:!1,message:`${c[a].name}: ${h.explanation}`}:("attack"===h.action?u=await Kv(e,t,n,o,h):"build_military"===h.action?u=await Gv(e,t,n,o,h):"research"===h.action?u=await Qv(e,t,n,o,h):"move_troops"===h.action&&(u=await Xv(e,t,n,o,h)),{success:u.success,message:`${c[a].name}: ${h.explanation}\n\uacb0\uacfc: ${u.message}`})},Kv=async(e,t,n,r,i)=>{const s=Object.values(n.map.territories).find(e=>e.name===i.from),o=Object.values(n.map.territories).find(e=>e.name===i.to);if(!s||!o)return{success:!1,message:"\uc798\ubabb\ub41c \uc601\ud1a0 \uc774\ub984\uc785\ub2c8\ub2e4."};if(s.owner!==r)return{success:!1,message:"\uacf5\uaca9\uc744 \uc2dc\uc791\ud560 \uc601\ud1a0\ub294 \ub2f9\uc2e0\uc758 \uc18c\uc720\uac00 \uc544\ub2d9\ub2c8\ub2e4."};if(s.army<=0)return{success:!1,message:"\uacf5\uaca9\uc5d0 \uc0ac\uc6a9\ud560 \uad70\ub300\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."};if(!s.neighbors.includes(o.id))return{success:!1,message:"\uc778\uc811\ud558\uc9c0 \uc54a\uc740 \uc601\ud1a0\ub294 \uacf5\uaca9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."};if(o.owner===r)return{success:!1,message:"\uc790\uc2e0\uc758 \uc601\ud1a0\ub97c \uacf5\uaca9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."};const a=zg(e,"games",t),l={pendingActions:ov({fromNation:r,action:"attack",details:{fromId:s.id,toId:o.id},turn:n.turn})};l[`advisors.${n.players.find(e=>e.nation===r).uid}.\uad6d\ubc29.loyalty`]=av(5),l[`advisors.${n.players.find(e=>e.nation===r).uid}.\uc678\uad50.loyalty`]=av(-5),l[`advisors.${n.players.find(e=>e.nation===r).uid}.\uc7ac\ubb34.loyalty`]=av(-2);try{return await Yy(a,l),{success:!0,message:`${s.name}\uc5d0\uc11c ${o.name}\uc744(\ub97c) \uacf5\uaca9\ud569\ub2c8\ub2e4. \uacb0\uacfc\ub294 \ud134 \uc885\ub8cc \ud6c4 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.`}}catch(c){return console.error("Firestore \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958 \ubc1c\uc0dd:",c),{success:!1,message:"\uba85\ub839\uc744 \ucc98\ub9ac\ud558\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."}}},Gv=async(e,t,n,r,i)=>{var s;const o=1-n.nations[r].technologies.engineering.level*Fv.engineering.discountPerLevel,a=10*i.value,l=Math.round(a*o),c=a-l;if(n.nations[r].resources<l)return{success:!1,message:`\uc790\uc6d0\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ${l}, \ubcf4\uc720: ${n.nations[r].resources})`};const u=null===(s=Object.values(n.map.territories).find(e=>e.owner===r&&e.isCapital))||void 0===s?void 0:s.id;if(!u)return{success:!1,message:"\uc218\ub3c4\uac00 \uc5c6\uc5b4 \uad70\ub300\ub97c \ud6c8\ub828\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."};const h=zg(e,"games",t),d={};d[`map.territories.${u}.army`]=av(i.value),d[`nations.${r}.resources`]=av(-l);let f=`\uc218\ub3c4\uc5d0\uc11c \uad70\uc0ac \uc720\ub2db ${i.value}\uac1c\ub97c \ud6c8\ub828\ud588\uc2b5\ub2c8\ub2e4.`;c>0&&(f+=` (\uacf5\ud559 \uae30\uc220 \ud560\uc778: ${c} \uc790\uc6d0 \uc808\uc57d)`),d.events=ov({turn:n.turn,type:"military",nation:r,content:f}),d[`advisors.${n.players.find(e=>e.nation===r).uid}.\uad6d\ubc29.loyalty`]=av(3),d[`advisors.${n.players.find(e=>e.nation===r).uid}.\uc7ac\ubb34.loyalty`]=av(-1);try{return await Yy(h,d),{success:!0,message:f}}catch(p){return console.error("Firestore \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958 \ubc1c\uc0dd:",p),{success:!1,message:"\uba85\ub839\uc744 \ucc98\ub9ac\ud558\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."}}},Qv=async(e,t,n,r,i)=>{const s=i.tech_name,o=Fv[s];if(!o)return{success:!1,message:"\uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \uae30\uc220\uc785\ub2c8\ub2e4."};const a=n.nations[r].technologies[s].level,l=o.baseCost*(a+1);if(n.nations[r].resources<l)return{success:!1,message:`\uc5f0\uad6c \uc790\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ${l})`};const c=zg(e,"games",t),u={};u[`nations.${r}.resources`]=av(-l),u[`nations.${r}.technologies.${s}.level`]=av(1),u.events=ov({turn:n.turn,type:"technology",nation:r,content:`'${o.name}' \uae30\uc220 \uc5f0\uad6c\ub97c \uc644\ub8cc\ud588\uc2b5\ub2c8\ub2e4! (\ub808\ubca8 ${a+1})`}),u[`advisors.${n.players.find(e=>e.nation===r).uid}.\uc7ac\ubb34.loyalty`]=av(5),u[`advisors.${n.players.find(e=>e.nation===r).uid}.\uad6d\ubc29.loyalty`]=av(1),u[`advisors.${n.players.find(e=>e.nation===r).uid}.\uc815\ubcf4.loyalty`]=av(1);try{return await Yy(c,u),{success:!0,message:`'${o.name}' \uae30\uc220 \uc5f0\uad6c\ub97c \uc644\ub8cc\ud588\uc2b5\ub2c8\ub2e4! (\ub808\ubca8 ${a+1})`}}catch(h){return console.error("Firestore \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958 \ubc1c\uc0dd:",h),{success:!1,message:"\uba85\ub839\uc744 \ucc98\ub9ac\ud558\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."}}},Xv=async(e,t,n,r,i)=>{const s=Object.values(n.map.territories).find(e=>e.name===i.from),o=Object.values(n.map.territories).find(e=>e.name===i.to);if(!s||!o)return{success:!1,message:"\uc798\ubabb\ub41c \uc601\ud1a0 \uc774\ub984\uc785\ub2c8\ub2e4."};if(s.owner!==r)return{success:!1,message:"\ucd9c\ubc1c \uc601\ud1a0\ub294 \ub2f9\uc2e0\uc758 \uc18c\uc720\uac00 \uc544\ub2d9\ub2c8\ub2e4."};if(o.owner!==r)return{success:!1,message:"\ub3c4\ucc29 \uc601\ud1a0\ub294 \ub2f9\uc2e0\uc758 \uc18c\uc720\uac00 \uc544\ub2d9\ub2c8\ub2e4."};if(!s.neighbors.includes(o.id))return{success:!1,message:"\uc778\uc811\ud558\uc9c0 \uc54a\uc740 \uc601\ud1a0\ub85c\ub294 \uc774\ub3d9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."};const a=Math.min(s.army-1,i.value);if(a<=0)return{success:!1,message:"\uc774\ub3d9\ud560 \uc218 \uc788\ub294 \ubd80\ub300\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \ucd5c\uc18c 1\uac1c \ubd80\ub300\ub294 \uc601\ud1a0\uc5d0 \ub0a8\uaca8\ub450\uc5b4\uc57c \ud569\ub2c8\ub2e4."};const l=zg(e,"games",t),c={};c[`map.territories.${s.id}.army`]=av(-a),c[`map.territories.${o.id}.army`]=av(a),c.events=ov({turn:n.turn,type:"troop_movement",nation:r,content:`${s.name}\uc5d0\uc11c ${o.name}\uc73c\ub85c ${a}\uac1c \ubd80\ub300\ub97c \uc774\ub3d9\ud588\uc2b5\ub2c8\ub2e4.`}),c[`advisors.${n.players.find(e=>e.nation===r).uid}.\uad6d\ubc29.loyalty`]=av(2),c[`advisors.${n.players.find(e=>e.nation===r).uid}.\uc815\ubcf4.loyalty`]=av(1);try{return await Yy(l,c),{success:!0,message:`${s.name}\uc5d0\uc11c ${o.name}\uc73c\ub85c ${a}\uac1c \ubd80\ub300\ub97c \uc774\ub3d9\ud588\uc2b5\ub2c8\ub2e4.`}}catch(u){return console.error("Firestore \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958 \ubc1c\uc0dd:",u),{success:!1,message:"\uba85\ub839\uc744 \ucc98\ub9ac\ud558\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."}}},Jv=(e,t,n)=>{const[i,s]=(0,r.useState)(null),[o,a]=(0,r.useState)(!0),[l,c]=(0,r.useState)(null),[u,h]=(0,r.useState)(!1),d=(0,r.useRef)(Date.now()),f=(0,r.useRef)(null),p=async()=>{if(e&&t&&n&&i)try{const r=zg(e,"games",t),s=i.players.findIndex(e=>e.uid===n.uid);if(-1!==s){const e=[...i.players];e[s].lastActive=(new Date).toISOString(),await Yy(r,{players:e,lastActivityTimestamp:sv()}),d.current=Date.now()}}catch(r){console.warn("\ud50c\ub808\uc774\uc5b4 \ud65c\ub3d9 \uc0c1\ud0dc \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958:",r)}};(0,r.useEffect)(()=>{if(!e||!t)return void a(!1);a(!0);const r=zg(e,"games",t);p();const o=setInterval(()=>{p()},3e5);f.current=setInterval(()=>{(async()=>{if(e&&t&&n&&i)try{var r,s;const o=i.players[0];if(!o)return;const a=(null===(r=o.lastActive)||void 0===r||null===(s=r.toDate)||void 0===s?void 0:s.call(r))||new Date(0);if(new Date-a>6e4&&o.uid!==n.uid&&i.players.some(e=>e.uid===n.uid&&"playing"===e.status)){console.log("\ud638\uc2a4\ud2b8\uac00 \ube44\ud65c\uc131 \uc0c1\ud0dc\uc785\ub2c8\ub2e4. \ud638\uc2a4\ud2b8 \uc5ed\ud560 \uc774\uc804 \uc2dc\ub3c4 \uc911...");const r=i.players.filter(e=>"playing"===e.status).sort((e,t)=>{var n,r,i,s;return((null===(n=e.lastActive)||void 0===n||null===(r=n.toDate)||void 0===r?void 0:r.call(n))||new Date)-((null===(i=t.lastActive)||void 0===i||null===(s=i.toDate)||void 0===s?void 0:s.call(i))||new Date)});if(r.length>0&&r[0].uid===n.uid){const r=zg(e,"games",t),s=[...i.players.filter(e=>e.uid===n.uid),...i.players.filter(e=>e.uid!==n.uid)],a={turn:i.turn,type:"system",timestamp:(new Date).toISOString(),content:`\ud638\uc2a4\ud2b8 \uc5ed\ud560\uc774 ${o.nation||"\uc774\uc804 \ud638\uc2a4\ud2b8"}\uc5d0\uc11c ${s[0].nation||"\uc0c8 \ud638\uc2a4\ud2b8"}\ub85c \uc774\uc804\ub418\uc5c8\uc2b5\ub2c8\ub2e4.`};await Yy(r,{players:s,hostTransferred:!0,hostTransferTime:sv(),events:[...i.events,a]}),console.log("\ud638\uc2a4\ud2b8 \uc5ed\ud560\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc774\uc804\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),h(!0)}}else o.uid===n.uid?h(!0):h(!1)}catch(o){console.error("\ud638\uc2a4\ud2b8 \uc5ed\ud560 \uc774\uc804 \uc911 \uc624\ub958:",o)}})()},3e4);const l=ev(r,t=>{if(t.exists()){var r;const i={id:t.id,...t.data()};s(i);const o=(null===(r=i.players[0])||void 0===r?void 0:r.uid)===(null===n||void 0===n?void 0:n.uid);h(o);const a=i.players.filter(e=>"playing"===e.status),l="playing"===i.status&&a.length>0&&a.every(e=>e.isTurnReady);l&&o&&Vv(e,i)}else c("\uac8c\uc784\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");a(!1)},e=>{console.error("\uac8c\uc784 \ub370\uc774\ud130 \uad6c\ub3c5 \uc911 \uc624\ub958:",e),c(`\uac8c\uc784 \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ${e.message}`),a(!1)});return()=>{l(),clearInterval(o),f.current&&clearInterval(f.current)}},[e,t,n]);return{gameData:i,loading:o,error:l,isHost:u,handleSelectNation:async r=>{if(!i||!n)return;const s=i.players.findIndex(e=>e.uid===n.uid);if(-1!==s&&!i.nations[r].owner)try{const o=zg(e,"games",t),a=[...i.players];a[s].nation=r,a[s].lastActive=(new Date).toISOString();const l={...i.nations,[r]:{...i.nations[r],owner:n.uid}};await Yy(o,{players:a,nations:l,lastNationSelectionTime:sv()}),d.current=Date.now()}catch(o){console.error("\uad6d\uac00 \uc120\ud0dd \uc911 \uc624\ub958:",o),c(`\uad6d\uac00 \uc120\ud0dd \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ${o.message}`)}},handleStartGame:async()=>{if(i)if(i.players.every(e=>e.nation))try{const n=(new Date).toISOString(),r=i.players.map(e=>({...e,lastActive:n}));await Yy(zg(e,"games",t),{status:"playing",players:r,gameStartTime:sv(),lastPlayersActivityUpdate:sv()}),d.current=Date.now()}catch(n){console.error("\uac8c\uc784 \uc2dc\uc791 \uc911 \uc624\ub958:",n),c(`\uac8c\uc784 \uc2dc\uc791 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ${n.message}`)}else c("\ubaa8\ub4e0 \ud50c\ub808\uc774\uc5b4\uac00 \uad6d\uac00\ub97c \uc120\ud0dd\ud574\uc57c \uac8c\uc784\uc744 \uc2dc\uc791\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.")},handleEndTurn:async()=>{if(!i||!n)return;const r=i.players.findIndex(e=>e.uid===n.uid);if(-1!==r)try{const n=[...i.players];n[r].isTurnReady=!0,n[r].lastActive=(new Date).toISOString(),await Yy(zg(e,"games",t),{players:n,lastTurnReadyTime:sv()}),d.current=Date.now()}catch(s){console.error("\ud134 \uc885\ub8cc \uc911 \uc624\ub958:",s),c(`\ud134 \uc885\ub8cc \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ${s.message}`)}},handleCommand:async r=>{if(!i||!n||!e)return{success:!1,message:"\uac8c\uc784 \ub370\uc774\ud130\uac00 \ub85c\ub4dc\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."};try{return p(),await Hv(e,t,i,n,r)}catch(s){return console.error("\uba85\ub839 \uc2e4\ud589 \uc911 \uc624\ub958:",s),{success:!1,message:`\uba85\ub839 \uc2e4\ud589 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ${s.message}`}}},getMyNation:()=>{if(!i||!n)return null;const e=i.players.find(e=>e.uid===n.uid);return e&&e.nation?i.nations[e.nation]:null},getCurrentPlayer:()=>i&&n&&i.players.find(e=>e.uid===n.uid)||null,transferHostRole:async r=>{if(!i||!n||!e||!u)return!1;try{const n=zg(e,"games",t),s=i.players.find(e=>e.uid===r);if(!s)return console.error("\uc0c8 \ud638\uc2a4\ud2b8 \ud50c\ub808\uc774\uc5b4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),!1;const o=[s,...i.players.filter(e=>e.uid!==r)],a={turn:i.turn,type:"system",timestamp:(new Date).toISOString(),content:`\ud638\uc2a4\ud2b8 \uc5ed\ud560\uc774 ${i.players[0].nation||"\uc774\uc804 \ud638\uc2a4\ud2b8"}\uc5d0\uc11c ${s.nation||"\uc0c8 \ud638\uc2a4\ud2b8"}\ub85c \uc218\ub3d9 \uc774\uc804\ub418\uc5c8\uc2b5\ub2c8\ub2e4.`};return await Yy(n,{players:o,hostTransferred:!0,hostTransferTime:sv(),events:[...i.events,a]}),console.log("\ud638\uc2a4\ud2b8 \uc5ed\ud560\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc774\uc804\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),h(!1),!0}catch(s){return console.error("\ud638\uc2a4\ud2b8 \uc5ed\ud560 \uc218\ub3d9 \uc774\uc804 \uc911 \uc624\ub958:",s),!1}},updatePlayerActivity:p}};var Yv=n(579);const Zv=function(e){let{mapData:t,nations:n}=e;const r=e=>{if(!e)return"#cccccc";return{"\uc5d0\ub77c\uc2dc\uc544":"#ff6b6b","\ube0c\ub77c\uce74\ub2e4":"#4ecdc4","\uc544\ube14\ub9ac":"#45b7d1"}[e]||"#cccccc"};return(0,Yv.jsxs)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4",children:[(0,Yv.jsx)("h3",{className:"text-center text-xl font-bold mb-3 text-white",children:"\uc138\uacc4 \uc9c0\ub3c4"}),(0,Yv.jsx)("div",{className:"relative w-full overflow-auto",children:(0,Yv.jsxs)("svg",{viewBox:"0 0 350 300",className:"w-full border border-gray-600 bg-gray-700 rounded-lg",style:{minHeight:"250px"},children:[Object.values(t.territories).map(e=>e.neighbors.map(n=>{const r=t.territories[n];return!r||e.id>n?null:(0,Yv.jsx)("line",{x1:e.x,y1:e.y,x2:r.x,y2:r.y,stroke:"#666",strokeWidth:"1",strokeDasharray:"3,3"},`${e.id}-${n}`)})),Object.values(t.territories).map(e=>(0,Yv.jsxs)("g",{children:[(0,Yv.jsx)("circle",{cx:e.x,cy:e.y,r:"25",fill:r(e.owner),stroke:"#333",strokeWidth:"2",className:"transition-all duration-300 hover:stroke-white hover:stroke-3"}),e.isCapital&&(0,Yv.jsx)("circle",{cx:e.x,cy:e.y,r:"30",fill:"none",stroke:"#ffd700",strokeWidth:"3",className:"animate-pulse"}),(0,Yv.jsx)("text",{x:e.x,y:e.y-35,textAnchor:"middle",fontSize:"12",fontWeight:"bold",fill:"#fff",className:"pointer-events-none",children:e.name}),(0,Yv.jsx)("text",{x:e.x,y:e.y+5,textAnchor:"middle",fontSize:"11",fill:"#fff",className:"pointer-events-none",children:e.army})]},e.id))]})}),(0,Yv.jsx)("div",{className:"mt-3 flex flex-wrap justify-center gap-3",children:Object.entries(n).map(e=>{let[t,n]=e;return(0,Yv.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Yv.jsx)("div",{className:"w-4 h-4 rounded-full border border-gray-600",style:{backgroundColor:r(t)}}),(0,Yv.jsx)("span",{className:"text-sm text-gray-200",children:t})]},t)})})]})};const eb=function(e){let{gameData:t,currentPlayer:n,onEndTurn:r}=e;const{isMinWidth:i}=Lv(),s=t.players.filter(e=>"playing"===e.status),o=s.filter(e=>e.isTurnReady),a=!n||n.isTurnReady,l=s.length>0?Math.round(o.length/s.length*100):0;return(0,Yv.jsxs)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4",children:[(0,Yv.jsxs)("div",{className:"flex flex-wrap items-center justify-between mb-3",children:[(0,Yv.jsxs)("h3",{className:"text-xl font-bold text-white",children:["\ud134 ",t.turn," \uc9c4\ud589 \uc0c1\ud669"]}),(0,Yv.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Yv.jsxs)("span",{className:"text-gray-300 text-sm",children:["\uc900\ube44 \uc644\ub8cc: ",o.length,"/",s.length]}),(0,Yv.jsx)("div",{className:"w-16 h-4 bg-gray-700 rounded-full overflow-hidden",children:(0,Yv.jsx)("div",{className:"h-full bg-green-500 transition-all duration-500 ease-out",style:{width:`${l}%`}})})]})]}),(0,Yv.jsx)("div",{className:"mb-4 space-y-2",children:s.map(e=>(0,Yv.jsxs)("div",{className:"flex justify-between items-center p-2 rounded-md "+(e.isTurnReady?"bg-green-900/50 border border-green-700":"bg-red-900/30 border border-red-800"),children:[(0,Yv.jsxs)("span",{className:"text-gray-200",children:[e.name," (",e.nation,")"]}),(0,Yv.jsx)("span",{className:"text-sm px-2 py-1 rounded-full "+(e.isTurnReady?"bg-green-700 text-green-100":"bg-red-800 text-red-100"),children:e.isTurnReady?"\u2713 \uc900\ube44 \uc644\ub8cc":"\ub300\uae30 \uc911..."})]},e.uid))}),n&&!n.isTurnReady&&(0,Yv.jsx)("button",{onClick:r,disabled:a,className:"w-full py-3 px-4 rounded-md font-bold text-white transition-all duration-200 "+(a?"bg-gray-600 cursor-not-allowed opacity-50":"bg-green-600 hover:bg-green-700 active:transform active:scale-95"),children:"\ud134 \uc885\ub8cc"}),o.length===s.length&&s.length>0&&(0,Yv.jsx)("div",{className:"mt-3 text-center text-yellow-300 animate-pulse",children:"\ubaa8\ub4e0 \ud50c\ub808\uc774\uc5b4\uac00 \uc900\ube44 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ud134 \ucc98\ub9ac \uc911..."})]})};const tb=function(e){var t,n;let{myNation:r,gameData:i}=e;const{isMinWidth:s}=Lv();if(!r)return(0,Yv.jsx)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4 text-center text-gray-300",children:"\uad6d\uac00\ub97c \uc120\ud0dd\ud574\uc8fc\uc138\uc694."});const o=Object.values(i.map.territories).filter(e=>e.owner===r.name),a=o.reduce((e,t)=>e+t.army,0),l=(null===(t=r.technologies)||void 0===t||null===(n=t.agriculture)||void 0===n?void 0:n.level)||0,c=50*o.length*(1+.15*l);return(0,Yv.jsxs)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4",children:[(0,Yv.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Yv.jsxs)("h3",{className:"text-xl font-bold text-white",children:[r.name," \ub300\uc2dc\ubcf4\ub4dc"]}),(0,Yv.jsxs)("div",{className:"px-3 py-1 bg-blue-900/50 border border-blue-700 rounded-full text-blue-200 text-sm",children:["\ud134\ub2f9 \uc218\uc785: +",Math.round(c)]})]}),(0,Yv.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,Yv.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-3 border border-gray-600",children:[(0,Yv.jsx)("div",{className:"text-gray-400 text-sm mb-1",children:"\uc790\uc6d0"}),(0,Yv.jsx)("div",{className:"text-xl font-bold text-yellow-300",children:r.resources.toLocaleString()})]}),(0,Yv.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-3 border border-gray-600",children:[(0,Yv.jsx)("div",{className:"text-gray-400 text-sm mb-1",children:"\uc548\uc815\ub3c4"}),(0,Yv.jsxs)("div",{className:"text-xl font-bold "+(u=r.stability,u>=80?"text-green-400":u>=60?"text-green-300":u>=40?"text-yellow-300":u>=20?"text-orange-300":"text-red-400"),children:[r.stability,"%"]})]}),(0,Yv.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-3 border border-gray-600",children:[(0,Yv.jsx)("div",{className:"text-gray-400 text-sm mb-1",children:"\uc601\ud1a0"}),(0,Yv.jsxs)("div",{className:"text-xl font-bold text-blue-300",children:[o.length,"\uac1c"]})]}),(0,Yv.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-3 border border-gray-600",children:[(0,Yv.jsx)("div",{className:"text-gray-400 text-sm mb-1",children:"\ucd1d \uad70\uc0ac\ub825"}),(0,Yv.jsx)("div",{className:"text-xl font-bold text-red-300",children:a.toLocaleString()})]})]}),(0,Yv.jsxs)("div",{children:[(0,Yv.jsxs)("h4",{className:"text-white font-bold mb-2 flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),"\ubcf4\uc720 \uc601\ud1a0"]}),(0,Yv.jsx)("div",{className:"max-h-48 overflow-y-auto pr-1 space-y-1",children:o.map(e=>(0,Yv.jsxs)("div",{className:"flex justify-between items-center p-2 rounded-md text-sm "+(e.isCapital?"bg-yellow-900/30 border border-yellow-800":"bg-gray-700/50 border border-gray-600"),children:[(0,Yv.jsxs)("div",{className:"flex items-center",children:[e.isCapital&&(0,Yv.jsx)("span",{className:"text-yellow-400 mr-1",children:"\ud83d\udc51"}),(0,Yv.jsx)("span",{className:"text-gray-200",children:e.name})]}),(0,Yv.jsxs)("div",{className:"flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-red-400 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{d:"M10 3.5a1.5 1.5 0 013 0V4a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-.5a1.5 1.5 0 000 3h.5a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-.5a1.5 1.5 0 00-3 0v.5a1 1 0 01-1 1H6a1 1 0 01-1-1v-3a1 1 0 00-1-1h-.5a1.5 1.5 0 010-3H4a1 1 0 001-1V6a1 1 0 011-1h3a1 1 0 001-1v-.5z"})}),(0,Yv.jsx)("span",{className:"text-red-300 font-medium",children:e.army})]})]},e.id))})]})]});var u};const nb=function(e){let{db:t,gameData:n,myNation:i,user:s,onCommand:o}=e;const[a,l]=(0,r.useState)("\uad6d\ubc29"),[c,u]=(0,r.useState)(""),[h,d]=(0,r.useState)(""),[f,p]=(0,r.useState)(!1);if(!i)return(0,Yv.jsx)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4 text-center text-gray-300",children:"\uad6d\uac00\ub97c \uc120\ud0dd\ud574\uc8fc\uc138\uc694."});const m=n.advisors[s.uid]||{},g={"\uad6d\ubc29":{name:"\uad6d\ubc29\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 '\ub9e4\ud30c'\uc774\uba70, \uad70\uc0ac\uc801 \ud574\uacb0\ucc45\uc744 \uc120\ud638\ud569\ub2c8\ub2e4.",ambition:"\uad70\uc0ac\ub825 \uadf9\ub300\ud654",icon:"\ud83d\udee1\ufe0f"},"\uc7ac\ubb34":{name:"\uc7ac\ubb34\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 \uc2e0\uc911\ud55c '\uad00\ub8cc'\uc774\uba70, \uacbd\uc81c\uc801 \uc548\uc815\uc131\uc744 \ucd5c\uc6b0\uc120\uc73c\ub85c \uc0dd\uac01\ud569\ub2c8\ub2e4.",ambition:"\uad6d\uace0 \ucd5c\ub300\ud654",icon:"\ud83d\udcb0"},"\uc678\uad50":{name:"\uc678\uad50\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 '\ube44\ub458\uae30\ud30c'\uc774\uba70, \ub300\ud654\uc640 \ud611\uc0c1\uc744 \uc120\ud638\ud569\ub2c8\ub2e4.",ambition:"\ubaa8\ub4e0 \uad6d\uac00\uc640 \ub3d9\ub9f9",icon:"\ud83e\udd1d"},"\uc815\ubcf4":{name:"\uc815\ubcf4\ubd80 \uc7a5\uad00",persona:"\ub2f9\uc2e0\uc740 '\ud604\uc2e4\uc8fc\uc758\uc790'\uc774\uba70, \ucca9\ubcf4\uc640 \uacf5\uc791\uc744 \uc120\ud638\ud569\ub2c8\ub2e4.",ambition:"\uc815\ubcf4\ub9dd \uc7a5\uc545",icon:"\ud83d\udd0d"}},y=async()=>{if(c.trim()){p(!0),d("\ucc98\ub9ac \uc911...");try{const e=await o({action:"advisor_command",advisor:a,command:c});d(e.message||"\uba85\ub839\uc744 \ucc98\ub9ac\ud588\uc2b5\ub2c8\ub2e4.")}catch(e){d(`\uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ${e.message}`)}finally{p(!1),u("")}}};return(0,Yv.jsxs)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4",children:[(0,Yv.jsx)("h3",{className:"text-xl font-bold text-white mb-3",children:"AI \ubcf4\uc88c\uad00"}),(0,Yv.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:Object.keys(g).map(e=>{var t;const n=(null===(t=m[e])||void 0===t?void 0:t.loyalty)||50,r=(e=>e>=80?{color:"bg-green-600",text:"\ucda9\uc131"}:e>=60?{color:"bg-green-500",text:"\uc2e0\ub8b0"}:e>=40?{color:"bg-yellow-500",text:"\uc911\ub9bd"}:e>=20?{color:"bg-orange-500",text:"\uc758\uc2ec"}:{color:"bg-red-600",text:"\ubc30\uc2e0"})(n);return(0,Yv.jsx)("button",{onClick:()=>l(e),className:"flex-1 min-w-[80px] p-2 rounded-md transition-all duration-200 "+(a===e?"bg-indigo-700 text-white ring-2 ring-indigo-400":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:(0,Yv.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Yv.jsx)("span",{className:"text-lg mb-1",children:g[e].icon}),(0,Yv.jsx)("span",{className:"text-sm font-medium",children:e}),(0,Yv.jsxs)("div",{className:`mt-1 px-2 py-0.5 rounded-full text-xs text-white ${r.color}`,children:[r.text," ",n]})]})},e)})}),(0,Yv.jsx)("div",{className:"mb-4 p-3 bg-gray-700 rounded-lg border-l-4 border-indigo-500",children:(0,Yv.jsxs)("div",{className:"flex items-center",children:[(0,Yv.jsx)("span",{className:"text-2xl mr-2",children:g[a].icon}),(0,Yv.jsxs)("div",{children:[(0,Yv.jsx)("h4",{className:"font-bold text-white",children:g[a].name}),(0,Yv.jsxs)("p",{className:"text-sm text-gray-300 italic",children:["\u201c",g[a].persona,"\u201d"]}),(0,Yv.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["\uc57c\ub9dd: ",g[a].ambition]})]})]})}),(0,Yv.jsxs)("div",{className:"mb-4",children:[(0,Yv.jsxs)("div",{className:"relative",children:[(0,Yv.jsx)("input",{type:"text",value:c,onChange:e=>u(e.target.value),placeholder:"\uba85\ub839\uc744 \uc785\ub825\ud558\uc138\uc694 (\uc608: \ubd81\ubd80 \uc0b0\ub9e5\uc744 \uacf5\uaca9\ud574, \uad70\ub300 50\uba85 \ud6c8\ub828, \ub18d\uc5c5 \uae30\uc220 \uc5f0\uad6c)",className:"w-full p-3 pr-24 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",onKeyPress:e=>"Enter"===e.key&&!f&&y(),disabled:f}),(0,Yv.jsx)("button",{onClick:y,disabled:f||!c.trim(),className:"absolute right-2 top-2 px-4 py-1 bg-indigo-600 text-white rounded-md hover:bg-indigo-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:f?(0,Yv.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Yv.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Yv.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"\uc804\uc1a1"})]}),(0,Yv.jsx)("p",{className:"mt-1 text-xs text-gray-400",children:"\ubcf4\uc88c\uad00\uc5d0\uac8c \uc790\uc5f0\uc5b4\ub85c \uba85\ub839\uc744 \ub0b4\ub9b4 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc608: \u201c\ubd81\ubd80 \uc0b0\ub9e5\uc744 \uacf5\uaca9\ud574\u201d, \u201c\uad70\ub300 50\uba85 \ud6c8\ub828\u201d, \u201c\ub18d\uc5c5 \uae30\uc220 \uc5f0\uad6c\u201d"})]}),h&&(0,Yv.jsxs)("div",{className:"p-3 bg-gray-700 border border-gray-600 rounded-lg whitespace-pre-line text-sm",children:[(0,Yv.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Yv.jsx)("span",{className:"text-lg mr-2",children:g[a].icon}),(0,Yv.jsxs)("span",{className:"font-bold text-white",children:[g[a].name,":"]})]}),(0,Yv.jsx)("p",{className:"text-gray-200",children:h})]})]})};const rb=function(e){let{db:t,gameData:n,myNation:i}=e;const{isMinWidth:s}=Lv(),[o,a]=(0,r.useState)(""),[l,c]=(0,r.useState)("alliance"),[u,h]=(0,r.useState)(""),[d,f]=(0,r.useState)(!1);if(!i)return(0,Yv.jsx)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4 text-center text-gray-300",children:"\uad6d\uac00\ub97c \uc120\ud0dd\ud574\uc8fc\uc138\uc694."});const p=Object.keys(n.nations).filter(e=>e!==i.name&&"active"===n.nations[e].status),m={alliance:{icon:"\ud83e\udd1d",title:"\ub3d9\ub9f9 \uc81c\uc548",description:"\uc591\uad6d\uc740 \uc11c\ub85c\ub97c \uc9c0\uc6d0\ud558\uba70, \uc548\uc815\ub3c4\uac00 \uc99d\uac00\ud558\uace0 \uc218\ub3c4\uc5d0 \uad70\ub300\uac00 \ucd94\uac00\ub429\ub2c8\ub2e4."},trade:{icon:"\ud83d\udcb0",title:"\ubb34\uc5ed \ud611\uc815",description:"\uc591\uad6d\uc740 \uc989\uc2dc \uc790\uc6d0\uc744 \uc5bb\uace0, \uc678\uad50 \uae30\uc220 \ub808\ubca8\uc5d0 \ub530\ub77c \ucd94\uac00 \ubcf4\ub108\uc2a4\ub97c \ubc1b\uc2b5\ub2c8\ub2e4."},non_aggression:{icon:"\ud83d\udd4a\ufe0f",title:"\ubd88\uac00\uce68 \uc870\uc57d",description:"\uc591\uad6d\uc740 \uc11c\ub85c\ub97c \uacf5\uaca9\ud558\uc9c0 \uc54a\uae30\ub85c \uc57d\uc18d\ud558\uba70, \uc548\uc815\ub3c4\uac00 \uc99d\uac00\ud569\ub2c8\ub2e4."},military_access:{icon:"\ud83d\udeb6",title:"\uad70\uc0ac \ud1b5\ud589\uad8c",description:"\uc591\uad6d\uc740 \uc11c\ub85c\uc758 \uc601\ud1a0\ub97c \ud1b5\uacfc\ud560 \uc218 \uc788\uc73c\uba70, \uc18c\ub7c9\uc758 \uc548\uc815\ub3c4\uac00 \uc99d\uac00\ud569\ub2c8\ub2e4."}},g=async(e,r)=>{f(!0);try{const h=zg(t,"games",n.id),d=n.diplomacy.proposals.map(t=>t.id===e.id?{...t,status:r?"accepted":"rejected"}:t);let p={"diplomacy.proposals":d,events:ov({turn:n.turn,type:"diplomacy",content:`${i.name}\uc774 ${e.from}\uc758 ${m[e.type].title}\uc744 ${r?"\uc218\ub77d":"\uac70\ubd80"}\ud588\uc2b5\ub2c8\ub2e4.`})};if(r){var s,o,a,l;const t={nations:[e.from,e.to],type:e.type,turn:n.turn,id:Date.now().toString()};p["diplomacy.treaties"]=ov(t);const r=n.nations[e.from],i=n.nations[e.to],h=(null===r||void 0===r||null===(s=r.technologies)||void 0===s||null===(o=s.diplomacy)||void 0===o?void 0:o.level)||0,d=(h+((null===i||void 0===i||null===(a=i.technologies)||void 0===a||null===(l=a.diplomacy)||void 0===l?void 0:l.level)||0))/2,f=5,m=d>0?Math.floor(d*Fv.diplomacy.stabilityBonusPerLevel):0,g=f+m;if("trade"===e.type){const t=50+10*d;p[`nations.${e.from}.resources`]=av(t),p[`nations.${e.to}.resources`]=av(t),p.events=ov({turn:n.turn,type:"economy",content:`${e.from}\uacfc(\uc640) ${e.to} \uc0ac\uc774\uc758 \ubb34\uc5ed \ud611\uc815\uc73c\ub85c \uc591\uad6d\uc740 ${t} \uc790\uc6d0\uc744 \uc5bb\uc5c8\uc2b5\ub2c8\ub2e4. (\uc678\uad50 \uae30\uc220 \ubcf4\ub108\uc2a4: +${t-50})`})}else if("non_aggression"===e.type)p[`nations.${e.from}.stability`]=av(g),p[`nations.${e.to}.stability`]=av(g),p.events=ov({turn:n.turn,type:"diplomacy",content:`${e.from}\uacfc(\uc640) ${e.to} \uc0ac\uc774\uc758 \ubd88\uac00\uce68 \uc870\uc57d\uc73c\ub85c \uc591\uad6d\uc758 \uc548\uc815\ub3c4\uac00 ${g} \uc99d\uac00\ud588\uc2b5\ub2c8\ub2e4. (\uc678\uad50 \uae30\uc220 \ubcf4\ub108\uc2a4: +${m})`});else if("alliance"===e.type){var c,u;p[`nations.${e.from}.stability`]=av(g),p[`nations.${e.to}.stability`]=av(g);const t=null===(c=Object.values(n.map.territories).find(t=>t.owner===e.from&&t.isCapital))||void 0===c?void 0:c.id,r=null===(u=Object.values(n.map.territories).find(t=>t.owner===e.to&&t.isCapital))||void 0===u?void 0:u.id;t&&(p[`map.territories.${t}.army`]=av(10)),r&&(p[`map.territories.${r}.army`]=av(10)),p.events=ov({turn:n.turn,type:"diplomacy",content:`${e.from}\uacfc(\uc640) ${e.to} \uc0ac\uc774\uc758 \ub3d9\ub9f9\uc73c\ub85c \uc591\uad6d\uc758 \uc548\uc815\ub3c4\uac00 ${g} \uc99d\uac00\ud558\uace0 \uc218\ub3c4\uc5d0 10\uba85\uc758 \uad70\ub300\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.`})}else"military_access"===e.type&&(p[`nations.${e.from}.stability`]=av(Math.floor(g/2)),p[`nations.${e.to}.stability`]=av(Math.floor(g/2)),p.events=ov({turn:n.turn,type:"diplomacy",content:`${e.from}\uacfc(\uc640) ${e.to} \uc0ac\uc774\uc758 \uad70\uc0ac \ud1b5\ud589\uad8c \ud611\uc815\uc774 \uccb4\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc591\uad6d\uc740 \uc11c\ub85c\uc758 \uc601\ud1a0\ub97c \ud1b5\uacfc\ud560 \uc218 \uc788\uac8c \ub418\uc5c8\uc2b5\ub2c8\ub2e4.`}))}await Yy(h,p),f(!1)}catch(h){console.error("\uc81c\uc548 \uc751\ub2f5 \uc911 \uc624\ub958:",h),f(!1)}},y=n.diplomacy.proposals.filter(e=>e.to===i.name&&"pending"===e.status),v=n.diplomacy.proposals.filter(e=>e.from===i.name),b=n.diplomacy.treaties.filter(e=>e.nations.includes(i.name));return(0,Yv.jsxs)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4",children:[(0,Yv.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"\uc678\uad50"}),(0,Yv.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-4 border border-gray-600 mb-6",children:[(0,Yv.jsxs)("h4",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{d:"M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"})}),"\uc0c8 \uc81c\uc548"]}),(0,Yv.jsxs)("div",{className:"space-y-3",children:[(0,Yv.jsxs)("div",{children:[(0,Yv.jsx)("label",{className:"block text-gray-300 text-sm mb-1",children:"\ub300\uc0c1 \uad6d\uac00"}),(0,Yv.jsxs)("select",{value:o,onChange:e=>a(e.target.value),className:"w-full bg-gray-800 border border-gray-600 rounded-md p-2 text-white",disabled:d,children:[(0,Yv.jsx)("option",{value:"",children:"\ub300\uc0c1 \uc120\ud0dd"}),p.map(e=>(0,Yv.jsx)("option",{value:e,children:e},e))]})]}),(0,Yv.jsxs)("div",{children:[(0,Yv.jsx)("label",{className:"block text-gray-300 text-sm mb-1",children:"\uc81c\uc548 \uc720\ud615"}),(0,Yv.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(m).map(e=>{let[t,n]=e;return(0,Yv.jsxs)("button",{onClick:()=>c(t),className:"p-2 rounded-md flex items-center justify-center transition-colors "+(l===t?"bg-blue-700 text-white border border-blue-500":"bg-gray-700 text-gray-300 border border-gray-600 hover:bg-gray-600"),disabled:d,children:[(0,Yv.jsx)("span",{className:"mr-2",children:n.icon}),(0,Yv.jsx)("span",{children:n.title})]},t)})}),(0,Yv.jsx)("p",{className:"mt-2 text-sm text-gray-400",children:m[l].description})]}),(0,Yv.jsxs)("div",{children:[(0,Yv.jsx)("label",{className:"block text-gray-300 text-sm mb-1",children:"\uc81c\uc548 \ub0b4\uc6a9"}),(0,Yv.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),placeholder:"\uc81c\uc548 \ub0b4\uc6a9\uc744 \uc785\ub825\ud558\uc138\uc694...",className:"w-full bg-gray-800 border border-gray-600 rounded-md p-2 text-white h-20 resize-none",disabled:d})]}),(0,Yv.jsx)("button",{onClick:async()=>{if(o&&u.trim()){f(!0);try{const e={from:i.name,to:o,type:l,text:u,turn:n.turn,status:"pending",id:Date.now().toString()},r=zg(t,"games",n.id);await Yy(r,{"diplomacy.proposals":ov(e),events:ov({turn:n.turn,type:"diplomacy",content:`${i.name}\uc774 ${o}\uc5d0\uac8c ${m[l].title}\uc744 \ud588\uc2b5\ub2c8\ub2e4.`})}),h(""),f(!1)}catch(e){console.error("\uc81c\uc548 \uc804\uc1a1 \uc911 \uc624\ub958:",e),f(!1)}}},disabled:!o||!u.trim()||d,className:"w-full py-2 rounded-md font-semibold transition-colors "+(o&&u.trim()&&!d?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-600 text-gray-400 cursor-not-allowed"),children:d?(0,Yv.jsxs)("span",{className:"flex items-center justify-center",children:[(0,Yv.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Yv.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Yv.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"\uc81c\uc548 \uc804\uc1a1 \uc911..."]}):"\uc81c\uc548 \ubcf4\ub0b4\uae30"})]})]}),y.length>0&&(0,Yv.jsxs)("div",{className:"mb-6",children:[(0,Yv.jsxs)("h4",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{fillRule:"evenodd",d:"M5 3a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2V5a2 2 0 00-2-2H5zm0 2h10v7h-2l-1 2H8l-1-2H5V5z",clipRule:"evenodd"})}),"\ubc1b\uc740 \uc81c\uc548"]}),(0,Yv.jsx)("div",{className:"space-y-3",children:y.map(e=>(0,Yv.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-3 border border-gray-600",children:[(0,Yv.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Yv.jsx)("span",{className:"text-xl mr-2",children:m[e.type].icon}),(0,Yv.jsxs)("div",{children:[(0,Yv.jsxs)("div",{className:"text-white font-medium",children:[e.from,"\uc758 ",m[e.type].title]}),(0,Yv.jsxs)("div",{className:"text-sm text-gray-400",children:["\ud134 ",e.turn,"\uc5d0 \uc81c\uc548\ub428"]})]})]}),(0,Yv.jsxs)("p",{className:"text-gray-300 text-sm mb-3 border-l-2 border-gray-500 pl-2 italic",children:["\u201c",e.text,"\u201d"]}),(0,Yv.jsxs)("div",{className:"flex space-x-2",children:[(0,Yv.jsx)("button",{onClick:()=>g(e,!0),disabled:d,className:"flex-1 py-1 rounded-md font-medium text-sm transition-colors "+(d?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"),children:"\uc218\ub77d"}),(0,Yv.jsx)("button",{onClick:()=>g(e,!1),disabled:d,className:"flex-1 py-1 rounded-md font-medium text-sm transition-colors "+(d?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"),children:"\uac70\ubd80"})]})]},e.id))})]}),b.length>0&&(0,Yv.jsxs)("div",{className:"mb-6",children:[(0,Yv.jsxs)("h4",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"\uccb4\uacb0\ub41c \uc870\uc57d"]}),(0,Yv.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:b.map(e=>{const t=e.nations.find(e=>e!==i.name),n=m[e.type];return(0,Yv.jsx)("div",{className:"bg-gray-700/50 rounded-lg p-3 border border-green-800",children:(0,Yv.jsxs)("div",{className:"flex items-center",children:[(0,Yv.jsx)("span",{className:"text-xl mr-2",children:n.icon}),(0,Yv.jsxs)("div",{children:[(0,Yv.jsxs)("div",{className:"text-white font-medium",children:[t,"\uc640\uc758 ",n.title]}),(0,Yv.jsxs)("div",{className:"text-xs text-gray-400",children:["\ud134 ",e.turn,"\uc5d0 \uccb4\uacb0\ub428"]})]})]})},e.id)})})]}),v.length>0&&(0,Yv.jsxs)("div",{children:[(0,Yv.jsxs)("h4",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})}),"\ubcf4\ub0b8 \uc81c\uc548"]}),(0,Yv.jsx)("div",{className:"space-y-1",children:v.map(e=>{let t="bg-yellow-700",n="\ub300\uae30 \uc911";return"accepted"===e.status?(t="bg-green-700",n="\uc218\ub77d\ub428"):"rejected"===e.status&&(t="bg-red-700",n="\uac70\ubd80\ub428"),(0,Yv.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-700/30 rounded-md",children:[(0,Yv.jsxs)("div",{className:"flex items-center",children:[(0,Yv.jsx)("span",{className:"text-lg mr-2",children:m[e.type].icon}),(0,Yv.jsxs)("span",{className:"text-gray-300 text-sm",children:[e.to,"\uc5d0\uac8c: ",m[e.type].title]})]}),(0,Yv.jsx)("span",{className:`text-xs px-2 py-1 rounded-full text-white ${t}`,children:n})]},e.id)})})]}),0===p.length&&(0,Yv.jsxs)("div",{className:"text-center py-6 text-gray-400",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto mb-3 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Yv.jsx)("p",{children:"\uc678\uad50 \uad00\uacc4\ub97c \ub9fa\uc744 \uc218 \uc788\ub294 \uad6d\uac00\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]})};const ib=function(e){let{myNation:t,db:n,gameData:i,onResearch:s}=e;const{isMinWidth:o}=Lv(),[a,l]=r.useState(null);if(!t)return(0,Yv.jsx)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4 text-center text-gray-300",children:"\uad6d\uac00\ub97c \uc120\ud0dd\ud574\uc8fc\uc138\uc694."});const c=(e,t)=>{const n=Fv[e];switch(e){case"agriculture":return`\uc601\ud1a0\ub2f9 \uc790\uc6d0 \uc0dd\uc0b0\ub7c9 +${Math.round(t*n.effectPerLevel*100)}%`;case"engineering":return`\uad70\uc0ac \ud6c8\ub828 \ube44\uc6a9 -${Math.round(t*n.discountPerLevel*100)}%, \uc804\ud22c\ub825 +${Math.round(t*n.combatBonusPerLevel*100)}%`;case"espionage":return`\uc801\uad6d \uc548\uc815\ub3c4 \uac10\uc18c \ud6a8\uacfc +${t*n.stabilityEffectPerLevel}, \uc815\ubcf4 \ud68d\ub4dd \ud655\ub960 +${Math.round(t*n.infoChancePerLevel*100)}%`;case"diplomacy":return`\uc870\uc57d \uccb4\uacb0 \uc2dc \uc548\uc815\ub3c4 +${t*n.stabilityBonusPerLevel}, \uc81c\uc548 \uc218\ub77d \ud655\ub960 +${Math.round(t*n.acceptanceChancePerLevel*100)}%`;default:return""}};return(0,Yv.jsxs)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4",children:[(0,Yv.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"\uae30\uc220 \ud604\ud669"}),(0,Yv.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(Fv).map(e=>{var r;let[o,u]=e;const h=(null===(r=t.technologies[o])||void 0===r?void 0:r.level)||0,d=u.baseCost*(h+1),f=h>=u.maxLevel,p=t.resources>=d,m=a===o;let g="default";m?g="researching":f?g="maxed":p||(g="cantAfford");const y={default:`\uc5f0\uad6c (${d} \uc790\uc6d0)`,researching:"\uc5f0\uad6c \uc911...",maxed:"\ucd5c\ub300 \ub808\ubca8",cantAfford:`\uc790\uc6d0 \ubd80\uc871 (${d} \ud544\uc694)`};return(0,Yv.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-4 border border-gray-600 flex flex-col",children:[(0,Yv.jsxs)("div",{className:"flex items-center mb-3",children:[(0,Yv.jsx)("span",{className:"text-2xl mr-3",children:(v=o,{agriculture:"\ud83c\udf3e",engineering:"\u2699\ufe0f",espionage:"\ud83d\udd75\ufe0f",diplomacy:"\ud83e\udd1d"}[v]||"\ud83d\udcda")}),(0,Yv.jsxs)("div",{children:[(0,Yv.jsx)("h4",{className:"text-lg font-semibold text-white",children:u.name}),(0,Yv.jsx)("p",{className:"text-sm text-gray-400",children:u.description})]})]}),(0,Yv.jsxs)("div",{className:"mb-3",children:[(0,Yv.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Yv.jsxs)("span",{className:"text-gray-300 text-sm",children:["\ud604\uc7ac \ub808\ubca8: ",h]}),(0,Yv.jsxs)("span",{className:"text-gray-300 text-sm",children:["\ucd5c\ub300: ",u.maxLevel]})]}),(0,Yv.jsx)("div",{className:"w-full h-2 bg-gray-600 rounded-full overflow-hidden",children:(0,Yv.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-500",style:{width:h/u.maxLevel*100+"%"}})})]}),(0,Yv.jsxs)("div",{className:"mb-3 text-sm text-gray-300 bg-gray-800/50 p-2 rounded border border-gray-700",children:[(0,Yv.jsx)("span",{className:"font-medium text-blue-300",children:"\ud604\uc7ac \ud6a8\uacfc:"})," ",c(o,h)]}),(0,Yv.jsx)("button",{onClick:()=>(async e=>{if(a)return;const r=Fv[e],o=t.technologies[e].level;if(o>=r.maxLevel)return;const c=r.baseCost*(o+1);if(!(t.resources<c)){l(e);try{if(s)await s({action:"research",tech_name:e});else if(n&&i){const s=zg(n,"games",i.id);await Yy(s,{[`nations.${t.name}.resources`]:av(-c),[`nations.${t.name}.technologies.${e}.level`]:av(1),events:ov({turn:i.turn,type:"technology",nation:t.name,content:`'${r.name}' \uae30\uc220 \uc5f0\uad6c\ub97c \uc644\ub8cc\ud588\uc2b5\ub2c8\ub2e4! (\ub808\ubca8 ${o+1})`})})}}catch(u){console.error("\uae30\uc220 \uc5f0\uad6c \uc911 \uc624\ub958:",u)}finally{l(null)}}})(o),disabled:m||f||!p,className:`mt-auto py-2 px-4 rounded-md text-sm font-medium transition-colors ${{default:"bg-blue-600 hover:bg-blue-700 text-white",researching:"bg-blue-700 text-white cursor-wait",maxed:"bg-gray-600 text-gray-400 cursor-not-allowed",cantAfford:"bg-red-900/50 text-red-300 cursor-not-allowed"}[g]}`,children:m?(0,Yv.jsxs)("span",{className:"flex items-center justify-center",children:[(0,Yv.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Yv.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Yv.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),y[g]]}):y[g]})]},o);var v})})]})};const sb=function(e){let{events:t,user:n}=e;const{isMinWidth:i}=Lv(),[s,o]=r.useState("all"),a=[...t].reverse(),l="all"===s?a:a.filter(e=>e.type===s),c=e=>({battle:{color:"bg-red-900/50 border-red-700",icon:"\u2694\ufe0f",label:"\uc804\ud22c"},conquest:{color:"bg-green-900/50 border-green-700",icon:"\ud83c\udfc6",label:"\uc815\ubcf5"},elimination:{color:"bg-pink-900/50 border-pink-700",icon:"\ud83d\udc80",label:"\uba78\ub9dd"},diplomacy:{color:"bg-blue-900/50 border-blue-700",icon:"\ud83e\udd1d",label:"\uc678\uad50"},technology:{color:"bg-purple-900/50 border-purple-700",icon:"\ud83d\udd2c",label:"\uae30\uc220"},betrayal:{color:"bg-orange-900/50 border-orange-700",icon:"\ud83d\udde1\ufe0f",label:"\ubc30\uc2e0"},production:{color:"bg-teal-900/50 border-teal-700",icon:"\u2692\ufe0f",label:"\uc0dd\uc0b0"},stability:{color:"bg-gray-800/50 border-gray-700",icon:"\u2696\ufe0f",label:"\uc548\uc815\ub3c4"},dynamic_event:{color:"bg-yellow-900/50 border-yellow-700",icon:"\ud83c\udfad",label:"\uc774\ubca4\ud2b8"},economy:{color:"bg-yellow-900/50 border-yellow-700",icon:"\ud83d\udcb0",label:"\uacbd\uc81c"},game_start:{color:"bg-indigo-900/50 border-indigo-700",icon:"\ud83c\udfae",label:"\uac8c\uc784 \uc2dc\uc791"},victory:{color:"bg-yellow-900/50 border-yellow-700",icon:"\ud83d\udc51",label:"\uc2b9\ub9ac"},collapse:{color:"bg-red-900/50 border-red-700",icon:"\ud83c\udfda\ufe0f",label:"\ubd95\uad34"},troop_movement:{color:"bg-blue-900/50 border-blue-700",icon:"\ud83d\udeb6",label:"\ubd80\ub300 \uc774\ub3d9"},military:{color:"bg-red-900/50 border-red-700",icon:"\ud83d\udee1\ufe0f",label:"\uad70\uc0ac"}}[e]||{color:"bg-gray-800/50 border-gray-700",icon:"\ud83d\udcdc",label:"\uae30\ud0c0"}),u=["all",...new Set(t.map(e=>e.type))];return(0,Yv.jsxs)("div",{className:"border-2 border-gray-700 rounded-lg p-4 bg-gray-800 shadow-lg mb-4",children:[(0,Yv.jsxs)("div",{className:"flex flex-wrap items-center justify-between mb-4",children:[(0,Yv.jsx)("h3",{className:"text-xl font-bold text-white",children:"\uc774\ubca4\ud2b8 \ub85c\uadf8"}),(0,Yv.jsx)("div",{className:"flex flex-wrap gap-1 mt-2 sm:mt-0",children:u.map(e=>(0,Yv.jsx)("button",{onClick:()=>o(e),className:"px-2 py-1 text-xs rounded-full transition-colors "+(s===e?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"all"===e?"\uc804\uccb4":c(e).label},e))})]}),(0,Yv.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-1",children:l.length>0?l.map((e,t)=>{if(e.isPrivate&&e.recipient!==n.uid)return null;const r=c(e.type);return(0,Yv.jsx)("div",{className:`p-3 rounded-md border ${r.color} ${e.isPrivate?"ring-1 ring-yellow-500":""}`,children:(0,Yv.jsxs)("div",{className:"flex items-start",children:[(0,Yv.jsx)("span",{className:"text-xl mr-2 mt-0.5",children:r.icon}),(0,Yv.jsxs)("div",{children:[(0,Yv.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,Yv.jsxs)("span",{className:"text-gray-300 text-sm font-medium",children:["\ud134 ",e.turn]}),e.nation&&(0,Yv.jsx)("span",{className:"bg-gray-700 px-2 py-0.5 rounded-full text-xs text-gray-300",children:e.nation}),e.isPrivate&&(0,Yv.jsxs)("span",{className:"bg-yellow-900/70 px-2 py-0.5 rounded-full text-xs text-yellow-300 flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"\ube44\ubc00"]})]}),(0,Yv.jsx)("p",{className:"text-gray-200 text-sm",children:e.content})]})]})},t)}):(0,Yv.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto mb-3 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),(0,Yv.jsx)("p",{children:"\ud45c\uc2dc\ud560 \uc774\ubca4\ud2b8\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."})]})})]})},ob=[{id:"connecting",message:"\uc11c\ubc84\uc5d0 \uc5f0\uacb0 \uc911..."},{id:"auth",message:"\uc0ac\uc6a9\uc790 \uc778\uc99d \uc911..."},{id:"game_data",message:"\uac8c\uc784 \ub370\uc774\ud130 \ubd88\ub7ec\uc624\ub294 \uc911..."},{id:"map",message:"\uac8c\uc784 \ub9f5 \uc900\ube44 \uc911..."},{id:"resources",message:"\uac8c\uc784 \ub9ac\uc18c\uc2a4 \ub85c\ub529 \uc911..."},{id:"finalizing",message:"\ucd5c\uc885 \uc900\ube44 \uc911..."}],ab=["\ud301: \ubcf4\uc88c\uad00\uc758 \ucda9\uc131\ub3c4\ub97c \ub192\uac8c \uc720\uc9c0\ud558\uba74 \uc548\uc815\ub3c4\uc5d0 \uae0d\uc815\uc801\uc778 \uc601\ud5a5\uc744 \uc90d\ub2c8\ub2e4.","\ud301: \ub18d\uc5c5 \uae30\uc220\uc744 \uc5f0\uad6c\ud558\uba74 \uc790\uc6d0 \uc0dd\uc0b0\ub7c9\uc774 \uc99d\uac00\ud569\ub2c8\ub2e4.","\ud301: \uacf5\ud559 \uae30\uc220\uc740 \uc804\ud22c\ub825\uacfc \uac74\uc124 \ube44\uc6a9\uc5d0 \uc601\ud5a5\uc744 \uc90d\ub2c8\ub2e4.","\ud301: \uc218\ub3c4\ub97c \ubc29\uc5b4\ud558\ub294 \uac83\uc774 \uac00\uc7a5 \uc911\uc694\ud569\ub2c8\ub2e4. \uc218\ub3c4\uac00 \ud568\ub77d\ub418\uba74 \uad6d\uac00\uac00 \uba78\ub9dd\ud569\ub2c8\ub2e4.","\ud301: \uc790\uc6d0\uc774 \ubd80\uc871\ud558\uba74 \uc548\uc815\ub3c4\uac00 \uac10\uc18c\ud569\ub2c8\ub2e4. \uc790\uc6d0 \uad00\ub9ac\uc5d0 \uc8fc\uc758\ud558\uc138\uc694.","\ud301: \uc5ec\ub7ec \uc601\ud1a0\ub97c \uc18c\uc720\ud560\uc218\ub85d \ub354 \ub9ce\uc740 \uc790\uc6d0\uc744 \uc0dd\uc0b0\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.","\ud301: \ubcf4\uc88c\uad00\uc758 \uc870\uc5b8\uc744 \ud65c\uc6a9\ud558\uba74 \uac8c\uc784\uc744 \ub354 \ud6a8\uc728\uc801\uc73c\ub85c \uc9c4\ud589\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."];const lb=function(e){let{message:t,progress:n,stage:i,isLongLoading:s}=e;const[o,a]=(0,r.useState)(0),[l,c]=(0,r.useState)(Math.floor(Math.random()*ab.length)),[u,h]=(0,r.useState)(0),[d,f]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(i)return;const e=setInterval(()=>{a(e=>e<ob.length-1?e+1:e)},1500);return()=>clearInterval(e)},[i]),(0,r.useEffect)(()=>{const e=setInterval(()=>{h(e=>e+1),3===u&&f(!0),u>0&&u%15===0&&c(e=>(e+1)%ab.length)},1e3);return()=>clearInterval(e)},[u]);const p=i?ob.find(e=>e.id===i)||ob[0]:ob[o],m=void 0!==n?n:Math.min(Math.round(o/(ob.length-1)*100),100),g=s||u>10;return(0,Yv.jsx)("div",{className:"bg-gray-900 rounded-lg shadow-xl overflow-hidden border border-gray-700 p-8",children:(0,Yv.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,Yv.jsxs)("div",{className:"relative mb-8",children:[(0,Yv.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,Yv.jsxs)("div",{className:"text-indigo-500 text-xl font-bold",children:[m,"%"]})}),(0,Yv.jsxs)("svg",{className:"w-24 h-24",viewBox:"0 0 100 100",children:[(0,Yv.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#374151",strokeWidth:"8"}),(0,Yv.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#6366F1",strokeWidth:"8",strokeDasharray:""+2*Math.PI*40,strokeDashoffset:""+2*Math.PI*40*(1-m/100),transform:"rotate(-90 50 50)",className:"transition-all duration-300 ease-in-out"}),(0,Yv.jsx)("circle",{cx:"50",cy:"50",r:"20",fill:"#4F46E5",className:"animate-pulse"})]})]}),(0,Yv.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"\uac8c\uc784 \ub85c\ub529 \uc911..."}),(0,Yv.jsx)("p",{className:"text-gray-300 text-center mb-4",children:t||p.message}),(0,Yv.jsx)("div",{className:"flex justify-center space-x-1 mb-6",children:ob.map((e,t)=>(0,Yv.jsx)("div",{className:"w-2 h-2 rounded-full transition-colors duration-300 "+(t<=o?"bg-indigo-500":"bg-gray-600"),title:e.message},e.id))}),d&&(0,Yv.jsx)("div",{className:"bg-indigo-900/30 border border-indigo-800 rounded-lg p-4 max-w-md mt-2 text-center",children:(0,Yv.jsx)("p",{className:"text-indigo-300 text-sm",children:ab[l]})}),g&&(0,Yv.jsx)("p",{className:"text-gray-500 text-sm mt-6",children:"\ub85c\ub529\uc774 \uc608\uc0c1\ubcf4\ub2e4 \uc624\ub798 \uac78\ub9ac\uace0 \uc788\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc\ub9cc \ub354 \uae30\ub2e4\ub824\uc8fc\uc138\uc694..."}),(0,Yv.jsxs)("p",{className:"text-gray-600 text-xs mt-4",children:["\uacbd\uacfc \uc2dc\uac04: ",u,"\ucd08"]})]})})};const cb=function(e){let{error:t,onReturn:n,onRetry:r}=e;const i=(e=>{const t=(null===e||void 0===e?void 0:e.message)||"",n=(null===e||void 0===e?void 0:e.code)||"",r={connection:{title:"\uc5f0\uacb0 \uc624\ub958",message:"\uc11c\ubc84\uc5d0 \uc5f0\uacb0\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",resolution:["\uc778\ud130\ub137 \uc5f0\uacb0\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694.","\uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.","\ubb38\uc81c\uac00 \uc9c0\uc18d\ub418\uba74 \ube0c\ub77c\uc6b0\uc800\ub97c \uc0c8\ub85c\uace0\uce68\ud558\uc138\uc694."],icon:(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})})},auth:{title:"\uc778\uc99d \uc624\ub958",message:"\uc0ac\uc6a9\uc790 \uc778\uc99d\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",resolution:["\ube0c\ub77c\uc6b0\uc800\ub97c \uc0c8\ub85c\uace0\uce68\ud558\uc5ec \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694.","\ucfe0\ud0a4\uc640 \uce90\uc2dc\ub97c \uc0ad\uc81c\ud55c \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.","\ub2e4\ub978 \ube0c\ub77c\uc6b0\uc800\ub85c \uc811\uc18d\uc744 \uc2dc\ub3c4\ud574\ubcf4\uc138\uc694."],icon:(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})},data:{title:"\ub370\uc774\ud130 \uc624\ub958",message:"\uac8c\uc784 \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",resolution:["\ub85c\ube44\ub85c \ub3cc\uc544\uac00\uc11c \ub2e4\ub978 \uac8c\uc784\uc5d0 \ucc38\uc5ec\ud574\ubcf4\uc138\uc694.","\uac8c\uc784\uc774 \uc774\ubbf8 \uc885\ub8cc\ub418\uc5c8\uac70\ub098 \uc0ad\uc81c\ub418\uc5c8\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4.","\ube0c\ub77c\uc6b0\uc800\ub97c \uc0c8\ub85c\uace0\uce68\ud55c \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."],icon:(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},permission:{title:"\uad8c\ud55c \uc624\ub958",message:"\uac8c\uc784\uc5d0 \uc811\uadfc\ud560 \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.",resolution:["\uac8c\uc784 \ucd08\ub300\ub97c \ub2e4\uc2dc \ud655\uc778\ud574\uc8fc\uc138\uc694.","\uac8c\uc784 \ud638\uc2a4\ud2b8\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694.","\ub85c\ube44\ub85c \ub3cc\uc544\uac00\uc11c \uc0c8 \uac8c\uc784\uc744 \uc2dc\uc791\ud574\ubcf4\uc138\uc694."],icon:(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})},default:{title:"\uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4",message:"\uac8c\uc784\uc744 \ubd88\ub7ec\uc624\ub294 \uc911 \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.",resolution:["\ub85c\ube44\ub85c \ub3cc\uc544\uac00\uc11c \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.","\ube0c\ub77c\uc6b0\uc800\ub97c \uc0c8\ub85c\uace0\uce68\ud55c \ud6c4 \ub2e4\uc2dc \uc811\uc18d\ud574\ubcf4\uc138\uc694.","\uc7a0\uc2dc \ud6c4\uc5d0 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."],icon:(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}};let i="default";return t.includes("network")||t.includes("\uc5f0\uacb0")||t.includes("connection")||n.includes("unavailable")?i="connection":t.includes("auth")||t.includes("\uc778\uc99d")||t.includes("login")||n.includes("auth")?i="auth":t.includes("\ucc3e\uc744 \uc218 \uc5c6")||t.includes("not found")||t.includes("\ub370\uc774\ud130")||n.includes("not-found")?i="data":(t.includes("permission")||t.includes("\uad8c\ud55c")||t.includes("access")||n.includes("permission-denied"))&&(i="permission"),{...r[i],originalMessage:t}})(t);return(0,Yv.jsx)("div",{className:"bg-gray-900 rounded-lg shadow-xl overflow-hidden border border-gray-700 p-8",children:(0,Yv.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,Yv.jsx)("div",{className:"bg-red-900/30 p-4 rounded-full mb-6",children:i.icon}),(0,Yv.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:i.title}),(0,Yv.jsx)("p",{className:"text-gray-400 text-center mb-4",children:i.message}),(0,Yv.jsxs)("details",{className:"mb-6 w-full max-w-md",children:[(0,Yv.jsx)("summary",{className:"text-gray-500 cursor-pointer hover:text-gray-300 transition-colors text-sm",children:"\uc0c1\uc138 \uc624\ub958 \uc815\ubcf4 \ubcf4\uae30"}),(0,Yv.jsx)("p",{className:"mt-2 p-2 bg-gray-800 rounded text-gray-400 text-sm break-all",children:i.originalMessage||"\ucd94\uac00 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,Yv.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-4 mb-6 w-full max-w-md",children:[(0,Yv.jsx)("h3",{className:"text-indigo-400 font-medium mb-2",children:"\ud574\uacb0 \ubc29\ubc95:"}),(0,Yv.jsx)("ul",{className:"text-gray-300 text-sm space-y-2",children:i.resolution.map((e,t)=>(0,Yv.jsxs)("li",{className:"flex items-start",children:[(0,Yv.jsx)("span",{className:"inline-block bg-indigo-900/50 text-indigo-300 rounded-full w-5 h-5 flex items-center justify-center text-xs mr-2 mt-0.5",children:t+1}),e]},t))})]}),(0,Yv.jsxs)("div",{className:"flex space-x-4",children:[(0,Yv.jsx)("button",{onClick:n,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-900",children:"\ub85c\ube44\ub85c \ub3cc\uc544\uac00\uae30"}),r&&(0,Yv.jsx)("button",{onClick:r,className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900",children:"\ub2e4\uc2dc \uc2dc\ub3c4"})]})]})})};const ub=function(e){let{isWinner:t,winner:n,onReturn:r}=e;return(0,Yv.jsxs)("div",{className:"bg-gray-900 rounded-lg shadow-xl overflow-hidden border border-gray-700",children:[(0,Yv.jsx)("div",{className:"p-8 "+(t?"bg-gradient-to-r from-yellow-600 to-amber-600":"bg-gradient-to-r from-gray-800 to-gray-900"),children:(0,Yv.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[t?(0,Yv.jsx)("div",{className:"bg-yellow-500/30 p-4 rounded-full mb-6",children:(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-24 w-24 text-yellow-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}):(0,Yv.jsx)("div",{className:"bg-gray-700/30 p-4 rounded-full mb-6",children:(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-24 w-24 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Yv.jsx)("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4 text-center",children:t?"\uc2b9\ub9ac\ud588\uc2b5\ub2c8\ub2e4!":"\ud328\ubc30\ud588\uc2b5\ub2c8\ub2e4"}),(0,Yv.jsx)("p",{className:"text-xl text-gray-200 text-center mb-8",children:t?"\ub2f9\uc2e0\uc758 \ub6f0\uc5b4\ub09c \uc804\ub7b5\uacfc \uc678\uad50\ub85c \uc655\uad00\uc758 \ud68c\uc758\uc5d0\uc11c \uc2b9\ub9ac\ud588\uc2b5\ub2c8\ub2e4!":`${n}\uac00 \uc655\uad00\uc758 \ud68c\uc758\uc5d0\uc11c \uc2b9\ub9ac\ud588\uc2b5\ub2c8\ub2e4.`}),(0,Yv.jsx)("button",{onClick:r,className:"px-8 py-3 bg-indigo-600 hover:bg-indigo-700 text-white text-lg font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-900",children:"\ub85c\ube44\ub85c \ub3cc\uc544\uac00\uae30"})]})}),(0,Yv.jsxs)("div",{className:"p-6 border-t border-gray-700",children:[(0,Yv.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"\uac8c\uc784 \uacb0\uacfc"}),(0,Yv.jsx)("p",{className:"text-gray-400",children:t?"\ucd95\ud558\ud569\ub2c8\ub2e4! \ub2f9\uc2e0\uc740 \uc774 \uac8c\uc784\uc5d0\uc11c \uc2b9\ub9ac\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\ub978 \uac8c\uc784\uc744 \uc2dc\uc791\ud558\uac70\ub098 \uce5c\uad6c\ub4e4\uc744 \ucd08\ub300\ud558\uc5ec \uc0c8\ub85c\uc6b4 \uac8c\uc784\uc744 \uc990\uaca8\ubcf4\uc138\uc694.":"\uc544\uc27d\uac8c\ub3c4 \uc774\ubc88 \uac8c\uc784\uc5d0\uc11c\ub294 \ud328\ubc30\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub3c4\uc804\ud558\uc5ec \ub2e4\ub978 \uc804\ub7b5\uc744 \uc2dc\ub3c4\ud574\ubcf4\uc138\uc694."})]})]})};const hb=function(e){let{gameData:t,user:n,onSelectNation:r,onStartGame:i,onReturn:s}=e;const o=t.players.find(e=>e.uid===n.uid),a=Object.values(t.nations).filter(e=>!t.players.some(t=>t.nation===e.name)),l=t.players.filter(e=>e.nation).map(e=>{const t=e.uid===n.uid;return{name:e.nation,playerName:e.name,isCurrentUser:t}}),c=t.players.every(e=>e.nation)&&t.players.length>=2&&o.nation;return(0,Yv.jsxs)("div",{className:"bg-gray-900 rounded-lg shadow-xl overflow-hidden border border-gray-700",children:[(0,Yv.jsxs)("div",{className:"bg-gradient-to-r from-indigo-800 to-purple-800 p-6",children:[(0,Yv.jsx)("h2",{className:"text-2xl font-bold text-white",children:"\uac8c\uc784 \ub300\uae30\uc2e4"}),(0,Yv.jsxs)("p",{className:"text-indigo-200 mt-1",children:["\uac8c\uc784 ID: ",t.id.substring(0,8),"... | \ud50c\ub808\uc774\uc5b4: ",t.players.length,"\uba85"]})]}),(0,Yv.jsxs)("div",{className:"p-6",children:[(0,Yv.jsxs)("div",{className:"mb-8",children:[(0,Yv.jsxs)("h3",{className:"text-xl font-semibold text-white mb-4",children:["\ucc38\uac00\uc790 (",t.players.length,"\uba85)"]}),(0,Yv.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:t.players.map(e=>(0,Yv.jsx)("div",{className:"p-4 rounded-lg border "+(e.uid===n.uid?"border-indigo-500 bg-indigo-900/20":"border-gray-700 bg-gray-800/50"),children:(0,Yv.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Yv.jsxs)("div",{className:"flex items-center",children:[(0,Yv.jsx)("div",{className:"bg-gray-700 rounded-full w-10 h-10 flex items-center justify-center mr-3",children:(0,Yv.jsx)("span",{className:"text-gray-300 font-medium",children:e.name.substring(0,2)})}),(0,Yv.jsxs)("div",{children:[(0,Yv.jsx)("p",{className:"font-medium text-white",children:e.name}),e.nation?(0,Yv.jsxs)("p",{className:"text-green-400 text-sm",children:[e.nation," \uc120\ud0dd\ub428"]}):(0,Yv.jsx)("p",{className:"text-gray-400 text-sm",children:"\uad6d\uac00 \uc120\ud0dd \uc911..."})]})]}),e.uid===n.uid&&(0,Yv.jsx)("span",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded",children:"\ub098"})]})},e.uid))})]}),!o.nation&&(0,Yv.jsxs)("div",{className:"mb-8",children:[(0,Yv.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"\uad6d\uac00 \uc120\ud0dd"}),(0,Yv.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(e=>(0,Yv.jsxs)("button",{onClick:()=>r(e.name),className:"p-4 border border-gray-700 rounded-lg bg-gray-800 hover:bg-gray-700 transition-colors text-left",children:[(0,Yv.jsx)("h4",{className:"font-bold text-lg text-white mb-1",children:e.name}),(0,Yv.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm mt-3",children:[(0,Yv.jsx)("div",{className:"text-gray-400",children:"\uc790\uc6d0:"}),(0,Yv.jsx)("div",{className:"text-yellow-300",children:e.resources}),(0,Yv.jsx)("div",{className:"text-gray-400",children:"\uc548\uc815\ub3c4:"}),(0,Yv.jsxs)("div",{className:"text-blue-300",children:[e.stability,"%"]})]})]},e.name))})]}),l.length>0&&(0,Yv.jsxs)("div",{className:"mb-8",children:[(0,Yv.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"\uc120\ud0dd\ub41c \uad6d\uac00"}),(0,Yv.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:l.map(e=>(0,Yv.jsxs)("div",{className:"p-4 border rounded-lg "+(e.isCurrentUser?"border-indigo-500 bg-indigo-900/30":"border-gray-700 bg-gray-800"),children:[(0,Yv.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Yv.jsx)("h4",{className:"font-bold text-lg text-white",children:e.name}),e.isCurrentUser&&(0,Yv.jsx)("span",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded",children:"\ub0b4 \uad6d\uac00"})]}),(0,Yv.jsxs)("p",{className:"text-gray-400 text-sm mt-1",children:["\ud50c\ub808\uc774\uc5b4: ",e.playerName]})]},e.name))})]}),(0,Yv.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-4 mt-8",children:[(0,Yv.jsx)("button",{onClick:s,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900",children:"\ub85c\ube44\ub85c \ub3cc\uc544\uac00\uae30"}),o.nation&&(0,Yv.jsx)("button",{onClick:i,disabled:!c,className:"px-6 py-2 bg-green-600 text-white font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-900 "+(c?"hover:bg-green-700":"opacity-50 cursor-not-allowed"),children:"\uac8c\uc784 \uc2dc\uc791"})]}),o.nation&&!c&&(0,Yv.jsx)("p",{className:"text-amber-400 text-sm mt-4 text-center",children:"\uac8c\uc784\uc744 \uc2dc\uc791\ud558\ub824\uba74 \ubaa8\ub4e0 \ud50c\ub808\uc774\uc5b4\uac00 \uad6d\uac00\ub97c \uc120\ud0dd\ud574\uc57c \ud569\ub2c8\ub2e4."})]})]})};const db=function(e){let{db:t,user:n,gameId:i,setGameId:s}=e;const{gameData:o,loading:a,error:l,handleSelectNation:c,handleStartGame:u,handleEndTurn:h,handleCommand:d,getMyNation:f,getCurrentPlayer:p}=Jv(t,i,n),{isMinWidth:m}=Lv(),[g,y]=(0,r.useState)("map"),v=p(),b=f();return a?(0,Yv.jsx)(lb,{}):l||!o?(0,Yv.jsx)(cb,{error:l,onReturn:()=>s(null)}):"eliminated"===(null===v||void 0===v?void 0:v.status)||"finished"===o.status?(0,Yv.jsx)(ub,{isWinner:o.winner===(null===b||void 0===b?void 0:b.name),winner:o.winner,onReturn:()=>s(null)}):"waiting"===o.status?(0,Yv.jsx)(hb,{gameData:o,user:n,onSelectNation:c,onStartGame:u,onReturn:()=>s(null)}):(0,Yv.jsxs)("div",{className:"bg-gray-900 rounded-lg shadow-xl overflow-hidden border border-gray-700",children:[(0,Yv.jsxs)("div",{className:"bg-gradient-to-r from-indigo-800 to-purple-800 p-4 text-white",children:[(0,Yv.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Yv.jsx)("h2",{className:"text-xl md:text-2xl font-bold",children:o.name}),(0,Yv.jsxs)("div",{className:"text-sm opacity-75",children:["ID: ",o.id.substring(0,8),"..."]})]}),(0,Yv.jsxs)("div",{className:"mt-2 text-sm flex flex-wrap gap-2",children:[(0,Yv.jsxs)("span",{className:"bg-indigo-900/70 px-3 py-1 rounded-full flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),"\ud134 ",o.turn]}),(0,Yv.jsxs)("span",{className:"bg-green-900/70 px-3 py-1 rounded-full flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})}),o.players.filter(e=>"playing"===e.status).length,"\uba85 \ud50c\ub808\uc774"]}),b&&(0,Yv.jsxs)("span",{className:"bg-blue-900/70 px-3 py-1 rounded-full flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{fillRule:"evenodd",d:"M3 6a3 3 0 013-3h10a1 1 0 01.8 1.6L14.25 8l2.55 3.4A1 1 0 0116 13H6a1 1 0 00-1 1v3a1 1 0 11-2 0V6z",clipRule:"evenodd"})}),b.name]})]})]}),(0,Yv.jsx)("div",{className:"border-b border-gray-700 bg-gray-800",children:(0,Yv.jsx)("nav",{className:"flex flex-wrap overflow-x-auto",children:[{id:"map",label:"\uc9c0\ub3c4",icon:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"},{id:"dashboard",label:"\ub300\uc2dc\ubcf4\ub4dc",icon:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"},{id:"advisors",label:"\ubcf4\uc88c\uad00",icon:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"},{id:"diplomacy",label:"\uc678\uad50",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},{id:"technology",label:"\uae30\uc220",icon:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"},{id:"events",label:"\uc774\ubca4\ud2b8",icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"}].map(e=>(0,Yv.jsxs)("button",{onClick:()=>(e=>{y(e)})(e.id),className:"flex items-center px-4 py-3 font-medium transition-colors "+(g===e.id?"bg-gray-700 text-white border-b-2 border-indigo-500":"text-gray-400 hover:text-gray-200 hover:bg-gray-700/50"),children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:e.icon})}),(0,Yv.jsx)("span",{className:m.md?"":"sr-only",children:e.label})]},e.id))})}),(0,Yv.jsx)("div",{className:"p-4 bg-gray-900",children:(0,Yv.jsx)(eb,{gameData:o,currentPlayer:v,onEndTurn:h})}),(0,Yv.jsxs)("div",{className:"p-4 bg-gray-900",children:["map"===g&&(0,Yv.jsx)(Zv,{mapData:o.map,nations:o.nations}),"dashboard"===g&&(0,Yv.jsx)(tb,{myNation:b,gameData:o}),"advisors"===g&&(0,Yv.jsx)(nb,{db:t,gameData:o,myNation:b,user:n,onCommand:d}),"diplomacy"===g&&(0,Yv.jsx)(rb,{db:t,gameData:o,myNation:b}),"technology"===g&&(0,Yv.jsx)(ib,{myNation:b,db:t,gameData:o,onResearch:d}),"events"===g&&(0,Yv.jsx)(sb,{events:o.events,user:n})]}),(0,Yv.jsx)("div",{className:"border-t border-gray-700 p-4 text-center bg-gray-800",children:(0,Yv.jsx)("button",{onClick:()=>s(null),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-800",children:"\ub85c\ube44\ub85c \ub3cc\uc544\uac00\uae30"})})]})};const fb=function(e){var t;let{db:n,user:i,setGameId:s,isMobile:o}=e;const{isMinWidth:a}=Lv(),[l,c]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),[d,f]=(0,r.useState)(""),[p,m]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),[v,b]=(0,r.useState)(""),[w,x]=(0,r.useState)([]),[_,I]=(0,r.useState)(!1),[E,S]=(0,r.useState)(""),k=async()=>{I(!0),f("");try{try{const e=Ry(Ug(n,"games"),function(e,t,n){const r=t,i=Cy("where",e);return Oy._create(i,r,n)}("status","==","waiting"),function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Cy("orderBy",e);return jy._create(n,t)}("createdAt","desc"),Fy(10)),t=await Jy(e),r=[];t.forEach(e=>{const t=e.data();r.push({id:e.id,name:t.name,players:t.players,createdAt:t.createdAt.toDate(),playerCount:t.players.length})}),x(r)}catch(e){console.warn("\uc778\ub371\uc2a4 \uc624\ub958\ub85c \uc778\ud574 \ub300\uccb4 \ucffc\ub9ac\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4:",e),e.message&&e.message.includes("requires an index")&&console.error("\n            ============================================================\n            Firebase \uc778\ub371\uc2a4 \uc624\ub958 \uac10\uc9c0\ub428!\n            \n            \uc131\ub2a5 \ucd5c\uc801\ud654\ub97c \uc704\ud574 Firebase \ucf58\uc194\uc5d0\uc11c \ub2e4\uc74c \ud544\ub4dc\uc5d0 \ub300\ud55c \ubcf5\ud569 \uc778\ub371\uc2a4\ub97c \uc0dd\uc131\ud558\uc138\uc694:\n            - \uceec\ub809\uc158: games\n            - \ud544\ub4dc: status (Ascending), createdAt (Descending)\n            \n            \uc624\ub958 \uba54\uc2dc\uc9c0\uc5d0 \ud3ec\ud568\ub41c \ub9c1\ud06c\ub97c \ud1b5\ud574 \uc9c1\uc811 \uc778\ub371\uc2a4\ub97c \uc0dd\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n            \uc774 \uc778\ub371\uc2a4\uac00 \uc5c6\uc73c\uba74 \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc740 \uacc4\uc18d \uc791\ub3d9\ud558\uc9c0\ub9cc \uc131\ub2a5\uc774 \uc800\ud558\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n            ============================================================\n          ");const t=Ry(Ug(n,"games"),Fy(50)),r=await Jy(t),i=[];r.forEach(e=>{const t=e.data();"waiting"===t.status&&i.push({id:e.id,name:t.name,players:t.players,createdAt:t.createdAt.toDate(),playerCount:t.players.length})}),i.sort((e,t)=>t.createdAt-e.createdAt),x(i.slice(0,10))}}catch(t){console.error("\uac8c\uc784 \ubaa9\ub85d \uac00\uc838\uc624\uae30 \uc624\ub958:",t),f("\uac8c\uc784 \ubaa9\ub85d\uc744 \uac00\uc838\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4: "+t.message)}finally{I(!1)}};(0,r.useEffect)(()=>{k();const e=setInterval(k,3e4);return()=>clearInterval(e)},[n]);const T=async e=>{const t=e||E||u;if(t.trim()){f(""),b(""),y(!0);try{const e=zg(n,"games",t),r=await Qy(e);if(r.exists()){if(r.data().players.some(e=>e.uid===i.uid))b("\uc774\ubbf8 \ucc38\uc5ec\ud55c \uac8c\uc784\uc785\ub2c8\ub2e4. \uac8c\uc784\uc73c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4..."),setTimeout(()=>{s(t)},1500);else{const n={uid:i.uid,name:`\ud50c\ub808\uc774\uc5b4 ${i.uid.substring(0,4)}`,nation:null,isTurnReady:!1,status:"playing"},r={};Object.keys(jv).forEach(e=>{r[e]={loyalty:50,ambition:jv[e].ambition}}),await Yy(e,{players:ov(n),[`advisors.${i.uid}`]:r}),b("\uac8c\uc784\uc5d0 \uc131\uacf5\uc801\uc73c\ub85c \ucc38\uc5ec\ud588\uc2b5\ub2c8\ub2e4! \uac8c\uc784\uc73c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4..."),h(""),S(""),k(),setTimeout(()=>{s(t)},1500)}}else f("\uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \uac8c\uc784 ID\uc785\ub2c8\ub2e4.")}catch(r){console.error("\uac8c\uc784 \ucc38\uc5ec \uc624\ub958: ",r),f("\uac8c\uc784 \ucc38\uc5ec\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4: "+r.message)}finally{y(!1)}}else f("\ucc38\uc5ec\ud560 \uac8c\uc784\uc744 \uc120\ud0dd\ud558\uac70\ub098 ID\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")};return(0,Yv.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Yv.jsx)("h2",{className:"text-2xl md:text-3xl font-bold text-center mb-6 text-indigo-600 dark:text-indigo-400",children:"\uc655\uad00\uc758 \ud68c\uc758 - \uac8c\uc784 \ub85c\ube44"}),d&&(0,Yv.jsx)("div",{className:"mb-6 p-4 bg-red-100 dark:bg-red-900/50 border-l-4 border-red-500 text-red-700 dark:text-red-300 rounded-md",children:(0,Yv.jsx)("p",{className:"text-center",children:d})}),v&&(0,Yv.jsx)("div",{className:"mb-6 p-4 bg-green-100 dark:bg-green-900/50 border-l-4 border-green-500 text-green-700 dark:text-green-300 rounded-md",children:(0,Yv.jsx)("p",{className:"text-center",children:v})}),(0,Yv.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,Yv.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden transition-all hover:shadow-xl",children:[(0,Yv.jsx)("div",{className:"bg-gradient-to-r from-indigo-600 to-blue-600 dark:from-indigo-800 dark:to-blue-800 p-4",children:(0,Yv.jsxs)("h3",{className:"text-xl font-semibold text-white flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"\uc0c8 \uac8c\uc784 \ub9cc\ub4e4\uae30"]})}),(0,Yv.jsxs)("div",{className:"p-6",children:[(0,Yv.jsxs)("div",{className:"mb-4",children:[(0,Yv.jsx)("label",{htmlFor:"newGameName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"\uac8c\uc784 \uc774\ub984"}),(0,Yv.jsx)("input",{id:"newGameName",type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"\uc0c8 \uac8c\uc784\uc758 \uc774\ub984\uc744 \uc785\ub825\ud558\uc138\uc694",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,Yv.jsx)("button",{onClick:async()=>{if(l.trim()){f(""),b(""),m(!0);try{const e=Object.keys(Fv).reduce((e,t)=>({...e,[t]:{level:0}}),{}),t={"\uc5d0\ub77c\uc2dc\uc544":{name:"\uc5d0\ub77c\uc2dc\uc544",resources:1e3,stability:75,owner:null,status:"active",technologies:JSON.parse(JSON.stringify(e))},"\ube0c\ub77c\uce74\ub2e4":{name:"\ube0c\ub77c\uce74\ub2e4",resources:1200,stability:80,owner:null,status:"active",technologies:JSON.parse(JSON.stringify(e))},"\uc544\ube14\ub9ac":{name:"\uc544\ube14\ub9ac",resources:800,stability:65,owner:null,status:"active",technologies:JSON.parse(JSON.stringify(e))}},r={uid:i.uid,name:`\ud50c\ub808\uc774\uc5b4 ${i.uid.substring(0,4)}`,nation:null,isTurnReady:!1,status:"playing"},o={};Object.keys(jv).forEach(e=>{o[e]={loyalty:50,ambition:jv[e].ambition}});const a=await Zy(Ug(n,"games"),{name:l,players:[r],nations:t,advisors:{[i.uid]:o},map:JSON.parse(JSON.stringify(Mv)),status:"waiting",turn:1,events:[{turn:1,type:"game_start",content:"\uc0c8\ub85c\uc6b4 \uc5ed\uc0ac\uac00 \uc2dc\uc791\ub429\ub2c8\ub2e4."}],diplomacy:{proposals:[],treaties:[],wars:[]},pendingActions:[],createdAt:new Date});b(`\uac8c\uc784\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4! \uac8c\uc784 ID: ${a.id.substring(0,8)}...`),c(""),setTimeout(()=>{s(a.id)},1500)}catch(e){console.error("\uac8c\uc784 \uc0dd\uc131 \uc624\ub958: ",e),f("\uac8c\uc784 \uc0dd\uc131\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4: "+e.message)}finally{m(!1)}}else f("\uac8c\uc784 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},disabled:p||!l.trim(),className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 "+(p||!l.trim()?"opacity-50 cursor-not-allowed":""),children:p?(0,Yv.jsxs)("span",{className:"flex items-center justify-center",children:[(0,Yv.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Yv.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Yv.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"\uac8c\uc784 \uc0dd\uc131 \uc911..."]}):"\uac8c\uc784 \uc0dd\uc131"}),(0,Yv.jsx)("div",{className:"mt-4 text-sm text-gray-500 dark:text-gray-400",children:(0,Yv.jsx)("p",{children:"\uc0c8 \uac8c\uc784\uc744 \uc0dd\uc131\ud558\uba74 \ub2f9\uc2e0\uc774 \ud638\uc2a4\ud2b8\uac00 \ub429\ub2c8\ub2e4. \uac8c\uc784 ID\ub97c \ub2e4\ub978 \ud50c\ub808\uc774\uc5b4\ub4e4\uacfc \uacf5\uc720\ud558\uc5ec \ud568\uaed8 \ud50c\ub808\uc774\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})})]})]}),(0,Yv.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden transition-all hover:shadow-xl",children:[(0,Yv.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 dark:from-blue-800 dark:to-cyan-800 p-4",children:(0,Yv.jsxs)("h3",{className:"text-xl font-semibold text-white flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"\uac8c\uc784 \ucc38\uc5ec\ud558\uae30"]})}),(0,Yv.jsxs)("div",{className:"p-6",children:[(0,Yv.jsxs)("div",{className:"mb-6",children:[(0,Yv.jsxs)("h4",{className:"text-lg font-medium text-gray-800 dark:text-gray-200 mb-3 flex items-center",children:[(0,Yv.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-blue-500",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,Yv.jsx)("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),(0,Yv.jsx)("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z",clipRule:"evenodd"})]}),"\ucc38\uc5ec \uac00\ub2a5\ud55c \uac8c\uc784 \ubaa9\ub85d",(0,Yv.jsx)("span",{className:"ml-2 text-sm text-blue-500 font-normal",children:"(\uc544\ub798 \ubaa9\ub85d\uc5d0\uc11c \uc120\ud0dd\ud558\uc138\uc694)"})]}),_?(0,Yv.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,Yv.jsxs)("svg",{className:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Yv.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Yv.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):w.length>0?(0,Yv.jsxs)("div",{className:"border-2 border-blue-300 dark:border-blue-700 rounded-md overflow-hidden shadow-md",children:[(0,Yv.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-2 border-b border-blue-200 dark:border-blue-800",children:(0,Yv.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-300 font-medium",children:"\uac8c\uc784\uc744 \uc120\ud0dd\ud558\uace0 \ucc38\uc5ec \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694"})}),(0,Yv.jsx)("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700 max-h-72 overflow-y-auto",children:w.map(e=>(0,Yv.jsx)("li",{onClick:()=>S(e.id),className:"p-4 cursor-pointer transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 "+(E===e.id?"bg-blue-100 dark:bg-blue-900/50 border-l-4 border-blue-500":""),children:(0,Yv.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Yv.jsxs)("div",{className:"flex-1",children:[(0,Yv.jsx)("h5",{className:"font-medium text-gray-800 dark:text-gray-200 text-lg",children:e.name}),(0,Yv.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["\ud50c\ub808\uc774\uc5b4: ",e.playerCount,"\uba85 | ID: ",e.id]}),(0,Yv.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["\uc0dd\uc131: ",e.createdAt.toLocaleString()]})]}),(0,Yv.jsxs)("div",{className:"flex items-center",children:[E===e.id&&(0,Yv.jsx)("span",{className:"mr-3 text-blue-500 dark:text-blue-400",children:(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Yv.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,Yv.jsx)("button",{onClick:t=>{t.stopPropagation(),T(e.id)},className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-md transition-colors font-medium",children:"\ucc38\uc5ec\ud558\uae30"})]})]})},e.id))})]}):(0,Yv.jsxs)("div",{className:"text-center py-8 border border-gray-200 dark:border-gray-700 rounded-md bg-gray-50 dark:bg-gray-800",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto text-gray-400 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Yv.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"\ud604\uc7ac \ucc38\uc5ec \uac00\ub2a5\ud55c \uac8c\uc784\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),(0,Yv.jsx)("button",{onClick:k,className:"mt-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-md transition-colors font-medium",children:"\uac8c\uc784 \ubaa9\ub85d \uc0c8\ub85c\uace0\uce68"})]})]}),E&&(0,Yv.jsx)("div",{className:"mb-6 bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:(0,Yv.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-3",children:[(0,Yv.jsxs)("div",{children:[(0,Yv.jsxs)("h5",{className:"font-medium text-blue-800 dark:text-blue-300",children:["\uc120\ud0dd\ub41c \uac8c\uc784: ",(null===(t=w.find(e=>e.id===E))||void 0===t?void 0:t.name)||E]}),(0,Yv.jsxs)("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:["ID: ",E]})]}),(0,Yv.jsxs)("div",{className:"flex gap-2",children:[(0,Yv.jsx)("button",{onClick:()=>S(""),className:"px-3 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 text-sm rounded-md transition-colors font-medium",children:"\ucde8\uc18c"}),(0,Yv.jsx)("button",{onClick:()=>T(),disabled:g,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 "+(g?"opacity-50 cursor-not-allowed":""),children:g?(0,Yv.jsxs)("span",{className:"flex items-center justify-center",children:[(0,Yv.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Yv.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Yv.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"\ucc38\uc5ec \uc911..."]}):"\uc120\ud0dd\ud55c \uac8c\uc784\uc5d0 \ucc38\uc5ec\ud558\uae30"})]})]})}),(0,Yv.jsxs)("div",{className:"mb-4",children:[(0,Yv.jsxs)("div",{className:"flex items-center mb-3",children:[(0,Yv.jsx)("div",{className:"flex-grow border-t border-gray-300 dark:border-gray-600"}),(0,Yv.jsx)("span",{className:"mx-3 text-sm text-gray-500 dark:text-gray-400",children:"\ub610\ub294"}),(0,Yv.jsx)("div",{className:"flex-grow border-t border-gray-300 dark:border-gray-600"})]}),(0,Yv.jsxs)("label",{htmlFor:"joinGameId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[(0,Yv.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Yv.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"\uac8c\uc784 ID\ub85c \uc9c1\uc811 \ucc38\uc5ec"]}),(0,Yv.jsxs)("div",{className:"flex",children:[(0,Yv.jsx)("input",{id:"joinGameId",type:"text",value:u,onChange:e=>{h(e.target.value),S("")},placeholder:"\ucc38\uc5ec\ud560 \uac8c\uc784\uc758 ID\ub97c \uc785\ub825\ud558\uc138\uc694",className:"flex-grow px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-l-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),(0,Yv.jsx)("button",{onClick:()=>T(),disabled:g||!u.trim(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-r-md transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 "+(g||!u.trim()?"opacity-50 cursor-not-allowed":""),children:g?(0,Yv.jsxs)("span",{className:"flex items-center justify-center",children:[(0,Yv.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Yv.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Yv.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"\ucc38\uc5ec \uc911..."]}):"\ucc38\uc5ec"})]}),(0,Yv.jsx)("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"\uac8c\uc784 ID\ub97c \uc54c\uace0 \uc788\ub294 \uacbd\uc6b0\uc5d0\ub9cc \uc0ac\uc6a9\ud558\uc138\uc694. \uc77c\ubc18\uc801\uc73c\ub85c\ub294 \uc704 \ubaa9\ub85d\uc5d0\uc11c \uac8c\uc784\uc744 \uc120\ud0dd\ud558\ub294 \uac83\uc774 \uc88b\uc2b5\ub2c8\ub2e4."})]})]})]})]}),(0,Yv.jsxs)("div",{className:"mt-8 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800 text-center",children:[(0,Yv.jsx)("h3",{className:"text-lg font-medium text-blue-800 dark:text-blue-300 mb-2",children:"\uac8c\uc784 \ucc38\uc5ec \ubc29\ubc95"}),(0,Yv.jsxs)("div",{className:"flex flex-col md:flex-row justify-center items-center gap-4 md:gap-8 mb-4",children:[(0,Yv.jsxs)("div",{className:"flex items-center",children:[(0,Yv.jsx)("div",{className:"bg-blue-100 dark:bg-blue-800 rounded-full w-8 h-8 flex items-center justify-center mr-3 text-blue-600 dark:text-blue-300",children:"1"}),(0,Yv.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"\ubaa9\ub85d\uc5d0\uc11c \uac8c\uc784 \uc120\ud0dd"})]}),(0,Yv.jsx)("div",{className:"hidden md:block text-gray-400",children:"\u2192"}),(0,Yv.jsxs)("div",{className:"flex items-center",children:[(0,Yv.jsx)("div",{className:"bg-blue-100 dark:bg-blue-800 rounded-full w-8 h-8 flex items-center justify-center mr-3 text-blue-600 dark:text-blue-300",children:"2"}),(0,Yv.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"\ucc38\uc5ec\ud558\uae30 \ubc84\ud2bc \ud074\ub9ad"})]}),(0,Yv.jsx)("div",{className:"hidden md:block text-gray-400",children:"\u2192"}),(0,Yv.jsxs)("div",{className:"flex items-center",children:[(0,Yv.jsx)("div",{className:"bg-blue-100 dark:bg-blue-800 rounded-full w-8 h-8 flex items-center justify-center mr-3 text-blue-600 dark:text-blue-300",children:"3"}),(0,Yv.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"\uad6d\uac00 \uc120\ud0dd \ud6c4 \uac8c\uc784 \uc2dc\uc791"})]})]}),(0,Yv.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"\uac8c\uc784 ID\ub294 \ub2e4\ub978 \ud50c\ub808\uc774\uc5b4\ub4e4\uacfc \uacf5\uc720\ud558\uc5ec \uac19\uc740 \uac8c\uc784\uc5d0 \ucc38\uc5ec\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),(0,Yv.jsx)("p",{className:"text-sm mt-1 text-gray-600 dark:text-gray-400",children:"\uac01 \ud50c\ub808\uc774\uc5b4\ub294 \uc11c\ub85c \ub2e4\ub978 \uad6d\uac00\ub97c \uc120\ud0dd\ud558\uc5ec \ud50c\ub808\uc774\ud569\ub2c8\ub2e4."})]})]})};const pb=function(){const[e,t]=(0,r.useState)(null),[n,i]=(0,r.useState)(null),[s,o]=(0,r.useState)(null),a=T({maxWidth:768});return(0,r.useEffect)(()=>{const{auth:e,db:n}=Rv.initializeFirebase();t(n);const r=Rv.onAuthStateChangedListener(e,t=>{t?i(t):Rv.signInAnonymouslyWithFirebase(e).catch(e=>console.error("\uc775\uba85 \ub85c\uadf8\uc778 \uc2e4\ud328:",e))});return()=>r()},[]),n&&e?(0,Yv.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-900 text-gray-900 dark:text-gray-100",children:(0,Yv.jsxs)("div",{className:`container mx-auto px-4 ${a?"py-4":"py-8"} max-w-7xl`,children:[(0,Yv.jsxs)("header",{className:"mb-6",children:[(0,Yv.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-center text-indigo-800 dark:text-indigo-400",children:"\uc655\uad00\uc758 \ud68c\uc758 (\ucd5c\uc885 \ubc84\uc804)"}),(0,Yv.jsxs)("p",{className:"text-center text-gray-600 dark:text-gray-400 mt-2",children:["\uc0ac\uc6a9\uc790 ID: ",n.uid.substring(0,8),"..."]}),(0,Yv.jsx)("div",{className:"border-b border-gray-300 dark:border-gray-700 mt-4"})]}),(0,Yv.jsx)("main",{children:s?(0,Yv.jsx)(db,{db:e,user:n,gameId:s,setGameId:o}):(0,Yv.jsx)(fb,{db:e,user:n,setGameId:o,isMobile:a})})]})}):(0,Yv.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,Yv.jsxs)("div",{className:"text-center",children:[(0,Yv.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"}),(0,Yv.jsx)("p",{className:"text-xl text-gray-700",children:"\ub85c\ub529 \uc911..."})]})})};i.createRoot(document.getElementById("root")).render((0,Yv.jsx)(r.StrictMode,{children:(0,Yv.jsx)(pb,{})}))})()})();
//# sourceMappingURL=main.908fe052.js.map